<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5.vue3 | Electrolux博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/front-base-know-blog/assets/css/0.styles.1c0757d4.css" as="style"><link rel="preload" href="/front-base-know-blog/assets/js/app.a8d1efe2.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/3.a15d85cc.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/1.704023bf.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/31.52bd8e5c.js" as="script"><link rel="prefetch" href="/front-base-know-blog/assets/js/10.dafae2d3.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/11.24fcf056.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/12.557e74e3.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/13.ce0b60f3.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/14.67c33e7d.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/15.e3c89f55.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/16.9217c419.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/17.01794b81.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/18.f519dbe6.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/19.65b75518.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/20.101e2711.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/21.770a9d86.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/22.2841a47d.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/23.148acac2.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/24.51b034c7.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/25.2776d64a.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/26.5d01324c.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/27.962aea25.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/28.7d43a189.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/29.cce20181.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/30.ec88cd52.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/32.c6c2692c.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/33.800a3130.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/34.6cf73558.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/4.11c729f5.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/5.41f9e3e8.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/6.de585bd1.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/7.234840ab.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/8.f66853e2.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/9.f8e9f3c4.js">
    <link rel="stylesheet" href="/front-base-know-blog/assets/css/0.styles.1c0757d4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Electrolux博客</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-base-know-blog/" class="home-link router-link-active"><!----> <span class="site-name">Electrolux博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-base-know-blog/know/1.html.html" class="nav-link"><i class="undefined"></i>
  html
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/2.javascript基础.html" class="nav-link"><i class="undefined"></i>
  js基础
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/5.css.html" class="nav-link"><i class="undefined"></i>
  css
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      常用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/7.算法.html" class="nav-link"><i class="undefined"></i>
  设计模式 | 算法
</a></li><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/10.性能优化.html" class="nav-link"><i class="undefined"></i>
  性能优化
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>24</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/front-base-know-blog/know/1.html.html" class="nav-link"><i class="undefined"></i>
  html
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/2.javascript基础.html" class="nav-link"><i class="undefined"></i>
  js基础
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/5.css.html" class="nav-link"><i class="undefined"></i>
  css
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      常用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/7.算法.html" class="nav-link"><i class="undefined"></i>
  设计模式 | 算法
</a></li><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/10.性能优化.html" class="nav-link"><i class="undefined"></i>
  性能优化
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/1.html.html" class="sidebar-link">1.HTML（浏览器机制）</a></li><li><a href="/front-base-know-blog/know/2.0javascript基础.html" class="sidebar-link">2.JavaScript基础</a></li><li><a href="/front-base-know-blog/know/2.1.javascript基础.html" class="sidebar-link">2.1 JavaScript基础</a></li><li><a href="/front-base-know-blog/know/2.2.ts.html" class="sidebar-link">2.2. ts</a></li><li><a href="/front-base-know-blog/know/2.9.javascript代码输出题.html" class="sidebar-link">2.9 JavaScript代码输出题</a></li><li><a href="/front-base-know-blog/know/3.javascript-es6.html" class="sidebar-link">3.JavaScript-es6</a></li><li><a href="/front-base-know-blog/know/4.javascript-手写题.html" class="sidebar-link">4.JS手写题</a></li><li><a href="/front-base-know-blog/know/5.css.html" class="sidebar-link">5.CSS</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>八股</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="sidebar-link">1.计算机网络</a></li><li><a href="/front-base-know-blog/know/八股/2.Git.html" class="sidebar-link">2.Git</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>框架 | 工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/框架/1.vue.html" class="sidebar-link">1.vue | 主流方案对比</a></li><li><a href="/front-base-know-blog/know/框架/2.react.html" class="sidebar-link">2.react</a></li><li><a href="/front-base-know-blog/know/框架/3.ssr.html" class="sidebar-link">3.ssr</a></li><li><a href="/front-base-know-blog/know/框架/4.微前端.html" class="sidebar-link">4.微前端</a></li><li><a href="/front-base-know-blog/know/框架/6.nginx.html" class="sidebar-link">6.nginx</a></li><li><a href="/front-base-know-blog/know/框架/7.python.html" class="sidebar-link">7.python</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>优化 | 工程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/优化/1.性能优化和安全.html" class="sidebar-link">1.性能优化与安全</a></li><li><a href="/front-base-know-blog/know/优化/2.webpack.html" class="sidebar-link">2.webpack</a></li><li><a href="/front-base-know-blog/know/优化/3.算法.html" class="sidebar-link">3.实用算法 | 设计模式</a></li><li><a href="/front-base-know-blog/know/优化/4.性能优化.html" class="sidebar-link">4.性能优化</a></li><li><a href="/front-base-know-blog/know/优化/5.组件库构造.html" class="sidebar-link">5.组件库构建</a></li><li><a href="/front-base-know-blog/know/优化/6.webrtc.html" class="sidebar-link">6.webrtc</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">5.vue3</h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="_5-vue3"><a href="#_5-vue3" class="header-anchor">#</a> 5.vue3</h1> <p></p><div class="table-of-contents"><ul><li><a href="#_5-奇奇怪怪的报错">5.？奇奇怪怪的报错</a></li><li><a href="#_5-0-基础">5.0 基础</a><ul><li><a href="#_5-0-1-axios封装">5.0.1 axios封装</a></li><li><a href="#_5-0-2-生命周期">5.0.2 生命周期</a></li><li><a href="#_5-0-3-组件传参">5.0.3 组件传参</a></li><li><a href="#_5-0-4-路由封装">5.0.4 路由封装</a></li><li><a href="#_5-0-5-element-plus">5.0.5 Element-plus</a></li><li><a href="#_5-0-6-pinia的使用">5.0.6  pinia的使用</a></li><li><a href="#_5-0-7-watch-watcheffect-compute">5.0.7 watch |  watchEffect |  compute</a></li><li><a href="#_5-0-8-类型断言">5.0.8 类型断言</a></li><li><a href="#_5-0-9-插槽">5.0.9 插槽</a></li></ul></li><li><a href="#_5-1-小技巧">5.1 小技巧</a></li><li><a href="#_5-2-vite-优化">5.2 vite 优化</a><ul><li><a href="#_2-2-1-eslint">2.2.1 eslint</a></li><li><a href="#_2-2-2-自动注入-xx-d-ts">2.2.2 自动注入 | xx.d.ts</a></li><li><a href="#_2-2-3-vite-2-配置环境">2.2.3  vite 2 配置环境</a></li><li><a href="#_2-2-4-element-plus导入">2.2.4 element-plus导入</a></li></ul></li><li><a href="#_5-3-细节">5.3 细节</a><ul><li><a href="#_5-3-1-d-ts文件">5.3.1 .d.ts文件</a></li><li><a href="#_5-3-2-vue3-tsconfig-json">5.3.2 vue3 | tsconfig.json</a></li><li><a href="#_5-3-3-eslintrc-js">5.3.3 .eslintrc.js</a></li><li><a href="#_5-3-4">5.3.4  .</a></li></ul></li><li><a href="#_5-4-自定义指令">5.4 自定义指令</a><ul><li><a href="#_5-4-0-基本">5.4.0 基本</a></li><li><a href="#_5-4-1-权限">5.4.1 权限</a></li></ul></li></ul></div><p></p> <h2 id="_5-奇奇怪怪的报错"><a href="#_5-奇奇怪怪的报错" class="header-anchor">#</a> 5.？奇奇怪怪的报错</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>Type number trivially inferred from a number literal<span class="token punctuation">,</span> remove type annotation  @typescript<span class="token operator">-</span>eslint<span class="token operator">/</span>no<span class="token operator">-</span>inferrable<span class="token operator">-</span>types<span class="token operator">?</span>   
<span class="token literal-property property">s</span><span class="token operator">:</span>原因是：typescript 对代码做了类型推断 不用再进行指明number类型
s：解决方法是：@typescript<span class="token operator">-</span>eslint<span class="token operator">/</span>no<span class="token operator">-</span>inferrable<span class="token operator">-</span>types：<span class="token string">&quot;off&quot;</span>

<span class="token operator">--</span><span class="token number">2.</span>元素隐式具有 “any“ 类型，因为类型为 “string“ 的表达式不能用于索引类型 “Object“。 在类型 “Object“ 上找不到具有类型为 “string“ 的参数的索引签名
<span class="token literal-property property">s</span><span class="token operator">:</span>tsconfig<span class="token punctuation">.</span>json中compilerOptions里面新增忽略的代码，如下所示，添加后则不会报错：<span class="token string">&quot;suppressImplicitAnyIndexErrors&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>

注意 这玩意和strict：<span class="token boolean">true</span>冲突

<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>Cannot access ambient <span class="token keyword">const</span> enums when the <span class="token string">'--isolatedModules'</span> flag is provided<span class="token punctuation">.</span>此配置开启后不允许采用常量枚举值作为属性key，同时要求类型导入导出必须明确
例如：<span class="token keyword">export</span> <span class="token punctuation">{</span> TriggerOpTypes <span class="token punctuation">}</span> 会报错
s：<span class="token string">&quot;isolatedModules&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 设置成<span class="token boolean">false</span>就可以了



<span class="token number">4.</span> <span class="token string">'name'</span> is never reassigned<span class="token punctuation">.</span> Use <span class="token string">'const'</span> instead prefer<span class="token operator">-</span><span class="token keyword">const</span> 
eslinttrc<span class="token punctuation">.</span>js中添加
<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
    <span class="token string-property property">&quot;prefer-const&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_5-0-基础"><a href="#_5-0-基础" class="header-anchor">#</a> 5.0 基础</h2> <h3 id="_5-0-1-axios封装"><a href="#_5-0-1-axios封装" class="header-anchor">#</a> 5.0.1 axios封装</h3> <h4 id="_1-src-下面新建文件夹-http。下面新建index-ts"><a href="#_1-src-下面新建文件夹-http。下面新建index-ts" class="header-anchor">#</a> --1.src 下面新建文件夹 http。下面新建index.ts</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ElMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-plus'</span>
<span class="token comment">// 创建HTTP实例</span>
<span class="token keyword">const</span> $http <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">baseURL</span><span class="token operator">:</span><span class="token string">&quot;https://c0738068-9ea6-4a45-9216-f2d95ca33bdb.bspapp.com&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">timeout</span><span class="token operator">:</span><span class="token number">5000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span><span class="token string">&quot;application/json;charset=utf-8&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 请求拦截</span>
$http<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>headers <span class="token operator">=</span>  config<span class="token punctuation">.</span>headers <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// console.log(config)</span>
    <span class="token keyword">return</span> config
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 响应拦截</span>
$http<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>

    <span class="token comment">// const code:number = res.data.code</span>
    <span class="token comment">// if(code!==200){</span>
    <span class="token comment">//     ElMessage.error(&quot;数据的获取有错误&quot;)</span>
    <span class="token comment">//     return Promise.reject(res.data)</span>
    <span class="token comment">// }</span>
    <span class="token keyword">return</span> res
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token parameter">err</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> $http

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="_2-src-http同级新建api-ts"><a href="#_2-src-http同级新建api-ts" class="header-anchor">#</a> --2.src http同级新建api.ts</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> $http <span class="token keyword">from</span> <span class="token string">'./index'</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">loginData</span> <span class="token operator">=</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span><span class="token builtin">string</span>
   
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">:</span>loginData<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">{</span>url<span class="token operator">:</span><span class="token string">&quot;/queryOrder?id=&quot;</span><span class="token operator">+</span>id<span class="token punctuation">.</span>id<span class="token punctuation">,</span>method<span class="token operator">:</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>data<span class="token operator">:</span>id<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_5-0-2-生命周期"><a href="#_5-0-2-生命周期" class="header-anchor">#</a> 5.0.2 生命周期</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 知识点2：生命周期</span>
<span class="token comment">// console.log(&quot;相当于create&quot;);</span>

<span class="token comment">// onMounted(() =&gt; {</span>
<span class="token comment">//   console.log(&quot;相当于mount，dom没挂&quot;);</span>
<span class="token comment">// });</span>
<span class="token comment">// onUpdated(() =&gt; {</span>
<span class="token comment">//   console.log(&quot;相当于update，dom已经挂&quot;);</span>
<span class="token comment">// });</span>
<span class="token comment">// onUnmounted(() =&gt; {</span>
<span class="token comment">//   console.log(&quot;相当于destory，用v-if可以触发&quot;);</span>
<span class="token comment">// });</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_5-0-3-组件传参"><a href="#_5-0-3-组件传参" class="header-anchor">#</a> 5.0.3 组件传参</h3> <h3 id="_5-0-4-路由封装"><a href="#_5-0-4-路由封装" class="header-anchor">#</a> 5.0.4 路由封装</h3> <h4 id="_1-router-下面新建-xx-ts文件"><a href="#_1-router-下面新建-xx-ts文件" class="header-anchor">#</a> --1. router 下面新建 xx.ts文件</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token comment">//无论谁都可以访问的路由</span>
<span class="token keyword">const</span> RoutesAll<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>RouteRecordRaw<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'Route1'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/views/helloworld.vue&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token comment">//指定人可以访问的路由</span>
<span class="token keyword">const</span> RoutesToken<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/AxiosTest'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'AxiosTest'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/components/AxiosTest.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span> role<span class="token operator">:</span> <span class="token string">'admin'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> RoutesToken<span class="token punctuation">,</span> RoutesAll <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_2-index-ts"><a href="#_2-index-ts" class="header-anchor">#</a> --2.index.ts</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHashHistory<span class="token punctuation">,</span> RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> RoutesToken<span class="token punctuation">,</span> RoutesAll<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./study'</span>

<span class="token comment">// 过滤路由</span>
<span class="token keyword">let</span> commonUser <span class="token operator">=</span> <span class="token string">'admin'</span>
<span class="token keyword">let</span> commonUserRoute<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>RouteRecordRaw<span class="token operator">&gt;</span> <span class="token operator">=</span> RoutesToken<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>page<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(page)</span>
  <span class="token keyword">return</span> commonUser<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>role<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//挂载上去</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span>RoutesAll<span class="token punctuation">,</span>
  
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//跟vue2不一样，vue2可以直接addroutes直接挂载所有路由</span>
<span class="token comment">// vue3只有这样子慢慢 添加</span>
RoutesToken<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 路由守护</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span>from<span class="token punctuation">,</span>next<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    
    <span class="token comment">// console.log(&quot;to&quot;)</span>
    <span class="token comment">// console.log(to)</span>
    <span class="token comment">//这里权限的逻辑就是不等于token 并且 值为login</span>
    <span class="token comment">// if( to.path!=='/login'){</span>
    <span class="token comment">//   next({path: '/login'})</span>
    <span class="token comment">// }else{</span>
    <span class="token comment">//   next()</span>
    <span class="token comment">// }</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
<span class="token keyword">export</span> <span class="token keyword">default</span> router

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h3 id="_5-0-5-element-plus"><a href="#_5-0-5-element-plus" class="header-anchor">#</a> 5.0.5 Element-plus</h3> <h4 id="_1-npm-install-element-plus-然后新建plugin-element-ts"><a href="#_1-npm-install-element-plus-然后新建plugin-element-ts" class="header-anchor">#</a> --1.npm install element-plus ，然后新建plugin/element.ts</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token comment">// 导入我们的element-plus的css文件</span>
<span class="token keyword">import</span> <span class="token string">'element-plus/dist/index.css'</span>
<span class="token comment">// 把我们需要使用的组件进行导入</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  ElButton<span class="token punctuation">,</span>
  ElCheckbox<span class="token punctuation">,</span>
  ElForm<span class="token punctuation">,</span>
  ElFormItem<span class="token punctuation">,</span>
  ElInput<span class="token punctuation">,</span>
  ElLink<span class="token punctuation">,</span>
  ElRadio<span class="token punctuation">,</span>
  ElTabPane<span class="token punctuation">,</span>
  ElTabs
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-plus'</span> <span class="token comment">// 需要的就导入</span>
<span class="token comment">// 把我们要使用的组件名放入一个数组里面</span>
<span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">[</span>
  ElButton<span class="token punctuation">,</span>
  ElForm<span class="token punctuation">,</span>
  ElFormItem<span class="token punctuation">,</span>
  ElInput<span class="token punctuation">,</span>
  ElRadio<span class="token punctuation">,</span>
  ElTabs<span class="token punctuation">,</span>
  ElTabPane<span class="token punctuation">,</span>
  ElCheckbox<span class="token punctuation">,</span>
  ElLink <span class="token comment">// 需要的就导入</span>
<span class="token punctuation">]</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token comment">// 循环我们的组件名数组进行全局注册</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> component <span class="token keyword">of</span> components<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>name<span class="token punctuation">,</span> component<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="_2-plugin-index-ts中"><a href="#_2-plugin-index-ts中" class="header-anchor">#</a> --2.plugin/index.ts中</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 从vue 中导入APP类型</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token comment">// 导入我们们的组件注册声明文件</span>
<span class="token keyword">import</span> registerElement <span class="token keyword">from</span> <span class="token string">'./element'</span>
<span class="token comment">// 导出（暴露）我们的主接口方便main接口调用使用</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">globalRegister</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用use函数安装我们的registerElement</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>registerElement<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_3-main-ts中"><a href="#_3-main-ts中" class="header-anchor">#</a> --3. main.ts中</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> globalRegister <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/plugin/index'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'HelloWorld1'</span><span class="token punctuation">,</span>HelloWorld<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>globalRegister<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_5-0-6-pinia的使用"><a href="#_5-0-6-pinia的使用" class="header-anchor">#</a> 5.0.6  pinia的使用</h3> <h4 id="_1-安装"><a href="#_1-安装" class="header-anchor">#</a> --1. 安装</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> pinia <span class="token parameter variable">-S</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-main-ts中"><a href="#_2-main-ts中" class="header-anchor">#</a> --2. main.ts中</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createPinia<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">const</span> store<span class="token operator">=</span><span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 使用vuex</span>
<span class="token comment">// import vuex from './store'</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_3-src-store下面新建modules文件夹和index-ts文件"><a href="#_3-src-store下面新建modules文件夹和index-ts文件" class="header-anchor">#</a> --3. src/store下面新建modules文件夹和index.ts文件</h4> <p>store/index.ts</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> useUserStore <span class="token keyword">from</span> <span class="token string">'./modules/user'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">useStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  user<span class="token operator">:</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useStore<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>store/modules/user.ts</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span><span class="token punctuation">;</span>


<span class="token keyword">const</span> useUserStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 第一个值是命名空间</span>
  id<span class="token operator">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
  <span class="token comment">// 必须是箭头函数 然后返回一个对象</span>
  state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    token<span class="token operator">:</span> <span class="token string">'token'</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">,</span>
    nickname<span class="token operator">:</span> <span class="token string">'user1111'</span><span class="token punctuation">,</span>
    avatar<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    perms<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// 计算属性,这里感觉更适合做获取器</span>
  getters<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">nicknameGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">any</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'前缀---'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>nickname
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 同步异步操作都可以</span>
  actions<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">actionPinia</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>nickname<span class="token punctuation">)</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;这是action里面的操作&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>


<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useUserStore<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h4 id="_4-使用"><a href="#_4-使用" class="header-anchor">#</a> --4. 使用</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> useStore <span class="token keyword">from</span> <span class="token string">'@/store'</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>nickname<span class="token punctuation">)</span>
user<span class="token punctuation">.</span><span class="token function">actionPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_5-0-7-watch-watcheffect-compute"><a href="#_5-0-7-watch-watcheffect-compute" class="header-anchor">#</a> 5.0.7 watch |  watchEffect |  compute</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> message2 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'message2'</span><span class="token punctuation">,</span> message2<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">watch</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span><span class="token punctuation">(</span>newv<span class="token punctuation">,</span>oldv<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>oldv<span class="token punctuation">)</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newv<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

watch 会明确监听某一个响应数据，
<span class="token comment">/*
watch 的第三个参数是一个可选的对象，支持以下选项：

immediate：在侦听器创建时立即触发回调。
deep：深度遍历，以便在深层级变更时触发回调。
flush：回调函数的触发时机。pre：默认，dom 更新前调用，post: dom 更新后调用，sync 同步调用。
onTrack / onTrigger：用于调试的钩子。在依赖收集和回调函数触发时被调用
*/</span>


简单地说，watchwatch 功能更加强大，而 watchEffect 在某些场景下更加简洁。


<span class="token keyword">let</span> firstname <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> lastname <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstname<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">&quot;---------&quot;</span> <span class="token operator">+</span> lastname<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="_5-0-8-类型断言"><a href="#_5-0-8-类型断言" class="header-anchor">#</a> 5.0.8 类型断言</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 类型断言as：这么写，行！const temp = this.$refs.drag as HTMLElement（断言这玩应绝壁是文档元素）</span>
<span class="token comment">// 这么写，不完全行！const temp:any = this.$refs.drag（这玩应乐意是啥是啥）</span>
<span class="token comment">// 非空断言!：变量!.xxxx  </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_5-0-9-插槽"><a href="#_5-0-9-插槽" class="header-anchor">#</a> 5.0.9 插槽</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code>父组件：
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child</span> <span class="token attr-name">:tochild</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@tofather</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tofather<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>header</span> <span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child</span>
<span class="token punctuation">&gt;</span></span>

子组件：
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>插槽里面的值<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>子组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>children<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>子组件的按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_5-1-小技巧"><a href="#_5-1-小技巧" class="header-anchor">#</a> 5.1 小技巧</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span> 智能提示
vetur扩展插件导致  vscode 报错
vue3使用建议用Volar来替换vetur
<span class="token operator">--</span><span class="token number">2.</span>差异
与vue2的区别是根目录的index<span class="token punctuation">.</span>html。里面是src<span class="token operator">/</span>main<span class="token punctuation">.</span>ts
vue2的index<span class="token punctuation">.</span>html是<span class="token keyword">public</span>中的
<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>vue<span class="token operator">-</span>cli 创造版本的一些选项？
<span class="token operator">--</span><span class="token number">3.1</span> Use <span class="token keyword">class</span><span class="token operator">-</span>style component syntax<span class="token operator">?</span> <span class="token punctuation">(</span><span class="token constant">Y</span><span class="token operator">/</span>n<span class="token punctuation">)</span> n
即原本是：home <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>创建vue实例
使用装饰器后：<span class="token keyword">class</span> <span class="token class-name">home</span> <span class="token keyword">extends</span> <span class="token class-name">Vue</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token number">3.2</span> Use Babel alongside <span class="token function">TypeScript</span> <span class="token punctuation">(</span>required <span class="token keyword">for</span> modern mode<span class="token punctuation">,</span> auto<span class="token operator">-</span>detected polyfills<span class="token punctuation">,</span> transpiling <span class="token constant">JSX</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token punctuation">(</span><span class="token constant">Y</span><span class="token operator">/</span>n<span class="token punctuation">)</span> y
使用Babel与TypeScript一起用于自动检测的填充<span class="token operator">?</span> yes
<span class="token operator">--</span><span class="token number">3.3</span> Pick additional lint features<span class="token operator">:</span> <span class="token punctuation">(</span>Press <span class="token operator">&lt;</span>space<span class="token operator">&gt;</span> to select<span class="token punctuation">,</span> <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span> to toggle all<span class="token punctuation">,</span> <span class="token operator">&lt;</span>i<span class="token operator">&gt;</span> to invert selection<span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> Lint on <span class="token function">save（保存就检查代码）</span>
<span class="token punctuation">(</span> <span class="token punctuation">)</span> Lint and fix on commit（fix和commit时候检查代码）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_5-2-vite-优化"><a href="#_5-2-vite-优化" class="header-anchor">#</a> 5.2 vite 优化</h2> <h3 id="_2-2-1-eslint"><a href="#_2-2-1-eslint" class="header-anchor">#</a> 2.2.1 eslint</h3> <h4 id="shell安装"><a href="#shell安装" class="header-anchor">#</a> shell安装</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
<span class="token function">npm</span> <span class="token function">install</span> --save-dev eslint eslint-plugin-vue

<span class="token function">npm</span> <span class="token function">install</span> eslint --save-dev
npx eslint <span class="token parameter variable">--init</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="eslintrc-js写入"><a href="#eslintrc-js写入" class="header-anchor">#</a> eslintrc.js写入</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;browser&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;es2021&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-eslint-parser&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// &quot;eslint:recommended&quot;,</span>
        <span class="token string">&quot;plugin:vue/vue3-essential&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// &quot;plugin:@typescript-eslint/recommended&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;parserOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// &quot;ecmaVersion&quot;: &quot;latest&quot;,</span>
        <span class="token string-property property">&quot;parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@typescript-eslint/parser&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;@typescript-eslint&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'vue/multi-word-component-names'</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;no-unused-vars&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//没被使用</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_2-2-2-自动注入-xx-d-ts"><a href="#_2-2-2-自动注入-xx-d-ts" class="header-anchor">#</a> 2.2.2 自动注入 | xx.d.ts</h3> <p>自动导入composition <a href="https://so.csdn.net/so/search?q=api&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">api<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 生成全局typescript说明</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> i <span class="token parameter variable">-D</span> unplugin-auto-import
<span class="token function">npm</span> i vite-plugin-compression <span class="token parameter variable">-D</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>vite.config.ts</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> AutoImport <span class="token keyword">from</span> <span class="token string">&quot;unplugin-auto-import/vite&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
     <span class="token function">AutoImport</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">imports</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue-router&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 自动导入vue和vue-router相关函数</span>
      <span class="token literal-property property">dts</span><span class="token operator">:</span> <span class="token string">&quot;src/auto-import.d.ts&quot;</span> <span class="token comment">// 生成 `auto-import.d.ts` 全局声明</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>会生成xx.d.ts</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// Generated by 'unplugin-auto-import'</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">declare</span> global <span class="token punctuation">{</span>
  <span class="token keyword">const</span> EffectScope<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'EffectScope'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> computed<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'computed'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> createApp<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'createApp'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> customRef<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'customRef'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> defineAsyncComponent<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'defineAsyncComponent'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> defineComponent<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'defineComponent'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> effectScope<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'effectScope'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> getCurrentInstance<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'getCurrentInstance'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> getCurrentScope<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'getCurrentScope'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> h<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'h'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> inject<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'inject'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> isProxy<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'isProxy'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> isReactive<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'isReactive'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> isReadonly<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'isReadonly'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> isRef<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'isRef'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> markRaw<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'markRaw'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> nextTick<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'nextTick'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onActivated<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onActivated'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onBeforeMount<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onBeforeMount'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onBeforeUnmount<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onBeforeUnmount'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onBeforeUpdate<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onBeforeUpdate'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onDeactivated<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onDeactivated'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onErrorCaptured<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onErrorCaptured'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onMounted<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onMounted'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onRenderTracked<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onRenderTracked'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onRenderTriggered<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onRenderTriggered'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onScopeDispose<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onScopeDispose'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onServerPrefetch<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onServerPrefetch'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onUnmounted<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onUnmounted'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> onUpdated<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'onUpdated'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> provide<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'provide'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> reactive<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'reactive'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> <span class="token keyword">readonly</span><span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'readonly'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> ref<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'ref'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> resolveComponent<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'resolveComponent'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> shallowReactive<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'shallowReactive'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> shallowReadonly<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'shallowReadonly'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> shallowRef<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'shallowRef'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> toRaw<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'toRaw'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> toRef<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'toRef'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> toRefs<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'toRefs'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> triggerRef<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'triggerRef'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> unref<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'unref'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> useAttrs<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'useAttrs'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> useCssModule<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'useCssModule'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> useCssVars<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'useCssVars'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> useRoute<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue-router'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'useRoute'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> useRouter<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue-router'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'useRouter'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> useSlots<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'useSlots'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> watch<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'watch'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> watchEffect<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'watchEffect'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> watchPostEffect<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'watchPostEffect'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> watchSyncEffect<span class="token operator">:</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'watchSyncEffect'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h3 id="_2-2-3-vite-2-配置环境"><a href="#_2-2-3-vite-2-配置环境" class="header-anchor">#</a> 2.2.3  vite 2 配置环境</h3> <h4 id="step1-根目录中配置环境文件"><a href="#step1-根目录中配置环境文件" class="header-anchor">#</a> step1    根目录中配置环境文件</h4> <p>.env.dev中写入</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>NODE_ENV = &quot;development&quot;
VITE_BASE_URL='http://localhost:8088/'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>.env.pro中写入</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>NODE_ENV = &quot;production&quot;
VITE_BASE_URL='http://localhost:8089/'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>启动就可以在package.json</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;vite&quot;: &quot; vite --mode dev &quot;,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="step2-vite-config-ts中"><a href="#step2-vite-config-ts中" class="header-anchor">#</a> step2: vite.config.ts中</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig<span class="token punctuation">,</span> loadEnv <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>
<span class="token keyword">import</span> AutoImport <span class="token keyword">from</span> <span class="token string">&quot;unplugin-auto-import/vite&quot;</span>
<span class="token keyword">import</span> viteCompression <span class="token keyword">from</span> <span class="token string">'vite-plugin-compression'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// let URL_RSP = '';//路径</span>
<span class="token comment">// let URL_IM = '';//路径</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">,</span> <span class="token string">&quot;环境&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> mode <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//默认会读取我们的env文件 --mode是dev那么就会去到 .env.dev的文件</span>
  <span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token function">loadEnv</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 获取.env文件里定义的环境变量</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;环境&quot;</span><span class="token punctuation">,</span> env<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token constant">VITE_USER_NODE_ENV</span> <span class="token operator">==</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 生产环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------生产环境----------&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// URL_RSP = proEnv.URL_RSP;</span>
    <span class="token comment">// URL_IM = proEnv.URL_IM;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token constant">VITE_USER_NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 测试环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------开发环境----------&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// URL_RSP = testEnv.URL_RSP;</span>
    <span class="token comment">// URL_IM = testEnv.URL_IM;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 开发环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------测试环境----------&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// URL_RSP = devEnv.URL_RSP;</span>
    <span class="token comment">// URL_IM = devEnv.URL_IM;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    <span class="token comment">// envPrefix:&quot;VITE&quot;,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">imports</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue-router&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 自动导入vue和vue-router相关函数</span>
      <span class="token literal-property property">dts</span><span class="token operator">:</span> <span class="token string">&quot;src/auto-import.d.ts&quot;</span> <span class="token comment">// 生成 `auto-import.d.ts` 全局声明</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">viteCompression</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">//生成压缩包gz</span>
      <span class="token literal-property property">verbose</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 输出压缩成功</span>
      <span class="token literal-property property">disable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否禁用</span>
      <span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 体积大于阈值会被压缩，单位是b</span>
      <span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">'gzip'</span><span class="token punctuation">,</span> <span class="token comment">// 压缩算法</span>
      <span class="token literal-property property">ext</span><span class="token operator">:</span> <span class="token string">'.gz'</span><span class="token punctuation">,</span><span class="token comment">// 生成的压缩包后缀</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">//viteconfig 和 tsconfig中都设置 设置路径</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'@'</span><span class="token operator">:</span> <span class="token string">'/src/'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'@core'</span><span class="token operator">:</span> <span class="token string">'/src/core/'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//生产路径的基本路径</span>
    <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span>
    <span class="token comment">// 反向代理</span>
    <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">//开始热更新</span>
      <span class="token literal-property property">hmr</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
      <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 是否自动在浏览器打开</span>
      <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">// 是否开启 https</span>
      <span class="token literal-property property">https</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'https://blog.csdn.net/weixin_45292658'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token function-variable function">rewrite</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\/api</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">//浏览器兼容性  &quot;esnext&quot;|&quot;modules&quot;</span>
      <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;modules&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">//指定输出路径</span>
      <span class="token literal-property property">outDir</span><span class="token operator">:</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">//生成静态资源的存放路径</span>
      <span class="token literal-property property">assetsDir</span><span class="token operator">:</span> <span class="token string">&quot;assets&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">//小于此阈值的导入或引用资源将内联为 base64 编码，以避免额外的 http 请求。设置为 0 可以完全禁用此项</span>
      <span class="token literal-property property">assetsInlineLimit</span><span class="token operator">:</span> <span class="token number">4096</span><span class="token punctuation">,</span>
      <span class="token comment">//启用/禁用 CSS 代码拆分</span>
      <span class="token literal-property property">cssCodeSplit</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">//构建后是否生成 source map 文件</span>
      <span class="token literal-property property">sourcemap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token comment">//自定义底层的 Rollup 打包配置</span>
      <span class="token literal-property property">rollupOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">chunkFileNames</span><span class="token operator">:</span> <span class="token string">'js/[name]-[hash].js'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">entryFileNames</span><span class="token operator">:</span> <span class="token string">'js/[name]-[hash].js'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">assetFileNames</span><span class="token operator">:</span> <span class="token string">'[ext]/[name]-[hash].[ext]'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">//@rollup/plugin-commonjs 插件的选项</span>
      <span class="token literal-property property">commonjsOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>

      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">//当设置为 true，构建后将会生成 manifest.json 文件</span>
      <span class="token literal-property property">manifest</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token comment">// 设置为 false 可以禁用最小化混淆，</span>
      <span class="token comment">// 或是用来指定使用哪种混淆器</span>
      <span class="token comment">// boolean | 'terser' | 'esbuild'</span>
      <span class="token literal-property property">minify</span><span class="token operator">:</span> <span class="token string">&quot;terser&quot;</span><span class="token punctuation">,</span> <span class="token comment">//terser 构建后文件体积更小</span>
      <span class="token comment">//传递给 Terser 的更多 minify 选项。</span>
      <span class="token comment">// 清空console.log</span>
      <span class="token literal-property property">terserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">drop_console</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token literal-property property">drop_debugger</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">//设置为 false 来禁用将构建后的文件写入磁盘</span>
      <span class="token literal-property property">write</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">//默认情况下，若 outDir 在 root 目录下，则 Vite 会在构建时清空该目录。</span>
      <span class="token literal-property property">emptyOutDir</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">//启用/禁用 brotli 压缩大小报告</span>
      <span class="token literal-property property">brotliSize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">//chunk 大小警告的限制</span>
      <span class="token literal-property property">chunkSizeWarningLimit</span><span class="token operator">:</span> <span class="token number">500</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br></div></div><h3 id="_2-2-4-element-plus导入"><a href="#_2-2-4-element-plus导入" class="header-anchor">#</a> 2.2.4 element-plus导入</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i vite-plugin-style-import@2.0 vite-plugin-components -D
npm i consola -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_5-3-细节"><a href="#_5-3-细节" class="header-anchor">#</a> 5.3 细节</h2> <h3 id="_5-3-1-d-ts文件"><a href="#_5-3-1-d-ts文件" class="header-anchor">#</a> 5.3.1 .d.ts文件</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>通过declare声明的类型或者变量或者模块，在tsconfig<span class="token punctuation">.</span>json的include包含的文件范围内，都可以直接引用而不用去<span class="token keyword">import</span>或者<span class="token keyword">import</span> type相应的变量或者类型。
<span class="token literal-property property">tsconfig再这里https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>tslang<span class="token punctuation">.</span>cn<span class="token operator">/</span>docs<span class="token operator">/</span>handbook<span class="token operator">/</span>tsconfig<span class="token operator">-</span>json<span class="token punctuation">.</span>html。
可以自动提示。但是只能在ts文件中智能提示和自动引入，vue文件会报错
<span class="token operator">--</span><span class="token number">2.</span>新建src<span class="token operator">/</span>type<span class="token operator">/</span>xx<span class="token punctuation">.</span>d<span class="token punctuation">.</span>ts文件
<span class="token comment">// 1.定义变量</span>
declare <span class="token keyword">let</span> <span class="token literal-property property">a</span> <span class="token operator">:</span>string<span class="token punctuation">;</span>
<span class="token comment">// 2.方法的声明最好直接在vue里面定义</span>
declare <span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">id</span><span class="token operator">:</span>number</span><span class="token punctuation">)</span>  
<span class="token comment">// 3.</span>
declare type Asd <span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span>number<span class="token punctuation">,</span>
  <span class="token literal-property property">sadasdasd</span><span class="token operator">:</span>string
<span class="token punctuation">}</span>

<span class="token comment">// 这玩意用于 JQuery 之类的全局类</span>
declare namespace <span class="token constant">API</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">url</span><span class="token operator">:</span> string<span class="token punctuation">,</span> settings<span class="token operator">?</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_5-3-2-vue3-tsconfig-json"><a href="#_5-3-2-vue3-tsconfig-json" class="header-anchor">#</a> 5.3.2 vue3 | tsconfig.json</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token punctuation">{</span>
  
  <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/*&quot;</span><span class="token punctuation">]</span>  <span class="token comment">// 这里需要配置</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/**/*.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./src/**/*.d.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./src/**/*.tsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;src/**/*.vue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./node_modules/**/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/*&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 1.编译成哪个版本的js </span>
    <span class="token string-property property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;esnext&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// // 2.指定模板生成的形式</span>
    <span class="token string-property property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;esnext&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// // 3.决定如何处理模块</span>
    <span class="token string-property property">&quot;moduleResolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// &quot;strict&quot;: true,</span>
    <span class="token string-property property">&quot;jsx&quot;</span><span class="token operator">:</span> <span class="token string">&quot;preserve&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;sourceMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 编译过程中需要引入的库文件的列表</span>
    <span class="token string-property property">&quot;lib&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;esnext&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dom&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 忽略所有的声明文件（ *.d.ts）的类型检查。</span>
    <span class="token string-property property">&quot;skipLibCheck&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;suppressImplicitAnyIndexErrors&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_5-3-3-eslintrc-js"><a href="#_5-3-3-eslintrc-js" class="header-anchor">#</a> 5.3.3 .eslintrc.js</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  root<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  env<span class="token operator">:</span> <span class="token punctuation">{</span>
    node<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;plugin:vue/vue3-essential&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;eslint:recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@vue/typescript/recommended&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// &quot;@vue/prettier&quot;,</span>
    <span class="token string">&quot;@vue/prettier/@typescript-eslint&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  parserOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    ecmaVersion<span class="token operator">:</span> <span class="token number">2020</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;no-console&quot;</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;warn&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;no-debugger&quot;</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;warn&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 0 = off, 1 = warn, 2 = error   error 会自己报错</span>
    <span class="token comment">// 解决了不写类型的问题</span>
    <span class="token string-property property">&quot;@typescript-eslint/no-inferrable-types&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 只用了一次会报错的问题</span>
    <span class="token string-property property">&quot;prefer-const&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">//.d.ts导入的问题</span>
    <span class="token string-property property">&quot;no-undef&quot;</span><span class="token operator">:</span><span class="token string">&quot;off&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 解决了vue.config.js必须要用require的问题</span>
    <span class="token string-property property">'@typescript-eslint/no-var-requires'</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_5-3-4"><a href="#_5-3-4" class="header-anchor">#</a> 5.3.4  .</h3> <h2 id="_5-4-自定义指令"><a href="#_5-4-自定义指令" class="header-anchor">#</a> 5.4 自定义指令</h2> <h3 id="_5-4-0-基本"><a href="#_5-4-0-基本" class="header-anchor">#</a> 5.4.0 基本</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>vue3的自定义指令周期变成了 本身周期的周期
<span class="token operator">--</span><span class="token number">1.</span><span class="token punctuation">(</span>vue2<span class="token operator">:</span>mounted<span class="token punctuation">)</span>bind<span class="token operator">:</span>只调⽤⼀次，指令第⼀次绑定到元素时调⽤，⽤这个钩⼦函数可以定义⼀个绑定时执⾏⼀次的初始化动作。
<span class="token operator">--</span><span class="token number">2.</span> <span class="token literal-property property">inserted</span><span class="token operator">:</span>被绑定元素插⼊⽗节点时调⽤（⽗节点存在即可调⽤，不必存在于document中）。
<span class="token operator">--</span><span class="token number">3.</span> <span class="token punctuation">(</span>vue2<span class="token operator">:</span>updated<span class="token punctuation">)</span>update<span class="token operator">:</span>被绑定于元素所在的模板更新时调⽤，⽽⽆论绑定值是否变化。通过⽐较更新前后的绑定值，可以忽略不必要的模板更新。
<span class="token operator">--</span><span class="token number">4.</span> <span class="token literal-property property">componentUpdated</span><span class="token operator">:</span>被绑定元素所在模板完成⼀次更新周期时调⽤。
<span class="token operator">--</span><span class="token number">5.</span> <span class="token literal-property property">unbind</span><span class="token operator">:</span>只调⽤⼀次，指令与元素解绑时调⽤。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_5-4-1-权限"><a href="#_5-4-1-权限" class="header-anchor">#</a> 5.4.1 权限</h3> <h4 id="_5-4-1-1-src-directive-hasbutton-ts"><a href="#_5-4-1-1-src-directive-hasbutton-ts" class="header-anchor">#</a> 5.4.1.1 src/directive/hasButton.ts</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> hasPermission <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">Vue</span><span class="token operator">:</span>any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//自定义指令v-has：</span>
        Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'has'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span>any<span class="token punctuation">,</span> <span class="token literal-property property">binding</span><span class="token operator">:</span>any<span class="token punctuation">,</span> <span class="token literal-property property">vnode</span><span class="token operator">:</span>any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>binding<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// let tooltipNode = vnode.children.find((childrenCmpt:any) =&gt; childrenCmpt.component?.type.name == 'ElTooltip')</span>
                    <span class="token comment">// tooltipNode.component.props.disabled = false</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    vnode<span class="token punctuation">.</span>el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">display:none</span><span class="token template-punctuation string">`</span></span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//权限检查方法</span>
        <span class="token keyword">function</span> <span class="token function">checkPermission</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span>any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> isExist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> userlogin <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;userlogin&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;[]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            userlogin <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">hasPermission</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;edit&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;del&quot;</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">let</span> buttonArr <span class="token operator">=</span> userlogin<span class="token punctuation">.</span>hasPermission
            <span class="token comment">//判断是否按钮有权限</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>buttonArr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                isExist <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> isExist<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> hasPermission<span class="token punctuation">;</span>




</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="_5-4-1-2-src-main-ts"><a href="#_5-4-1-2-src-main-ts" class="header-anchor">#</a> 5.4.1.2 src/main.ts</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> permission <span class="token keyword">from</span> <span class="token string">'./directive/permission/hasButton'</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>permission<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_5-4-1-2-src-test-vue"><a href="#_5-4-1-2-src-test-vue" class="header-anchor">#</a> 5.4.1.2 src/test.vue</h4> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-has</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token punctuation">&quot;</span>del&quot;<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tooltip</span> <span class="token attr-name">placement</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>无权访问,请联系管理员<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tooltip<span class="token punctuation">&quot;</span></span> <span class="token attr-name">disabled</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>删除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tooltip</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:0;" data-v-b57cc07c data-v-7dd95ae2></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/front-base-know-blog/assets/js/app.a8d1efe2.js" defer></script><script src="/front-base-know-blog/assets/js/3.a15d85cc.js" defer></script><script src="/front-base-know-blog/assets/js/1.704023bf.js" defer></script><script src="/front-base-know-blog/assets/js/31.52bd8e5c.js" defer></script>
  </body>
</html>
