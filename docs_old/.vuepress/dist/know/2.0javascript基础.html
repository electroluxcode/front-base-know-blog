<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2.JavaScript基础 | Electrolux博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/front-base-know-blog/assets/css/0.styles.1c0757d4.css" as="style"><link rel="preload" href="/front-base-know-blog/assets/js/app.f7f2110a.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/3.a15d85cc.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/1.704023bf.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/15.bae72d59.js" as="script"><link rel="prefetch" href="/front-base-know-blog/assets/js/10.dafae2d3.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/11.bc1846bd.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/12.95cbf02c.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/13.3014b02a.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/14.97e151e2.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/16.b9d011a5.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/17.45b98f60.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/18.b414b726.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/19.4233465f.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/20.564615b9.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/21.50269487.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/22.2b284936.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/23.96af98a3.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/24.54911945.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/25.f7a39fed.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/26.291a711c.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/27.962aea25.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/28.245404b9.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/29.85775c2f.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/30.91c096b6.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/31.4dd9bce7.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/32.a4a752c1.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/33.f2de3ea4.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/34.21ba0bae.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/4.11c729f5.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/5.41f9e3e8.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/6.de585bd1.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/7.234840ab.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/8.f66853e2.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/9.aa5ddeee.js">
    <link rel="stylesheet" href="/front-base-know-blog/assets/css/0.styles.1c0757d4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Electrolux博客</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-base-know-blog/" class="home-link router-link-active"><!----> <span class="site-name">Electrolux博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-base-know-blog/know/1.html.html" class="nav-link"><i class="undefined"></i>
  html
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/2.javascript基础.html" class="nav-link"><i class="undefined"></i>
  js基础
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/5.css.html" class="nav-link"><i class="undefined"></i>
  css
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      常用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/7.算法.html" class="nav-link"><i class="undefined"></i>
  设计模式 | 算法
</a></li><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/10.性能优化.html" class="nav-link"><i class="undefined"></i>
  性能优化
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>23</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/front-base-know-blog/know/1.html.html" class="nav-link"><i class="undefined"></i>
  html
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/2.javascript基础.html" class="nav-link"><i class="undefined"></i>
  js基础
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/5.css.html" class="nav-link"><i class="undefined"></i>
  css
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      常用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/7.算法.html" class="nav-link"><i class="undefined"></i>
  设计模式 | 算法
</a></li><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/10.性能优化.html" class="nav-link"><i class="undefined"></i>
  性能优化
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/1.html.html" class="sidebar-link">1.HTML（浏览器机制）</a></li><li><a href="/front-base-know-blog/know/2.0javascript基础.html" class="active sidebar-link">2.JavaScript基础</a></li><li><a href="/front-base-know-blog/know/2.1.javascript基础.html" class="sidebar-link">2.1 JavaScript基础</a></li><li><a href="/front-base-know-blog/know/2.2.ts.html" class="sidebar-link">2.2. ts</a></li><li><a href="/front-base-know-blog/know/2.9.javascript代码输出题.html" class="sidebar-link">2.9 JavaScript代码输出题</a></li><li><a href="/front-base-know-blog/know/3.javascript-es6.html" class="sidebar-link">3.JavaScript-es6</a></li><li><a href="/front-base-know-blog/know/4.javascript-手写题.html" class="sidebar-link">4.JS手写题</a></li><li><a href="/front-base-know-blog/know/5.css.html" class="sidebar-link">5.CSS</a></li><li><a href="/front-base-know-blog/know/6.bug.html" class="sidebar-link">6.bug | 脚本工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>八股</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="sidebar-link">1.计算机网络</a></li><li><a href="/front-base-know-blog/know/八股/2.Git.html" class="sidebar-link">2.Git</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>框架 | 工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/框架/1.vue.html" class="sidebar-link">1.vue | 主流方案对比</a></li><li><a href="/front-base-know-blog/know/框架/2.react.html" class="sidebar-link">/know/框架/2.react.html</a></li><li><a href="/front-base-know-blog/know/框架/3.ssr.html" class="sidebar-link">3.ssr</a></li><li><a href="/front-base-know-blog/know/框架/4.微前端.html" class="sidebar-link">4.微前端</a></li><li><a href="/front-base-know-blog/know/框架/6.nginx.html" class="sidebar-link">6.nginx</a></li><li><a href="/front-base-know-blog/know/框架/7.python.html" class="sidebar-link">7.python</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>优化 | 工程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/优化/1.性能优化和安全.html" class="sidebar-link">1.性能优化与安全</a></li><li><a href="/front-base-know-blog/know/优化/2.webpack.html" class="sidebar-link">2.webpack</a></li><li><a href="/front-base-know-blog/know/优化/3.算法.html" class="sidebar-link">3.实用算法 | 设计模式</a></li><li><a href="/front-base-know-blog/know/优化/4.性能优化.html" class="sidebar-link">4.性能优化</a></li><li><a href="/front-base-know-blog/know/优化/5.组件库构造.html" class="sidebar-link">5.组件库构建 | 脚手架建设</a></li><li><a href="/front-base-know-blog/know/优化/6.webrtc.html" class="sidebar-link">6.webrtc</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">2.JavaScript基础</h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="_2-javascript基础"><a href="#_2-javascript基础" class="header-anchor">#</a> 2.JavaScript基础</h1> <p></p><div class="table-of-contents"><ul><li><a href="#_2-1基础知识">2.1基础知识</a><ul><li><a href="#_2-1-0-canvas-video-image-blob">2.1.0 canvas | video | image | blob</a></li><li><a href="#_2-1-1-blob-file-filereader-base64-todataurl">2.1.1 blob | file | fileReader |  base64 | todataurl</a></li><li><a href="#_2-1-2-var-let-const-函数和变量变量提升-vo-ao-上下文">2.1.2.var,let,const | 函数和变量变量提升 | vo ao 上下文</a></li><li><a href="#_2-1-3-null-undefined-true-false-nan-判空-易错">2.1.3.null | undefined  |  true | false | nan | 判空  | 易错</a></li><li><a href="#_2-1-4-setinterval-settimeout-误差">2.1.4 setInterval | setTimeout | 误差</a></li><li><a href="#_2-1-5-响应头-请求头-cookies-加密-token-cookies-session-oauth">2.1.5 响应头 | 请求头 | cookies |  加密  |  token  | cookies | session | oauth</a></li><li><a href="#_2-1-6-websocket-eventsource-sse-http长连接">2.1.6 WebSocket  |  EventSource(sse) | HTTP长连接</a></li><li><a href="#_2-1-7-this-function里面-use-strict">2.1.7.this | function里面  | &quot;use strict&quot; |</a></li><li><a href="#_2-1-8-深浅拷贝">2.1.8.深浅拷贝</a></li><li><a href="#_2-1-9-无状态组件-受控组件-合成事件-父子组件渲染">2.1.9 无状态组件 | 受控组件 |  合成事件 | 父子组件渲染</a></li><li><a href="#_2-1-10-原型-原型链">2.1.10.原型 | 原型链</a></li><li><a href="#_2-1-11-继承">2.1.11.继承</a></li><li><a href="#_2-1-13-new操作符-手写">2.1.13.new操作符 | 手写</a></li><li><a href="#_2-1-14-编程思想-命令式-状态机-柯里化-优雅降级">2.1.14.编程思想 |  命令式 | 状态机 | 柯里化 | 优雅降级</a></li><li><a href="#_2-1-15-缓存-强制重新加载-worker">2.1.15 缓存 | 强制重新加载 | worker</a></li><li><a href="#_2-1-16-event-loop-事件循环-4个概念-调用栈清空之后触发event-loop">2.1.16.  Event Loop | 事件循环(4个概念) | 调用栈清空之后触发Event loop</a></li><li><a href="#_2-1-17">2.1.17 &amp;&amp; |  ||</a></li><li><a href="#_2-1-18-bind-apply-call">2.1.18  bind  | apply |  call</a></li><li><a href="#_2-1-19-类型判断-类型转化">2.1.19 类型判断 |  类型转化</a></li><li><a href="#_2-1-20-class-super-面向对象">2.1.20  class | super | 面向对象</a></li><li><a href="#_2-1-21-前端竟态问题-abortcontroller-abort-promise的取消">2.1.21  前端竟态问题 | AbortController | abort | promise的取消</a></li><li><a href="#_2-1-22-栈-堆-队列-内存溢出解决方案">2.1.22 栈 | 堆 | 队列 | 内存溢出解决方案</a></li><li><a href="#_2-1-23-线程与进程-开销和内存空间-单线程好处">2.1.23.线程与进程(开销和内存空间) |  单线程好处</a></li><li><a href="#_2-1-24-html元素-attribute">2.1.24 html元素 | Attribute</a></li><li><a href="#_2-1-25-事件委托-addeventlistener">2.1.25  事件委托 | addEventListener</a></li><li><a href="#_2-1-26-作用域链-执行上下文">2.1.26.作用域链   | 执行上下文</a></li><li><a href="#_2-1-27-babel-polyfill-core-js">2.1.27 babel |  polyfill | core.js</a></li><li><a href="#_2-1-28-加密算法">2.1.28 加密算法</a></li><li><a href="#_2-1-30-async-await-promise-版本差异-node-的事件循环比较">2.1.30 async | await | promise| 版本差异 | node 的事件循环比较</a></li><li><a href="#_2-1-31-scolltop-clientheight-offsetheight-intersectionobserver-clientx是可视坐标-pagex是绝对坐标">2.1.31 scolltop | clientheight | offsetheight  | IntersectionObserver |  clientx是可视坐标，pagex是绝对坐标</a></li><li><a href="#_2-1-32-监听dom元素-mutationobserver">2.1.32 监听dom元素 | MutationObserver</a></li><li><a href="#_2-1-33-arguments">2.1.33 arguments</a></li><li><a href="#_2-1-35-postmessage">2.1.35  postmessage</a></li><li><a href="#_2-1-37-innertext-textcontent-nodevalue">2.1.37  innerText |  textContent |  nodeValue</a></li><li><a href="#_2-1-38-geo-speech-api">2.1.38  geo | speech | api</a></li><li><a href="#_2-1-39-正则">2.1.39  正则</a></li><li><a href="#_2-1-40-一些坑-try-catch-settimeout-async-赋值">2.1.40 一些坑 | try catch  | settimeout | async |  赋值</a></li></ul></li><li><a href="#_2-2-快问快答">2.2 快问快答</a></li><li><a href="#_2-3-项目中js高级">2.3 项目中js高级</a><ul><li><a href="#_2-3-1-js引入-css-js">2.3.1 js引入 css js</a></li><li><a href="#_2-3-2-禁止自动滑动">2.3.2 禁止自动滑动</a></li><li><a href="#_2-3-3-canvas成图片">2.3.3 canvas成图片</a></li><li><a href="#_2-3-4-iframe-postmessage">2.3.4 iframe | postmessage</a></li></ul></li><li><a href="#_2-4-webgl">2.4 webgl</a><ul><li><a href="#_2-4-1-webgl基础">2.4.1 webgl基础</a></li><li><a href="#_2-4-2-实操">2.4.2 实操</a></li></ul></li><li><a href="#_2-5-js工程化概述">2.5 js工程化概述</a><ul><li><a href="#_2-5-1-polyfill-实操">2.5.1 polyfill 实操</a></li></ul></li><li><a href="#_2-6-加载字体">2.6 加载字体</a></li><li><a href="#_2-7-tc39-会议">2.7 tc39 会议</a></li><li><a href="#_2-8-项目中的">2.8 项目中的</a><ul><li><a href="#_2-8-1-v-for">2.8.1  v-for</a></li><li><a href="#_2-8-2-懒加载">2.8.2 懒加载</a></li></ul></li></ul></div><p></p> <h2 id="_2-1基础知识"><a href="#_2-1基础知识" class="header-anchor">#</a> 2.1基础知识</h2> <h3 id="_2-1-0-canvas-video-image-blob"><a href="#_2-1-0-canvas-video-image-blob" class="header-anchor">#</a> 2.1.0 canvas | video | image | blob</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>canvas 画板
querySelector 获取dom 元素 
然后getcontext
但后添加mousedown 和 mousemove 和mouseup事件
<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>canvas 撤销
todataurl 缓存住。然后就可以进行回退
<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>canvas变成base64
canvasElement<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token number">4.</span>功能
<span class="token operator">--</span><span class="token number">4.1</span> 文字blob

<span class="token keyword">let</span> blobInit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;helloworld&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> blobHandle <span class="token operator">=</span> blobInit<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//这里后面跟着res.onload(()=&gt;{}) 也可以</span>
res<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>blobHandle<span class="token punctuation">)</span>
<span class="token comment">// 输出</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">4.2</span> image 变成 canvas（ctx<span class="token punctuation">.</span>drawImage） 和 <span class="token function">base64数据</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>toDataURL<span class="token punctuation">)</span>
<span class="token comment">// 上面的是图片跨域的错误，可以添加crossOrigin来进行避免</span>
<span class="token comment">// 功能点2：图像输出.图片加载完，再draw 和 toDataURL</span>
<span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span>
canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">200</span>
canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">200</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//创建新的图片对象</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/e08da34488b114bd4c665ba2fa520a31.svg'</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;crossOrigin&quot;</span><span class="token punctuation">,</span><span class="token string">'Anonymous'</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//</span>
    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">'image/png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>



<span class="token operator">--</span><span class="token number">4.3</span> video 加 滤镜
直接document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#video&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>filter <span class="token operator">=</span> <span class="token string">&quot;contrast(200%)&quot;</span>

<span class="token operator">--</span><span class="token number">4.4</span> video 截图
<span class="token comment">//step1:通过canvas 然后ctx.drawImage</span>
<span class="token comment">//step2:然后通过todataurl就可以了</span>

<span class="token operator">--</span><span class="token number">4.5</span> 下载
<span class="token keyword">function</span> <span class="token function">downloadBlob</span><span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
    <span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    a<span class="token punctuation">.</span>href <span class="token operator">=</span> url
    a<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>blob<span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 释放 URL 地址</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>



<span class="token comment">//-------------------------转化-------------------------</span>

<span class="token operator">--</span><span class="token number">5</span><span class="token punctuation">.</span>file <span class="token operator">|</span> blob 变成 dataurl 和 base64（这个阶段是最好用的，可以下载） a<span class="token punctuation">.</span>href <span class="token punctuation">.</span>download就可以了

<span class="token number">5.1</span><span class="token punctuation">.</span>file<span class="token operator">-</span><span class="token operator">&gt;</span>base64（dataurl）：createObjectURL  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1：&quot;</span><span class="token punctuation">,</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token number">5.2</span><span class="token punctuation">.</span>file<span class="token operator">-</span><span class="token operator">&gt;</span>base64：FileReader readAsDataURL
<span class="token keyword">const</span> fr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
fr<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
fr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2：&quot;</span><span class="token punctuation">,</span>fr<span class="token punctuation">.</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token number">6</span><span class="token punctuation">.</span>img video变成 canvas
<span class="token comment">// img.onload(()=&gt;{console.log(img)})  </span>
<span class="token comment">// ctx.drawImage(video)</span>


<span class="token operator">--</span><span class="token number">7</span><span class="token punctuation">.</span>canvas 变成 dataurl 和 base64
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;canvas-&gt;base64格式：&quot;</span><span class="token punctuation">,</span>canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">'image/png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//2.canvas-&gt;base64格式：toBlob</span>
canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;canvas-&gt;blob格式：&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token operator">--</span><span class="token number">8.</span>下载
<span class="token keyword">function</span> <span class="token function">downloadImg</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> aLink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    <span class="token comment">// 文件名后缀需要和dataurl表示的相同，否则可能乱码</span>
    aLink<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">'fileName.png'</span> 
    aLink<span class="token punctuation">.</span>href <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">'image/png'</span><span class="token punctuation">)</span>
    aLink<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>aLink<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br></div></div><h3 id="_2-1-1-blob-file-filereader-base64-todataurl"><a href="#_2-1-1-blob-file-filereader-base64-todataurl" class="header-anchor">#</a> 2.1.1 blob | file | fileReader |  base64 | todataurl</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>关系：
<span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>blob<span class="token operator">:</span>是一切的源头<span class="token comment">// 可以 new blob对象创造 text | blob 对象可以slice</span>
<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>fileReader<span class="token operator">:</span>可以 <span class="token keyword">new</span> 一个出来，然后可以用readAsText和readAsDataURL后面跟着blob或者文件对象 <span class="token comment">// 就可以reader.result拿到值  如果是图片就可以点进去</span>
<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>file<span class="token operator">:</span>是比blob多了一个lastmodify和name <span class="token comment">// 这是只能通过input是file对象拿到的</span>
<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>base64<span class="token operator">:</span><span class="token function">btoa</span><span class="token punctuation">(</span><span class="token string">'javascript'</span><span class="token punctuation">)</span> 和 <span class="token function">atoa</span><span class="token punctuation">(</span><span class="token string">&quot;xxxx&quot;</span><span class="token punctuation">)</span>
<span class="token operator">--</span><span class="token number">5</span><span class="token punctuation">.</span>todataurl可以变成bases64的值


<span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>  <span class="token comment">// new blob对象</span>
<span class="token function">createObjectURL</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 

<span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>blob 对象
branary large object 二进制大数据，可以读取，不能修改。

像是分块上传分块我们可以用slice进行分块
<span class="token keyword">let</span> blobInit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;helloworld&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> blobHandle <span class="token operator">=</span> blobInit<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//这里后面跟着res.onload(()=&gt;{}) 也可以</span>

res<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>blobHandle<span class="token punctuation">)</span>
res<span class="token punctuation">.</span>result  <span class="token comment">//输出hello</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>blobHandle<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">2.</span> file 对象
是一个特殊的blob<span class="token punctuation">.</span><span class="token function">比blob多了一个lastmodify和name</span><span class="token punctuation">(</span>上传文件的名字<span class="token punctuation">)</span>。还有可能是fileList

<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;type&quot;</span><span class="token operator">&gt;</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#type&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">3</span> fileReader 对象
readAsText<span class="token operator">/</span>DataURL<span class="token operator">/</span>ArrayBuffer<span class="token operator">/</span>binaryString

<span class="token keyword">let</span> reader<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">fileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//四个方法</span>
<span class="token comment">//3.1.reader.readAsText</span>
<span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token string">&quot;helloworld&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
reader<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
输出reader<span class="token punctuation">.</span>result

<span class="token comment">//3.2.reader.readAsDataURL</span>
<span class="token operator">&lt;</span>input type <span class="token operator">=</span> “file”<span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">//3.3 读成base64格式的字符串，后面读了之后我们要</span>
<span class="token keyword">let</span> object <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>“<span class="token punctuation">.</span>test”<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> render <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">fileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	render<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	reader<span class="token punctuation">.</span><span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  		e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

使用方法。url中直接输入可以显示。但是可能会不全。最好是img标签中直接输入src，然后里面直接是这个src地址

<span class="token comment">//3.4 reader.readAsArrayBuffer</span>
<span class="token function">arrayBuffer也是一个黑盒对象，跟blob很像。然后有两种类型，一种是dataView，还有一个是typeBuffer</span><span class="token punctuation">(</span>里面有<span class="token number">9</span>个内容<span class="token punctuation">)</span><span class="token function">。前者有点像ts的record类型</span><span class="token punctuation">(</span>里面可以混合一堆东西），后者是单一类型

用于对二进制文件进行操作。然后blob代表的是一个整体的文件，适合用来进行传输

<span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token function">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token comment">//8个字节</span>
<span class="token keyword">new</span> <span class="token class-name">Int8Array</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token comment">//然后这玩意是一个数组可以直接改</span>

<span class="token keyword">let</span> test  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">dataView</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>  <span class="token comment">//然后用set /get 来进行数组的添加和查询</span>

<span class="token comment">//3.5 binaryString</span>

<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>object Url
这是一种表示file object 和 blob object的url


<span class="token operator">&lt;</span>input type <span class="token operator">=</span> “file”<span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">//读成base64格式的字符串，后面读了之后我们要</span>
<span class="token keyword">let</span> object <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>“<span class="token punctuation">.</span>test”<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	<span class="token keyword">let</span> render <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">fileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
	<span class="token comment">//输出的格式类似于 localhost：8080/9f9f9f9f</span>
	
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token operator">--</span><span class="token number">5</span><span class="token punctuation">.</span>base64
js中有两个函数用来加密和解密base64的数据。

<span class="token function">btoa</span><span class="token punctuation">(</span><span class="token string">'javascript'</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token comment">//加密：输出 amF2Yxxxx</span>
<span class="token function">atoa</span><span class="token punctuation">(</span><span class="token string">'amF2Yxxxx'</span><span class="token punctuation">)</span> <span class="token comment">//解密：输出javascript。</span>
一般来说用来 将canvas 变成 base64的照片（canvas元素<span class="token punctuation">.</span><span class="token function">toDataUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ） 或者是 把图片变成base64图片（readAsDataURL） 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br></div></div><h3 id="_2-1-2-var-let-const-函数和变量变量提升-vo-ao-上下文"><a href="#_2-1-2-var-let-const-函数和变量变量提升-vo-ao-上下文" class="header-anchor">#</a> 2.1.2.var,let,const | 函数和变量变量提升 | vo ao 上下文</h3> <p>var函数作用域，let块作用域，const也是块作用域，但定义后不可重新赋地址</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
注意<span class="token keyword">const</span>比较特殊
<span class="token keyword">var</span> 变量提升。只有声明没有赋值 。 并且声明优先级，函数大于变量（即使变量处于后面的位置）。变量声明会被函数声明覆盖。越后的同名函数优先级越大

<span class="token literal-property property">暂时性死区</span><span class="token operator">:</span><span class="token keyword">let</span> <span class="token keyword">const</span>没有声明变量却引入。实例化到被创造的过程。因为只要有<span class="token keyword">let</span> <span class="token keyword">const</span><span class="token literal-property property">就会优先实例化。根本原因</span><span class="token operator">:</span>变量的生命先于使用。（块级作用域）

<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> arg <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">arg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'函数'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'LinDaiDai'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出 函数和 10</span>


<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
上下文是一个执行环境。
<span class="token number">1.</span>我们的window就是一个答的执行上下文呢，
<span class="token number">2.</span>我们的函数就是一个小的执行上下文
<span class="token number">3</span><span class="token punctuation">.</span>eval函数也是一个上下文


vo：创建执行上下文的一个变量对象，不能访问
ao：进入到一个执行上下文时，此执行上下文的变量和函数都可以访问


全局上下文的执行
<span class="token number">1.</span> 全局上下文压入栈顶
<span class="token number">2.</span> 执行某一函数就为其创建一个<span class="token constant">EC</span>，并压入栈顶
<span class="token number">3.</span> 栈顶的函数执行完之后它的<span class="token constant">EC</span>就会从<span class="token constant">ECS</span><span class="token function">中弹出，并且变量对象</span><span class="token punctuation">(</span><span class="token constant">VO</span>  varity<span class="token punctuation">)</span>随之销毁
<span class="token number">4.</span> 所有函数执行完之后<span class="token constant">ECS</span>中只剩下全局上下文，在应用关闭时销毁

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">if</span><span class="token punctuation">(</span>i  <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token comment">//这里就弹出了</span>
    <span class="token punctuation">}</span>  
    <span class="token function">foo</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出3 2 1</span>



一个上下文（ec）的执行

<span class="token keyword">function</span> <span class="token function">fn</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">c</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  b <span class="token operator">=</span> <span class="token number">20</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token number">1.</span>创建变量、参数、函数arguments对象<span class="token punctuation">;</span> vo是更加之前一点的对象（初始化）
这里的ao是
<span class="token constant">AO</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">arguments</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
		<span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">1</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
	<span class="token literal-property property">c</span><span class="token operator">:</span> reference to <span class="token keyword">function</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token number">2.</span>建立作用域链<span class="token punctuation">;</span>
<span class="token number">3.</span>确定<span class="token keyword">this</span>
<span class="token number">4.</span>变量赋值，执行函数
执行后
<span class="token constant">AO</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">arguments</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token literal-property property">c</span><span class="token operator">:</span> reference to <span class="token keyword">function</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>







<span class="token keyword">var</span>会变成window的值。
<span class="token string">&quot;use strict&quot;</span> 
<span class="token keyword">var</span> a<span class="token operator">=</span><span class="token number">2</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">display</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> number <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//输出undefined</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

<span class="token keyword">const</span>只保证变量名指向的地址不变，并不保证该地址的数据不变，所以将一个复合类型的变量声明为常量必须非常小心。
例如以下：
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 报错，[1,2,3]与[]不是同一个地址</span>
arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 不报错，变量名arr指向的地址不变，只是数据改变</span>
arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">// 块级作用域的东西</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">20</span> <span class="token punctuation">;</span>
<span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// 输出 function</span>
    <span class="token comment">// 重要 块级作用域中 function 之后的就只能在这个块级作用域了，出不了外面</span>
    a <span class="token operator">=</span> <span class="token number">30</span>
    <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;aaaa&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// 输出 30</span>
    a <span class="token operator">=</span> <span class="token number">40</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// 输出 40</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// 输出30 。如果是 let a = 20 那么这里</span>
<span class="token comment">//safari 是 40</span>
<span class="token comment">//google 和 firefox 是 30</span>


<span class="token comment">//---------------------------------------------</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">20</span> <span class="token punctuation">;</span>
<span class="token punctuation">{</span>
    a <span class="token operator">=</span> <span class="token number">30</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// 输出30</span>
    a <span class="token operator">=</span> <span class="token number">40</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// 输出40</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// 输出40</span>



</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br></div></div><h3 id="_2-1-3-null-undefined-true-false-nan-判空-易错"><a href="#_2-1-3-null-undefined-true-false-nan-判空-易错" class="header-anchor">#</a> 2.1.3.null | undefined  |  true | false | nan | 判空  | 易错</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>布尔值都是<span class="token boolean">false</span>，都是基础类型，

<span class="token keyword">undefined</span>代表未定义的值，<span class="token keyword">null</span>表示被认为设置为空的值，例如释放一个对象的内存用<span class="token keyword">null</span>，或者获取一个不存在的dom对象。

<span class="token punctuation">{</span><span class="token punctuation">}</span> 不是空对象

<span class="token keyword">if</span> 里面我以为只有<span class="token boolean">false</span>的才会跳，结果现在发现了<span class="token keyword">undefined</span>，<span class="token keyword">null</span>，<span class="token boolean">false</span>都会跳

<span class="token number">1</span><span class="token punctuation">.</span>nan是number的特殊类型。不等于任何值，即使nan<span class="token operator">==</span>nan返回值也是一个<span class="token boolean">false</span>，判断是否nan要调用isnan（）原理是会尝试转化number类型，能转化的返回<span class="token boolean">true</span>，否则返回<span class="token boolean">false</span>

<span class="token number">2.</span><span class="token boolean">false</span>的情况
<span class="token keyword">let</span> a <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出false</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">0</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出false</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">NaN</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出false</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">null</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出false</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">''</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出false</span>

<span class="token number">3.</span><span class="token boolean">true</span>的情况

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出true</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出true</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">30</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出true</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'0'</span>  <span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//输出true</span>

<span class="token number">4</span><span class="token punctuation">.</span>object判空
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'{}'</span> <span class="token operator">==</span> <span class="token boolean">false</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'[]'</span> <span class="token operator">==</span> <span class="token boolean">false</span>

<span class="token keyword">let</span> a<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span>length <span class="token comment">// a.length 这个玩意输出是undefine </span>
<span class="token keyword">let</span> a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span>length  <span class="token comment">// a.length 这个的输出是0</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="_2-1-4-setinterval-settimeout-误差"><a href="#_2-1-4-setinterval-settimeout-误差" class="header-anchor">#</a> 2.1.4 setInterval | setTimeout | 误差</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>出现原因：
setInterval、setTimeout实现都会出现误差，这源于js的单线程。
他们的回调函数并不是到时后立即执行，而是等系统计算资源空闲下来后才会执行。
setInterval、setTimeout都属于宏任务。

<span class="token operator">--</span><span class="token number">2.</span>解决方法：
在定时器开始前和运行时动态获取当前时间，用settimeout来替代setinterval


<span class="token keyword">var</span> start <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>interval <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//误差时间</span>
<span class="token keyword">var</span> nextTime <span class="token operator">=</span> interval <span class="token operator">-</span> offset<span class="token punctuation">;</span><span class="token comment">//原本间隔时间 - 误差时间</span>
<span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>doFunc<span class="token punctuation">,</span>nextTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">doFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    count<span class="token operator">++</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>start <span class="token operator">+</span> count <span class="token operator">*</span> interval<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     offset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>start <span class="token operator">+</span> count <span class="token operator">*</span> interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
    nextTime <span class="token operator">=</span> interval <span class="token operator">-</span> offset<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> nextTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>doFunc<span class="token punctuation">,</span>nextTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="_2-1-5-响应头-请求头-cookies-加密-token-cookies-session-oauth"><a href="#_2-1-5-响应头-请求头-cookies-加密-token-cookies-session-oauth" class="header-anchor">#</a> 2.1.5 响应头 | 请求头 | cookies |  加密  |  token  | cookies | session | oauth</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1.1</span> cors
<span class="token operator">--</span><span class="token number">1.1</span><span class="token number">.1</span> 请求头 
Content<span class="token operator">-</span>Type（需要注意额外的限制）  <span class="token operator">:</span> url<span class="token operator">-</span>form之类的
method ：<span class="token keyword">get</span> post 
<span class="token operator">--</span><span class="token number">1.1</span><span class="token number">.2</span> 响应头
Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin <span class="token operator">|</span> Method <span class="token operator">|</span> Headers <span class="token operator">|</span> Credentials<span class="token operator">:</span> <span class="token operator">*</span>

<span class="token number">1.2</span> websocket  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    这个只能是http1.1可以用，
   
</span><span class="token template-punctuation string">`</span></span>
<span class="token operator">--</span><span class="token number">1.2</span><span class="token number">.1</span>  请求头 
<span class="token literal-property property">Upgrade</span><span class="token operator">:</span> websocket
<span class="token literal-property property">Connection</span><span class="token operator">:</span> Upgrade
Sec<span class="token operator">-</span>WebSocket<span class="token operator">-</span>Accept<span class="token operator">:</span> server<span class="token operator">-</span>random<span class="token operator">-</span>string

<span class="token operator">--</span><span class="token number">1.2</span><span class="token number">.2</span>   响应头
代码<span class="token number">101</span>标识http协议即将更换

<span class="token number">1.3</span> 网络安全

<span class="token operator">--</span><span class="token number">1.3</span><span class="token number">.2</span>  响应头
Content<span class="token operator">-</span>Security<span class="token operator">-</span>Policy：内容安全
<span class="token constant">HSTS</span>：强制https
<span class="token constant">X</span><span class="token operator">-</span>Frame<span class="token operator">-</span>Options：禁止嵌入iframe
<span class="token constant">X</span><span class="token operator">-</span><span class="token constant">XSS</span><span class="token operator">-</span>Protection ： 禁止xss攻击

<span class="token operator">--</span><span class="token number">2</span>  cookie <span class="token operator">|</span> token（Json Web Token） <span class="token operator">|</span>

document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">&quot;yummy_cookie=choco&quot;</span><span class="token punctuation">;</span> 可以一直这样赋值

cookie 是 服务端用来保持状态的。存储在客户端，可随意篡改，不安全（4kb）。二级域名共享cookie但是可以设置<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">domain</span><span class="token template-punctuation string">`</span></span>来进行sso（单点登录<span class="token operator">-</span><span class="token operator">&gt;</span>一处登录，可以访问其他信任的系统）。之前chatGPT也常常用，不过现在不用了。会增加网络开销

<span class="token function">jwt一般来说时签名算法</span><span class="token punctuation">(</span>门禁卡<span class="token punctuation">)</span><span class="token punctuation">.</span>过期时间（<span class="token number">7</span>天）<span class="token punctuation">.</span><span class="token function">我</span><span class="token punctuation">(</span>用户信息<span class="token punctuation">)</span>    Token并不能防止<span class="token constant">CSRF</span>攻击，相反，更容易了。cookie好歹还能设个Httponly，token真是js随便用

<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>OAuth2
OAuth2 就是一种授权机制。类似于我给外卖小哥一个临时的门禁卡<span class="token punctuation">.</span>这个思想广泛用在sso上面<span class="token punctuation">.</span>
例如前后端的授权码，例如a跳转到b请求b授权用户数据（现在的微信登陆和支付宝登陆就是这样），跳转时会返回一个授权码。令牌的使用一般是header加上一个Authorization。一般我们会有两个令牌，一个用来正常使用，一个用来更新令牌

<span class="token operator">--</span><span class="token number">4.</span>非对称加密
非对称加密就是加密和解密使用的不是相同的密钥：只有同一个公钥<span class="token operator">-</span>私钥对才能正常加解密。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="_2-1-6-websocket-eventsource-sse-http长连接"><a href="#_2-1-6-websocket-eventsource-sse-http长连接" class="header-anchor">#</a> 2.1.6 WebSocket  |  EventSource(sse) | HTTP长连接</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span><span class="token constant">HTTP</span>长连接和WebSocket长连接的区别<span class="token operator">?</span>
    <span class="token constant">HTTP</span>长连接本质上还是客户端主动发起<span class="token operator">-</span>服务端应答的模式。依然是一问一答的模式，只是省略了每次的关闭和打开操作
	WebSocket  是类似 <span class="token constant">TCP</span> 长连接的通讯模式，一旦 WebSocket 连接建立后，后续数据都以帧序列的形式传输。

<span class="token operator">--</span><span class="token number">2.</span>建立连接的过程



keep alive怎么实现
消除真实dom，然后缓存虚拟dom
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> 
	http1.1 最大的好处就是多了pipeline | 管线。最大的坏处就是 每次都要重新建立连接。传输都是明文和 keep alive 
	需要Upgrade: websocket ; Connection: Upgrade Sec-WebSocket-Key

    http2对应的是websockets - rfc 8441
    websockets 不允许 101 和 upgrade  
    而要用新字段 protocol 还有用新字段 method：connect 和 sec-websocket-protocol 和
    http2 推荐用 spdy.spdy也是基于http1.1的东西
	
</span><span class="token template-punctuation string">`</span></span>
<span class="token operator">--</span><span class="token number">1.</span> 定义
websocket无限制的全双工通信，基于tcp连接，
<span class="token function">EventSource是单向通信，基于http连接，需要跨域。使用起来就直接createreadstream</span><span class="token punctuation">(</span><span class="token string">'xx'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token operator">--</span><span class="token number">2.</span> 为什么WebSocket连接可以实现全双工通信而<span class="token constant">HTTP</span>连接不行呢？

实际上<span class="token constant">HTTP</span>协议是建立在<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">TCP</span><span class="token template-punctuation string">`</span></span>协议之上的，<span class="token constant">TCP</span>协议本身就实现了全双工通信，但是<span class="token constant">HTTP</span>协议的请求－应答机制限制了全双工通信。WebSocket连接建立以后，其实只是简单规定了一下：接下来，咱们通信就不使用<span class="token constant">HTTP</span>协议了，直接互相发数据吧。

<span class="token operator">--</span><span class="token number">3.</span> ws 和 wss
ws 就是 http ，然后 wss 就是 https

<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>socketio3已经兼容了http1<span class="token punctuation">.</span><span class="token number">1</span>和http2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_2-1-7-this-function里面-use-strict"><a href="#_2-1-7-this-function里面-use-strict" class="header-anchor">#</a> 2.1.7.this | function里面  | &quot;use strict&quot; |</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token number">1.</span>默认绑定<span class="token operator">-</span><span class="token punctuation">(</span>非严格模式下<span class="token keyword">this</span>指向window<span class="token punctuation">,</span> 严格模式下<span class="token keyword">this</span>会绑定到<span class="token keyword">undefined</span>。这里的只是针对于<span class="token keyword">function</span>里面的东西<span class="token punctuation">)</span>
<span class="token number">1.1</span> 函数里面的<span class="token keyword">var</span> 由于作用域的影响，因此遍历不会影响到全局
<span class="token number">1.2</span> 在外面的<span class="token keyword">this</span><span class="token punctuation">.</span>xx 永远绑定在 window对象上面
<span class="token number">1.3</span> 如果函数里面还有函数用<span class="token keyword">this</span>也都是默认绑定

<span class="token number">2.</span>隐式绑定<span class="token operator">-</span><span class="token punctuation">(</span>当函数引用有上下文对象时<span class="token punctuation">,</span> 如 obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的调用方式<span class="token punctuation">,</span> foo内的<span class="token keyword">this</span>指向obj<span class="token punctuation">)</span>
<span class="token number">2.1</span>谁最后调用函数，<span class="token keyword">this</span>指向就是谁
<span class="token number">2.2</span> 隐式丢失的问题
<span class="token number">3.</span>显示绑定<span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">通过call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">或者apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法直接指定<span class="token keyword">this</span>的绑定对象<span class="token punctuation">,</span> <span class="token function">如foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span>。<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">call，bind，apply 虽然可以改变指向，但是在settimeout中改变不了指向</span><span class="token template-punctuation string">`</span></span>
<span class="token number">4</span><span class="token punctuation">.</span>new绑定
<span class="token number">5.</span><span class="token function">箭头函数绑定</span><span class="token punctuation">(</span><span class="token keyword">this</span>的指向由外层作用域决定的<span class="token punctuation">)</span>

<span class="token keyword">this</span> 永远指向最后调用它的那个对象
其中use strict 影响的是 <span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> 和 函数里面的<span class="token keyword">this</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

<span class="token comment">// 1.函数里面的this和直接的this </span>


普通状态下的<span class="token keyword">this</span>，定时器的


通过bind，call，apply来改变<span class="token keyword">this</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>全局作用域中指向window，箭头函数没有自己的this（所以不能用作构造函数）
优先级：new绑定&gt;显式绑定&gt;隐式绑定。</p> <p>this有四种</p> <p>函数时默认绑定，函数里的函数也是默认绑定。对象里的函数是隐式绑定。对象里面return 一个 函数 是隐式绑定指向this</p> <h4 id="第一种-默认绑定"><a href="#第一种-默认绑定" class="header-anchor">#</a> 第一种 默认绑定</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>运行在非严格模式的独立空间里面,this指向全局对象。
运行在严格模式下，this会绑定到undefined
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="第二种-隐式绑定-租房子"><a href="#第二种-隐式绑定-租房子" class="header-anchor">#</a> 第二种：隐式绑定（租房子）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>就是函数引用 有 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">上下文对象</span><span class="token template-punctuation string">`</span></span> 时。调用函数，函数内的 <span class="token keyword">this</span> 就指向谁（无论是普通对象、还是全局对象），<span class="token keyword">this</span> 永远指向最后调用它的那个对象（不考虑箭头函数）
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//输出1 隐式绑定。如果是箭头函数那么指向上一个作用域</span>


主要留意 隐式丢失问题
<span class="token number">1.</span>使用另一个变量来给函数赋值的时候会隐式丢失。则使用上一层 <span class="token keyword">this</span> 替代丢失的 <span class="token keyword">this</span>（可能是 window，可能是 obj）


<span class="token keyword">function</span> <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> foo2 <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">foo2</span><span class="token operator">:</span> obj<span class="token punctuation">.</span>foo <span class="token punctuation">}</span>
 
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 隐式调用</span>
<span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
obj2<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>


<span class="token number">2.</span>把 一个函数 当成参数 传递到 另一个函数 中时，会发生 隐式丢失 的问题

在非严格模式下，隐式丢失后，会把函数的 <span class="token keyword">this</span> 绑定到 window 上；
在严格模式下，会把函数的 <span class="token keyword">this</span> 绑定到 <span class="token keyword">undefined</span> 上；

一是<span class="token keyword">function</span>传参，二是settimeout，把函数当作参数

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="第三种-显式绑定-买房子"><a href="#第三种-显式绑定-买房子" class="header-anchor">#</a> 第三种:显式绑定（买房子）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">通过call</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> 或者 <span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>方法。第一个参数是一个对象，在调用函数时将这个对象绑定到<span class="token keyword">this</span>。因为直接指定<span class="token keyword">this</span>的绑定对象，称之为显示绑定。除了 call apply bind  。。。。forEach、map、filter<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">函数的第二个参数也是能显式绑定</span><span class="token template-punctuation string">`</span></span><span class="token keyword">this</span>的

<span class="token keyword">function</span> <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token comment">//2</span>
<span class="token comment">//Uncaught TypeError: Cannot read property 'call' of undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="第四种-new绑定"><a href="#第四种-new绑定" class="header-anchor">#</a> 第四种：new绑定</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">第一步</span><span class="token operator">:</span>创造空对象    第二步：赋值__proto__   第三步：赋值<span class="token keyword">this</span>
注意<span class="token keyword">function</span>变成<span class="token keyword">this</span>的这种写法
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window'</span>
<span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'person1'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'person2'</span><span class="token punctuation">)</span>

person1<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
person1<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span>

就会变成

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'person1'</span><span class="token punctuation">,</span>
	<span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

输出
<span class="token string">'person2'</span>
<span class="token string">'window'</span>
<span class="token string">'person1'</span>
<span class="token string">'person2'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="注意匿名函数-箭头函数"><a href="#注意匿名函数-箭头函数" class="header-anchor">#</a> 注意匿名函数，箭头函数</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
只能这样用
<span class="token function">并且foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//才能输出</span>

<span class="token keyword">function</span> <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// 2 1  最后一个是call改变了匿名函数的this</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1 2  最后一个匿名函数是window调用的</span>






<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo2</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 输出obj</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 输出 obj</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window'</span>

obj<span class="token punctuation">.</span><span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj2'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//obj2</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//obj2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj2<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">var</span> obj3 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj3'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//window.name 未定义</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//window</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj3<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> obj4 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj4'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//没定义</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//没定义</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>







</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><h3 id="_2-1-8-深浅拷贝"><a href="#_2-1-8-深浅拷贝" class="header-anchor">#</a> 2.1.8.深浅拷贝</h3> <p>解决深拷贝循环引用的方法可以是 new 一个map</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
<span class="token comment">// 该方法简单但有bug，因为JSON.stringify会忽略值为undefined、symbol的属性</span>
<span class="token keyword">function</span> <span class="token function">deepClone2</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-1-9-无状态组件-受控组件-合成事件-父子组件渲染"><a href="#_2-1-9-无状态组件-受控组件-合成事件-父子组件渲染" class="header-anchor">#</a> 2.1.9 无状态组件 | 受控组件 |  合成事件 | 父子组件渲染</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">0.</span>没有state是无状态组件，有state是有状态组件

<span class="token number">1.</span>不受控组件 <span class="token operator">|</span> 受控组件
一个input输入框，有一个数据。input我们什么都不做，它内部有一套维护他自己状态的方法所以叫做不受控组件
一个input输入框，有一个数据。我们定义一个update方法来同步<span class="token constant">UI</span>，我们定义一个proxy方法。使得外部变量和这个变量能够重合，这叫做受控组件

<span class="token number">2.</span>合成事件是react的方法，是对各个浏览器提供统一的api进行差异抹平的东西
<span class="token number">3.</span>父子组件渲染

<span class="token operator">--</span><span class="token number">3.1</span> vue是先 父 create    最后父destory。但是由于子组件的mount 要比父的mount要快，因此会显得子组件渲染要比父组件快。react。

<span class="token operator">--</span><span class="token number">3.2</span> react 基础跟vue是一样的 

<span class="token operator">--</span><span class="token number">3.2</span><span class="token number">.1</span> <span class="token keyword">class</span>组件中的是无论父组件 输入啥 子组件 都会让 子组件 更新 因此可以在 子组件的shouldComponentUpdate 中 取消渲染（<span class="token keyword">return</span> <span class="token boolean">false</span>就可以了）

<span class="token operator">--</span><span class="token number">3.2</span><span class="token number">.2</span> hook组件

case1：hook 是 函数中的 和 render（就是 <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>xxx<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>）<span class="token operator">/</span> <span class="token function">里面的会先执行。</span>  <span class="token punctuation">(</span>这一部分 父子孙 组件 按照顺序执行<span class="token punctuation">)</span>

case2：然后是 useEffect （这一部分是 孙组件 子组件 父组件的顺序）

case3：复杂一点的 例如 top父 left子  right 子 left孙。这样就是  
top父  left子   left孙 right 子 递归类似深度搜索一样的遍历他

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="_2-1-10-原型-原型链"><a href="#_2-1-10-原型-原型链" class="header-anchor">#</a> 2.1.10.原型 | 原型链</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">A<span class="token punctuation">.</span>prototype</span> <span class="token operator">==</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__proto__
原型是prototype<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">显式原型</span><span class="token template-punctuation string">`</span></span>（只能没有实例的时候用）、__proto__<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">隐式原型</span><span class="token template-punctuation string">`</span></span>与constructor（只能<span class="token keyword">class</span>）。原型链是把各个原型__proto__连接起来，一直到<span class="token keyword">null</span>

我们需要牢记两点：

<span class="token operator">--</span>区别主要是 
<span class="token keyword">new</span>之前：prototype的属性会得到继承。__proto__的属性不会得到继承
<span class="token keyword">new</span>之后：prototype的属性设置不了（会报错）。__proto__的属性随便设置，设置的也是改变目前的prototype

<span class="token comment">// a.__proto__.__proto__.__proto__ 可能会报错 在报错的最后一次返回的是null</span>
原型链的尽头是object的隐式原型<span class="token keyword">null</span>
<span class="token comment">//a.constructor.constructor.constructor 永远不报错。最后返回的是native code</span>

<span class="token keyword">let</span> <span class="token function-variable function">test1</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'function'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> protest<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
protest<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'function1'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">test2</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;class&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> ex2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ex2<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;ss&quot;</span> <span class="token comment">//这个没有问题</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>每个对象都有一个原型对象，当访问一个对象的属性时，不仅会在该对象上搜寻，还会去该对象的原型上搜索。在我们new 对象的时候，第一步是创造内存空间，接下来是原型挂载。最后是</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'tom'</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Kevin'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Daisy'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// Daisy</span>
<span class="token keyword">delete</span> person<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// Kevin</span>

<span class="token comment">// 同样的基于原型链的属性查找还有constructor,funciotn原型对象Person是有constructor属性的，但是实例对象person没有，但是可以打印出person.constructor</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//只有函数才有prototype原型属性，protype是一个对象。实例可以共享函数的原型。当前实例对象找不到属性就回去原型里面去找属性。默认有一个construct</span>

<span class="token comment">//JavaScript的prototype是仅函数拥有, 而对象也拥有prototype是源于其constructor属性所拥有的prototype.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-1-11-继承"><a href="#_2-1-11-继承" class="header-anchor">#</a> 2.1.11.继承</h3> <p>一般基于原型链或者构造函数继承，用的最多的是综合前两者的组合继承，最优的是寄生组合继承</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>原型链继承（但无法多继承<span class="token operator">-</span>prototype已经给别人了，也不能向构造函数传参）<span class="token operator">-</span>将子类的原型对象指向父类的实例<span class="token operator">-</span><span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">People</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">People</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token operator">||</span> <span class="token string">'Annie'</span>
   
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">People</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token operator">--</span><span class="token number">2.</span><span class="token class-name">构造函数继承（父类原型链（xx</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>xx）上的参数和方法不能访问，但可以多继承，无法复用）
<span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'boy'</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'child'</span><span class="token punctuation">)</span> <span class="token comment">//绑上去了</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">3.</span>组合继承（call<span class="token operator">/</span>apply<span class="token operator">+</span>prototype）<span class="token operator">-</span>父类构造函数会被调用两次<span class="token punctuation">,</span>会有覆盖。增加了不必要的内存
原型链继承<span class="token operator">+</span>构造继承
<span class="token comment">// 原型链继承</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 构造继承</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token number">4.</span>寄生组合继承
<span class="token comment">//会更加干净</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token number">5.</span>寄生继承
<span class="token comment">//在原型式继承的基础上再封装一层，来增强对象，之后将这个对象返回。</span>
<span class="token keyword">function</span> <span class="token function">createAnother</span> <span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> clone <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token comment">// 通过调用 Object.create() 函数创建一个新对象</span>
    clone<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 以某种方式来增强对象</span>
    <span class="token keyword">return</span> clone<span class="token punctuation">;</span> <span class="token comment">// 返回这个对象</span>
<span class="token punctuation">}</span>




<span class="token operator">--</span><span class="token number">3.</span><span class="token constant">ES6</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> 继承

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>2.instanceof
用法：object instanceof constructor</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token comment">// [object xxxxx]是string类型</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 							<span class="token comment">// [object Number]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span> 						<span class="token comment">// [object String]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> 					<span class="token comment">// [object Boolean]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> 			<span class="token comment">// [object Undefined]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> 					<span class="token comment">// [object Null]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 			<span class="token comment">// [object Symbol]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'jack'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// [object Object]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 				<span class="token comment">// [object Array]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 		<span class="token comment">// [object Date]</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> 						<span class="token comment">// [object RegExp]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
<span class="token operator">--</span><span class="token number">1.</span>概念
Map对一个对象是强引用
weakmap  是一个弱引用

<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>for <span class="token keyword">in</span> <span class="token operator">-</span> <span class="token keyword">for</span> <span class="token keyword">of</span>
<span class="token keyword">for</span> <span class="token keyword">in</span> （可以枚举 enumerable）：string，array，object  （<span class="token keyword">set</span> map 不会报错） <span class="token operator">|</span> 判断 object<span class="token punctuation">.</span>getOwnPropertyDescriptors
<span class="token keyword">for</span> <span class="token keyword">of</span> （可迭代 iterable）：tring，array，<span class="token keyword">set</span> ，map  （注意这里object会报错）  <span class="token operator">|</span> 判断 arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token operator">...</span> <span class="token keyword">of</span>  类似于 promise<span class="token punctuation">.</span><span class="token function">all（这个返回一个数据）</span>

<span class="token punctuation">(</span>
    <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">let</span> res <span class="token keyword">of</span> list<span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">3.</span><span class="token function">场景题：顺序promise的封装</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token punctuation">]</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> val <span class="token keyword">of</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">getPromise</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_2-1-13-new操作符-手写"><a href="#_2-1-13-new操作符-手写" class="header-anchor">#</a> 2.1.13.new操作符 | 手写</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span>用来创建一个给定构造函数的实例对象
   流程： 
   <span class="token number">1.</span>声明空对象 
   <span class="token number">2.</span>如果是数组，那么就挂载原型（将空对象的__proto__指向构造函数的prototype）。如果是方法，那么调用apply方法 
   <span class="token number">3.</span>赋值给<span class="token keyword">this</span>
<span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token parameter">Funct<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Funct</span><span class="token punctuation">.</span>prototype
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">Funct</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">return</span> res <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> res <span class="token operator">:</span> obj
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-1-14-编程思想-命令式-状态机-柯里化-优雅降级"><a href="#_2-1-14-编程思想-命令式-状态机-柯里化-优雅降级" class="header-anchor">#</a> 2.1.14.编程思想 |  命令式 | 状态机 | 柯里化 | 优雅降级</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1.</span>了解一下react是命令式编程就可以了
<span class="token number">2.</span>状态机就是 将不同的状态封装到一个函数里面去
<span class="token number">3.</span> 指一个函数接收函数<span class="token constant">A</span>并且返回一个函数<span class="token constant">B</span>，函数<span class="token constant">B</span>来处理<span class="token constant">A</span><span class="token function">的剩余参数。例如f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">=</span>x<span class="token operator">^</span>y，固定x<span class="token operator">=</span><span class="token number">2</span><span class="token function">就得到f</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>y这样的新的函数。具体的代码放在 <span class="token number">4</span><span class="token punctuation">.</span>javascript<span class="token operator">-</span>手写题<span class="token punctuation">.</span>md里面
<span class="token number">4.</span>优雅降级是从复杂的现状开始的。渐进增强从弱的开始
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-1-15-缓存-强制重新加载-worker"><a href="#_2-1-15-缓存-强制重新加载-worker" class="header-anchor">#</a> 2.1.15 缓存 | 强制重新加载 | worker</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1.通常浏览器缓存策略分为两种：强缓存和协商缓存</span>
离线缓存 主要有 manifest缓存 和 service worker
<span class="token number">1.</span>根据请求头的expires和cache<span class="token operator">-</span>control<span class="token punctuation">,</span>判断是否命中强缓存（后者优先级高）
<span class="token number">2.</span>如果没有命中，那么会发送一个请求到服务器。通过last<span class="token operator">-</span>modified和etag验证资源是否命中协商缓存。如果命中，服务器会将这个请求返回，（后者优先级高）
<span class="token number">3.</span>如果又没有命中，直接从服务器读取资源


<span class="token comment">//2.不建议随意授予 no-store，因为你失去了 HTTP 和浏览器所拥有的许多优势，包括浏览器的后退/前进缓存。</span>

<span class="token comment">//3.重新加载 request</span>
mdn上 给出的方法如下
<span class="token number">1.</span> Cache<span class="token operator">-</span>Control<span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">2.</span> <span class="token literal-property property">Pragma</span><span class="token operator">:</span> no<span class="token operator">-</span>cache
<span class="token number">3.</span> 添加版本号
不让他重新加载
Cache<span class="token operator">-</span>Control<span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">31536000</span><span class="token punctuation">,</span> immutable（避免了发请求验证，可以看作是更加牛皮的优化）


<span class="token comment">//4.入口 html 文件是绝对不能强缓存的，不然就更新不了了。</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">这种入口 html 文件设置 no-cache，其他资源文件设置 max-age</span><span class="token template-punctuation string">`</span></span> 的缓存方式算是最佳实践了，你随便找一个网站看看都是这种方式。业务资源文件名字里是有 hash 的，新的 html 引用不同 hash 的资源即可：

<span class="token comment">//5.command + shift + R 的原理 requret</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Cache-Control 变成了 no-cache</span><span class="token template-punctuation string">`</span></span>，也就是和服务端协商是否要更新本地缓存，这就是强制刷新的实现原理！
但你现在在 Chrome DevTools 里看到的依然是之前的 Cache<span class="token operator">-</span>Control：
说明 Chrome DevTools 隐藏了这个行为，就像它隐藏了 sourcemap 文件的请求一样。
sourcemap 文件的请求和cache<span class="token operator">-</span>control在 charles 里看到：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="_2-1-16-event-loop-事件循环-4个概念-调用栈清空之后触发event-loop"><a href="#_2-1-16-event-loop-事件循环-4个概念-调用栈清空之后触发event-loop" class="header-anchor">#</a> 2.1.16.  Event Loop | 事件循环(4个概念) | 调用栈清空之后触发Event loop</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>event loop
<span class="token number">1.</span>调用栈清空，触发下一步
<span class="token number">2.</span>执行微任务
<span class="token number">3</span><span class="token punctuation">.</span>dom渲染
<span class="token number">4.</span>宏任务
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>调用栈(call stack)、消息队列(Message Queue)和微任务队列(Microtask Queue)和宏任务队列</strong></p> <p>**1.**Event Loop 开始时，从上到下，遇到函数调用时，会把函数压入调用栈中（被压入的函数叫做<code>帧(frame)</code>，当函数返回后，会从调用栈中弹出。直到被清空</p> <p>**2. **微任务队列（Microtask Queue）：使用 Promise、Async/Await 创建的异步操作会入队到微任务队列中，</p> <p>**3. **   接下来就是尝试dom渲染和执行宏任务队列</p> <p>4.调用栈被清空清空执行。异步操作进入消息队列（settimeout，setinterval）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1.事件循环定义：我们先把代码分成同步代码（console.log）和异步代码(setimeout，promise的then)。同步代码我们交给js（执行栈）去执行（因为这玩意是单线程的），异步环境我们交给宿主环境去执行。异步环境条件满足之后我们从宿主环境推送到任务队列。执行栈里面的任务执行完了，我们就会把任务队列（里面有宏任务队列和微任务队列）的任务推进执行栈。执行栈执行完就去任务队列看看，这个就叫做事件循环</span>

<span class="token comment">//2.异步任务分成宏任务和微任务。宏任务由宿主环境组成(浏览器，node)。微任务由js引擎组成。优先级：同步代码-》微任务异步promise.then，await，nexttick也是。后面的也是-》宏任务异步.</span>

<span class="token comment">//3.我看的疑问：为什么宏任务微任务是微任务优先：其实上面的说法忽略了一个条件。所有的任务都是在一个大的script里面产生的</span>

<span class="token comment">//4.promise本身是同步的但是里面的.then是异步的</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//下面代码不会被阻止。会调用.then函数，先进先出原则</span>
    	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我&quot;</span><span class="token punctuation">)</span>
        Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">num</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 我 是 2 （第一个同步）| 3（第一个异步，then先进先出）|  s（第二个同步）  | 4 （这里是由于resolve只能一个then，不继续惯着了）| b 5</span>
<span class="token comment">//先同步，resolve中的也是同步（resolve作为参数不阻塞）。 </span>
<span class="token comment">//先到then的</span>


<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//下面代码不会被阻止。会调用.then函数，先进先出原则</span>
        Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">num</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 2 4 3 6  注意一下 1是最先执行的</span>


<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolved</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resolved<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 4 1 3 5 2 这里主要是 一开始的 p 是会执行的</span>



<span class="token comment">//----------------------------------------------------------</span>
<span class="token comment">// 最后加上await 总结一下,</span>
<span class="token literal-property property">step1</span><span class="token operator">:</span>先是 
同步任务 <span class="token operator">|</span> 
resolve <span class="token operator">|</span> 
resolve 的任务同时执行例如 <span class="token function">resolve</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">。如果说resolve</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">那么就先执行后面的如果后面是resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">那么就先输出55，接下来执行resolve</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>的<span class="token punctuation">.</span>then <span class="token operator">|</span> 
<span class="token keyword">await</span> 的处理
v8引擎之前 执行 <span class="token keyword">await</span> 后，会把后面的代码注册到微任务队列。
v8引擎之后 执行<span class="token keyword">await</span> 后，直接跳出函数，在本轮循环的最后被执行 <span class="token operator">|</span>
注意，这些一些遇到微任务直接丢进去 微任务队列。然后遵循 先进先出的 原则
<span class="token literal-property property">step2</span><span class="token operator">:</span> 异步的微任务 （先进先出）
step3：宏任务
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h3 id="_2-1-17"><a href="#_2-1-17" class="header-anchor">#</a> 2.1.17 &amp;&amp; |  ||</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>&amp;&amp;返回第二个有效值，||返回第一个有效值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-1-18-bind-apply-call"><a href="#_2-1-18-bind-apply-call" class="header-anchor">#</a> 2.1.18  bind  | apply |  call</h3> <p>bind是绑定（用于click）</p> <p>call后面+单个</p> <p>apply是+list（块）</p> <h3 id="_2-1-19-类型判断-类型转化"><a href="#_2-1-19-类型判断-类型转化" class="header-anchor">#</a> 2.1.19 类型判断 |  类型转化</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>类型判断
<span class="token keyword">let</span> a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span>
<span class="token number">1.</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>：装箱操作
会对非<span class="token keyword">null</span> 或 <span class="token keyword">undefined</span>的数据类型进行装箱操作（不然会直接报错），然后去找出对象【Symbol<span class="token punctuation">.</span>toStringTag】 属性值，还有可能要遍历原型链，取到的值作为 tag<span class="token punctuation">,</span> 然后返回 <span class="token string">&quot;【object &quot;</span> <span class="token operator">+</span> tag <span class="token operator">+</span> <span class="token string">&quot;】&quot;</span> 形式的字符串

<span class="token number">2.</span> <span class="token keyword">instanceof</span>
返回<span class="token boolean">true</span>

<span class="token number">3</span><span class="token punctuation">.</span>typeof
返回用来说明变量的数据类型（但是array，<span class="token keyword">null</span>等复杂对象一律返回object），但是<span class="token keyword">null</span>并不是object格式的

<span class="token number">4</span><span class="token punctuation">.</span>isArray

<span class="token number">5</span><span class="token punctuation">.</span>nan！<span class="token operator">=</span>nan结果是<span class="token boolean">true</span>

类型转化
<span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>boolean
布尔值转化<span class="token operator">-</span>用boolean直接转换：这里注意一下如果object<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>，那么这个object的给boolean判断的话是<span class="token boolean">true</span>的。真正的空对象会用<span class="token keyword">null</span>来表示。所以空对象返回的是<span class="token boolean">true</span>。

<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>toString
<span class="token literal-property property">字符串转化</span><span class="token operator">:</span>tostring，String直接转化。tostring不支持<span class="token keyword">null</span>和<span class="token keyword">undefined</span>（会报错），string这个构造函数可以直接返回<span class="token keyword">null</span>和<span class="token keyword">undefined</span>的字面量

注意 
<span class="token number">145.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>会报错
<span class="token function">但是</span><span class="token punctuation">(</span><span class="token number">145</span><span class="token punctuation">)</span><span class="token punctuation">.</span>toString不会报错

<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>number
数值转化：number这个构造函数也是宽容，原理是用valueof先试一下，得不到在调用tostring类型。parseint parsefloat就没有那么宽容了。如果失败会用nan兜底。一个奇怪的点是如果number（空对象）结果是nan

<span class="token keyword">typeof</span> <span class="token keyword">typeof</span> <span class="token keyword">typeof</span> <span class="token keyword">null</span> 的结果是什么
从右边到左边执行：<span class="token keyword">typeof</span> <span class="token keyword">typeof</span> <span class="token keyword">typeof</span> <span class="token keyword">null</span> 结果是 <span class="token keyword">typeof</span> <span class="token keyword">null</span> 先变成<span class="token string">'object'</span>然后再变成<span class="token string">'string'</span><span class="token punctuation">.</span>答案也是 <span class="token string">'string'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_2-1-20-class-super-面向对象"><a href="#_2-1-20-class-super-面向对象" class="header-anchor">#</a> 2.1.20  class | super | 面向对象</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>super可以传参给父类的constructor 方法
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>sex</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">&quot;测试&quot;</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>



</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_2-1-21-前端竟态问题-abortcontroller-abort-promise的取消"><a href="#_2-1-21-前端竟态问题-abortcontroller-abort-promise的取消" class="header-anchor">#</a> 2.1.21  前端竟态问题 | AbortController | abort | promise的取消</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1.</span> 如果是XMLHttpRequest我们<span class="token keyword">new</span> <span class="token class-name">open</span> send之后可以xhr<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">2.</span> AbortController

<span class="token keyword">const</span> ac <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> signal <span class="token punctuation">}</span> <span class="token operator">=</span> ac<span class="token punctuation">;</span>
<span class="token comment">//得到signal，只要第二个参数传入了signal。我们就可以搞定了</span>

<span class="token function">fetch</span><span class="token punctuation">(</span>resourceUrl<span class="token punctuation">,</span> <span class="token punctuation">{</span> signal <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
ac<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'USER_ABORT_ACTION'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'用户终止了操作'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">3.</span>实现一个可以取消的promise
<span class="token operator">--</span><span class="token number">3.1</span> eventbus可以解决
<span class="token operator">--</span><span class="token number">3.2</span> <span class="token function">abortcontroller也可以做到</span><span class="token punctuation">(</span>好处是一次取消多个请求非常方便<span class="token punctuation">)</span>

<span class="token comment">/**
 * 自定义的可以主动取消的 Promise
 */</span>

<span class="token keyword">function</span> <span class="token function">myCoolPromise</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> signal <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果这个时候 signal 对象的状态是终止的，那么就会抛出一个异常</span>
    signal<span class="token operator">?.</span><span class="token function">throwIfAborted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 异步的操作，这里使用 setTimeout 模拟</span>
    <span class="token comment">//resolve('ok')</span>

    <span class="token comment">// 添加 abort 事件监听，一旦 signal 状态改变就将 Promise 的状态改变为 rejected</span>
    signal<span class="token operator">?.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'abort'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span>signal<span class="token operator">?.</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 使用自定义可取消的 Promise
 */</span>

<span class="token keyword">const</span> ac <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> signal <span class="token punctuation">}</span> <span class="token operator">=</span> ac<span class="token punctuation">;</span>

<span class="token function">myCoolPromise</span><span class="token punctuation">(</span><span class="token punctuation">{</span> signal <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ac<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'USER_ABORT_ACTION'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'用户终止了操作'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h3 id="_2-1-22-栈-堆-队列-内存溢出解决方案"><a href="#_2-1-22-栈-堆-队列-内存溢出解决方案" class="header-anchor">#</a> 2.1.22 栈 | 堆 | 队列 | 内存溢出解决方案</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1.</span>栈 ：方法
它的存储分为访问地址和实际存放的地方<span class="token punctuation">;</span> 访问地址是存储在栈中的<span class="token punctuation">,</span> 当查询引用类型变量的时候<span class="token punctuation">,</span> <span class="token function">会先从栈中读取内存地址</span><span class="token punctuation">(</span>也就是访问地址<span class="token punctuation">)</span><span class="token punctuation">,</span> 然后再通过地址找到堆中的值<span class="token punctuation">.</span>因此<span class="token punctuation">,</span> 这种我们也把它叫为引用访问<span class="token punctuation">.</span>
<span class="token number">2.</span>堆：object
闭包中的变量 就并不是保存在栈中<span class="token punctuation">,</span> 而是保存于堆中<span class="token punctuation">.</span>
它的存储分为访问地址和实际存放的地方<span class="token punctuation">;</span> 访问地址是存储在栈中的<span class="token punctuation">,</span> 当查询引用类型变量的时候<span class="token punctuation">,</span> <span class="token function">会先从栈中读取内存地址</span><span class="token punctuation">(</span>也就是访问地址<span class="token punctuation">)</span><span class="token punctuation">,</span> 然后再通过地址找到堆中的值<span class="token punctuation">.</span>因此<span class="token punctuation">,</span> 这种我们也把它叫为引用访问<span class="token punctuation">.</span>

v8的堆有这两个：
新生代 就是临时分配的内存，存活时间短<span class="token punctuation">,</span> 如临时变量、字符串等
from_space_：正在使用的放到to。然后对调，循环
to_space_：闲置的内存

老生代 是常驻内存，存活的时间长<span class="token punctuation">,</span> 如主控制器、服务器对象等<span class="token punctuation">;</span>
这就是标记清除了

<span class="token number">3.</span>队列：事件循环 Event Loop

<span class="token number">4.</span>内存溢出解决方案：node <span class="token operator">--</span>max_old_space_size<span class="token operator">=</span><span class="token number">8000</span> build<span class="token operator">/</span>build<span class="token punctuation">.</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_2-1-23-线程与进程-开销和内存空间-单线程好处"><a href="#_2-1-23-线程与进程-开销和内存空间-单线程好处" class="header-anchor">#</a> 2.1.23.线程与进程(开销和内存空间) |  单线程好处</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>线程<span class="token operator">=</span>火车  进程<span class="token operator">=</span>车厢
火车间很难共享    同一火车的不同车厢容易共享

为避免频繁操作<span class="token constant">DOM</span>带来的同步问题，设计成单线程。后来为了利用多核<span class="token constant">CPU</span>计算能力，<span class="token constant">HTML5</span>提出Web Worker标准，允许js脚本创建多个线程，但是子线程由主线程控制且不得操作<span class="token constant">DOM</span>，所以<span class="token constant">JS</span>单线程的本质没有改变。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-1-24-html元素-attribute"><a href="#_2-1-24-html元素-attribute" class="header-anchor">#</a> 2.1.24 html元素 | Attribute</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'content_views'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'content_views'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_2-1-25-事件委托-addeventlistener"><a href="#_2-1-25-事件委托-addeventlistener" class="header-anchor">#</a> 2.1.25  事件委托 | addEventListener</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>事件委托主要用来<span class="token number">1.</span>减少内存消耗，<span class="token number">2.</span>动态绑定事件。减少重复工作
我们一般说的事件委托其实是addEventListener
第一个是我们的事件：比如click，mouseover
第二个是方法
第三个是模式。<span class="token boolean">true</span>是事件在捕获阶段执行。事件在冒泡阶段执行，默认是<span class="token boolean">false</span><span class="token punctuation">,</span>就是默认在冒泡的时候执行
<span class="token comment">//默认冒泡是 标签的onclick事件-&gt;document.onclick-&gt;addEventListener</span>
<span class="token comment">//为true的时候 addEventListener-&gt;标签的onclick事件-&gt;document.onclick 　</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>事件传播的三个阶段</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1、捕获阶段：事件从window对象自上而下向目标节点传播的阶段；
2、目标阶段：真正的目标节点正在处理事件的阶段；
3、冒泡阶段：事件从目标节点自下而上向window对象传播的阶段。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>示例</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>www.baidu.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>百度<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>www.baidu.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>搜狐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">function</span> <span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;dsadas&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">// alert((e || window).event.target.innerHTML)</span>
            <span class="token comment">// 阻止冒泡方法  不让事件向documen上蔓延。</span>
            <span class="token comment">// 只激活内部函数,顶部的onclick就不会执行力</span>
            e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// 阻止默认行为</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>事件大全</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>鼠标事件
click 当用户点击某个对象时调用的事件句柄。
contextmenu 在用户点击鼠标右键打开上下文菜单时触发
dblclick 当用户双击某个对象时调用的事件句柄。
mousedown 鼠标按钮被按下。
mouseenter 当鼠标指针移动到元素上时触发。
mouseleave 当鼠标指针移出元素时触发
mousemove 鼠标被移动。
mouseover 鼠标移到某元素之上。
mouseout 鼠标从某元素移开。
mouseup 鼠标按键被松开。

<span class="token operator">--</span><span class="token number">2.</span>键盘事件
属性 描述 <span class="token constant">DOM</span>
keydown 某个键盘按键被按下。
keypress 某个键盘按键被按下并松开。
keyup 某个键盘按键被松开。

<span class="token operator">--</span><span class="token number">3.</span>键盘事件
框架<span class="token operator">/</span>对象（Frame<span class="token operator">/</span>Object）事件
abort <span class="token function">图像的加载被中断。</span> <span class="token punctuation">(</span> <span class="token punctuation">)</span>
beforeunload 该事件在即将离开页面（刷新或关闭）时触发
error <span class="token function">在加载文档或图像时发生错误。</span> <span class="token punctuation">(</span> <span class="token punctuation">,</span> 和 <span class="token punctuation">)</span>
hashchange 该事件在当前 <span class="token constant">URL</span> 的锚部分发生修改时触发。
load 一张页面或一幅图像完成加载。
pageshow 该事件在用户访问页面时触发
pagehide 该事件在用户离开当前网页跳转到另外一个页面时触发
resize 窗口或框架被重新调整大小。
scroll 当文档被滚动时发生的事件。
unload <span class="token function">用户退出页面。</span> <span class="token punctuation">(</span> 和 <span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">4.</span>表单事件
表单事件
blur 元素失去焦点时触发
change <span class="token function">该事件在表单元素的内容改变时触发</span><span class="token punctuation">(</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span> 和 <span class="token punctuation">)</span>
focus 元素获取焦点时触发
focusin 元素即将获取焦点是触发
focusout 元素即将失去焦点是触发
input 元素获取用户输入是触发
reset 表单重置时触发
search <span class="token function">用户向搜索域输入文本时触发</span> <span class="token punctuation">(</span>

<span class="token operator">--</span><span class="token number">5.</span>剪贴板事件
剪贴板事件
copy 该事件在用户拷贝元素内容时触发
cut 该事件在用户剪切元素内容时触发
paste 该事件在用户粘贴元素内容时触发

<span class="token operator">--</span><span class="token number">6.</span>打印事件
打印事件
afterprint 该事件在页面已经开始打印，或者打印窗口已经关闭时触发
beforeprint 该事件在页面即将开始打印时触发

<span class="token operator">--</span><span class="token number">7.</span>拖动事件
拖动事件
drag 该事件在元素正在拖动时触发
dragend 该事件在用户完成元素的拖动时触发
dragenter 该事件在拖动的元素进入放置目标时触发
dragleave 该事件在拖动元素离开放置目标时触发
dragover 该事件在拖动元素在放置目标上时触发
dragstart 该事件在用户开始拖动元素时触发
drop 该事件在拖动元素放置在目标区域时触发


<span class="token operator">--</span><span class="token number">8.</span>拖动事件
动画事件
animationend 该事件在 <span class="token constant">CSS</span> 动画结束播放时触发
animationiteration 该事件在 <span class="token constant">CSS</span> 动画重复播放时触发
animationstart 该事件在 <span class="token constant">CSS</span> 动画开始播放时触发


<span class="token operator">--</span><span class="token number">9.</span>拖动事件
message <span class="token function">该事件通过或者从对象</span><span class="token punctuation">(</span>WebSocket<span class="token punctuation">,</span> Web Worker<span class="token punctuation">,</span> Event Source 或者子 frame 或父窗口<span class="token punctuation">)</span>接收到消息时触发
online 该事件在浏览器开始在线工作时触发。
offline 该事件在浏览器开始离线工作时触发。
popstate 该事件在窗口的浏览历史（history 对象）发生改变时触发。 event occurs when the window’s history changes

<span class="token operator">--</span><span class="token number">10.</span>元素在上下文菜单显示时触发
storage 该事件在 Web <span class="token function">Storage</span><span class="token punctuation">(</span><span class="token constant">HTML</span> <span class="token number">5</span> Web 存储<span class="token punctuation">)</span>更新时触发
toggle 该事件在用户打开或关闭 元素时触发
wheel 该事件在鼠标滚轮在元素上下滚动时触发
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><h3 id="_2-1-26-作用域链-执行上下文"><a href="#_2-1-26-作用域链-执行上下文" class="header-anchor">#</a> 2.1.26.作用域链   | 执行上下文</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>变量提升把变量或者是<span class="token keyword">function</span>的声明提升到开头的行为。所以我们会用 块级作用域，<span class="token keyword">let</span> 和 <span class="token keyword">const</span>来防止变量提升

原理是 预编译 和 执行
<span class="token operator">--</span><span class="token number">1.</span>作用域一共有三个 全局作用域、函数作用域，块级作用域。函数的 <span class="token punctuation">{</span> <span class="token punctuation">}</span>，才能形成作用域，比如
<span class="token comment">// 比如这个对象的 { } 就不是作用域</span>
<span class="token keyword">var</span> xiaoming <span class="token operator">=</span> <span class="token punctuation">{</span> 
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiao ming'</span> <span class="token comment">// 对象中的属性，也不是局部变量</span>
<span class="token punctuation">}</span>
一些特殊例子
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 会输出 undefined</span>
<span class="token punctuation">{</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// 会输出 undefined</span>

<span class="token operator">--</span><span class="token number">2.</span>块级作用域和<span class="token punctuation">{</span><span class="token punctuation">}</span> 合并 示例
<span class="token punctuation">{</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// Uncaught ReferenceError: x is not defined</span>

<span class="token operator">--</span><span class="token number">2.</span>作用域链：作用域链是如果在当前作用域下找不到该变量，那就去上层作用域去寻找，直到全局作用域，如果还找不到会报错

为什么在对象内部访问自己的属性不能直接用xxx，为什么 <span class="token keyword">this</span> 指向的不是 window
<span class="token keyword">const</span> xiaoming <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'小明'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
xiaoming<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span>

因为只有函数的大括号<span class="token punctuation">{</span><span class="token punctuation">}</span>才能形成作用域，

<span class="token operator">--</span><span class="token number">3</span> 说明会先在内部找，接下来回到外部找
<span class="token operator">--</span><span class="token number">3.1</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">56</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token comment">//var a =12</span>
<span class="token punctuation">}</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//输出56</span>

<span class="token operator">--</span><span class="token number">3.2</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">56</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span><span class="token number">12</span>
<span class="token punctuation">}</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//输出 undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>作用域是变量和函数生效的区域，分为全局作用域、函数作用域和块级作用域
，如果在非严格模式下会在全局隐式地声明该变量</p> <h3 id="_2-1-27-babel-polyfill-core-js"><a href="#_2-1-27-babel-polyfill-core-js" class="header-anchor">#</a> 2.1.27 babel |  polyfill | core.js</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Babel 能为你做的事情：
<span class="token number">1.</span>语法转换
<span class="token number">2.</span>通过 Polyfill <span class="token function">方式在目标环境中添加缺失的特性</span> <span class="token punctuation">(</span>通过 @babel<span class="token operator">/</span>polyfill 模块<span class="token punctuation">)</span>
那么他是咋做到的呢？这就不得不提大名鼎鼎的<span class="token constant">AST</span>了<span class="token operator">-</span><span class="token function">parsing</span><span class="token punctuation">(</span>解析<span class="token punctuation">)</span>、transforming（转化）、printing（生成）<span class="token operator">-</span>黑海谈判。日本和美国谈判。但是只有荷兰翻译


<span class="token function">polyfill</span><span class="token punctuation">(</span>补丁<span class="token operator">/</span>垫片<span class="token punctuation">)</span> 的定义， 他就是把当前浏览器不支持的方法通过用支持的方法重写来获得支持。

core<span class="token punctuation">.</span>js <span class="token function">和polyfill类似。每年会出现新的qpi，像：es6的Promise，Set或者es7数组新提供的方法includes，这些新加入的api，就引出一个词“”polyfill“”</span><span class="token punctuation">(</span>垫片<span class="token operator">/</span>补丁<span class="token punctuation">)</span>，就是社区上提供的一段代码，让我们在不兼容某些新特性的浏览器上，使用该新特性。新功能转换为大部分现代浏览器都可以支持运行的api补丁包集合。


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-1-28-加密算法"><a href="#_2-1-28-加密算法" class="header-anchor">#</a> 2.1.28 加密算法</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>非对称加密就是同一个公钥<span class="token operator">-</span><span class="token function">私钥对才能正常加解密。</span><span class="token punctuation">(</span>rsa<span class="token punctuation">)</span> ，用快递员的密钥加密，然后把把快递给他，只有快递员的密钥才可以解密。

我通过<span class="token constant">RSA</span>算法生成公钥私钥，快递员通过我的公钥加密数据，我通过自己的私钥解密

<span class="token operator">--</span><span class="token number">2.</span>对应的就是 对称加密算法（类似于zip的解压缩）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-1-30-async-await-promise-版本差异-node-的事件循环比较"><a href="#_2-1-30-async-await-promise-版本差异-node-的事件循环比较" class="header-anchor">#</a> 2.1.30 async | await | promise| 版本差异 | node 的事件循环比较</h3> <p>用同步的方法实现异步操作（指的是.then）。async返回一个promise，await后面接promise那么就是等待返回结果。async只能和await合并使用。但是浏览器调试await可以单独使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>原理
async<span class="token operator">/</span><span class="token keyword">await</span>：原理是包裹一层生成器调用next方法<span class="token operator">+</span>promise。
注意script中，<span class="token keyword">async</span> 和 defer都是异步加载，但是defer 是有顺序的。，而<span class="token keyword">async</span> 是乱序的，这个东西会阻塞 整个线程
<span class="token operator">--</span><span class="token number">2.</span>版本差异
v8引擎之前 执行 <span class="token keyword">await</span> 后，会把后面的代码注册到微任务队列。
v8引擎之后 执行<span class="token keyword">await</span> 后，直接跳出函数，在本轮循环的最后被执行。紧跟着<span class="token keyword">await</span>后面的语句相当于放到了<span class="token keyword">new</span> <span class="token class-name">Promise</span>中，下一行及之后的语句相当于放在Promise<span class="token punctuation">.</span><span class="token function">then中</span><span class="token punctuation">(</span>而且是比较后面的那一种，不会受到影响<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//2</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token comment">//7</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2 end'</span><span class="token punctuation">)</span> <span class="token comment">//2</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2 end1'</span><span class="token punctuation">)</span> <span class="token comment">//5</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//2</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span> <span class="token comment">//8</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise'</span><span class="token punctuation">)</span> <span class="token comment">//3</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span> <span class="token comment">//6</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span> <span class="token comment">//4</span>
<span class="token comment">// script start  (这里容易，就是普通输出)</span>
<span class="token comment">// async2 end  (这里容易，就是普通await 的 值，这里promise.then是微任务跳过)</span>
<span class="token comment">// Promise	（resolve 是同步任务执行）</span>
<span class="token comment">// script end （同步任务的最后一步）</span>
<span class="token comment">// async2 end1 （异步任务 的 第一个微任务）</span>
<span class="token comment">// promise1 （异步任务 的 第二个微任务）</span>
<span class="token comment">// async1 end （？？？ await 後面的会在本轮循环的最后进行执行，但是再慢也比settimeout快）</span>
<span class="token comment">// setTimeout</span>




加深理解的一题

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//相当于.then 但是不会执行。因为上面的promise没有then</span>
  <span class="token keyword">return</span> <span class="token string">'async1 end'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'srcipt start'</span><span class="token punctuation">)</span>
<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span>
<span class="token comment">// srcipt start</span>
<span class="token comment">// async1 start</span>
<span class="token comment">// promise1</span>
<span class="token comment">// script end</span>




</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>两者最主要的区别在于浏览器中的微任务是在每个相应的宏任务中执行的，而nodejs中的微任务是在不同阶段之间执行的。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-1-31-scolltop-clientheight-offsetheight-intersectionobserver-clientx是可视坐标-pagex是绝对坐标"><a href="#_2-1-31-scolltop-clientheight-offsetheight-intersectionobserver-clientx是可视坐标-pagex是绝对坐标" class="header-anchor">#</a> 2.1.31 scolltop | clientheight | offsetheight  | IntersectionObserver |  clientx是可视坐标，pagex是绝对坐标</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span><span class="token punctuation">.</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight获取屏幕可视窗口高度。
<span class="token number">2.</span> ele<span class="token punctuation">.</span>offsetTop  元素相对于文档顶部的距离  <span class="token comment">//document.querySelector('#user-content').offsetTop  </span>
<span class="token number">3</span><span class="token punctuation">.</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop 滚动条滚动的距离  通过上面三个能够知道我们我们是否能够看到视图<span class="token punctuation">.</span>但是这样子监听会照成回流。（判断元素位置我们可以通过<span class="token number">3</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&gt;</span><span class="token number">2</span>）
document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span><span class="token function">clientHeight</span><span class="token punctuation">(</span>可见区域高）<span class="token operator">+</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span><span class="token function">scrollTop</span><span class="token punctuation">(</span>用户滑动的距离<span class="token punctuation">)</span>  <span class="token operator">&gt;</span> 观测元素<span class="token punctuation">.</span><span class="token function">offsetTop</span><span class="token punctuation">(</span>元素距离顶部的距离<span class="token punctuation">)</span>

<span class="token number">4</span><span class="token punctuation">.</span>IntersectionObserver 



<span class="token keyword">const</span> io <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token parameter">ioes</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ioes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">ioe</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> el <span class="token operator">=</span> ioe<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
    <span class="token keyword">const</span> intersectionRatio <span class="token operator">=</span> ioe<span class="token punctuation">.</span>intersectionRatio<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>intersectionRatio <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> intersectionRatio <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;能看见元素&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;看不见&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span>onload <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> io<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> imgs <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'#user-content--getboundingclientrect'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
imgs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> io<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>利用offsetTop和scrollTop和浏览器高度做比较
getBoundingClientRect返回相关位置属性</p> <p>总结一共2个：scrollTop（字面意思） clientTop（局部正常基础少一点东西或者不正常，大局正常） offsetTop（正常）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>固定（dom上常用属性）
clientWidth  <span class="token comment">//1.1屏幕（不固定）的宽高</span>
width  <span class="token comment">//1.2屏幕（固定）宽高</span>
scrollTop <span class="token comment">// 1.3滚动宽高</span>

border<span class="token operator">-</span>box下面，这三个一样， <span class="token comment">//1.3元素宽高</span>
<span class="token function">offsetHeight</span><span class="token punctuation">(</span>元素本身的宽<span class="token punctuation">)</span> <span class="token operator">|</span> scrollHeight（元素高度<span class="token operator">-</span>border<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>溢出来的元素高） <span class="token operator">|</span> clientHeight（元素高度<span class="token operator">-</span>border<span class="token operator">*</span><span class="token number">2</span>）

如果要是是content<span class="token operator">-</span>box<span class="token comment">//1.3元素宽高</span>
<span class="token function">offsetHeight</span><span class="token punctuation">(</span>元素<span class="token operator">+</span>padding<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>border<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span> scrollHeight（元素高度<span class="token operator">+</span>padding<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>溢出来的元素高<span class="token operator">-</span>overflow<span class="token operator">-</span>y<span class="token operator">:</span> auto） <span class="token operator">|</span> clientHeight（元素<span class="token operator">+</span>padding<span class="token operator">*</span><span class="token number">2</span>）

<span class="token comment">//1.4元素距离顶部的距离</span>
offsetTop（正常大全）
clientTop<span class="token comment">//顶部边框值</span>
<span class="token literal-property property">scrollTop</span><span class="token operator">:</span>内部的滚动效果<span class="token comment">//document.querySelector(&quot;.box&quot;).scrollTop=100。（可以用来做页面滚动效果）</span>

<span class="token operator">--</span><span class="token number">2.</span>事件：
clientX <span class="token comment">// 2.1以可见区域的左上角为原点</span>
pageX <span class="token comment">// 2.2以页面本身的body为原点</span>
offsetX（左内边框） <span class="token operator">|</span> windowX （相对于屏幕）<span class="token comment">//2.3</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
        <span class="token operator">*</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">margin</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>container <span class="token punctuation">{</span>
            column<span class="token operator">-</span>count<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
            margin<span class="token operator">-</span>top<span class="token operator">:</span> 800px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token punctuation">.</span>box <span class="token punctuation">{</span>
            <span class="token comment">/* position: absolute; */</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> 10px<span class="token punctuation">;</span>
            <span class="token literal-property property">margin</span><span class="token operator">:</span> 10px<span class="token punctuation">;</span>
            <span class="token literal-property property">background</span><span class="token operator">:</span> red<span class="token punctuation">;</span>
            <span class="token literal-property property">width</span><span class="token operator">:</span> 100px<span class="token punctuation">;</span>
            <span class="token literal-property property">height</span><span class="token operator">:</span> 100px<span class="token punctuation">;</span>
            <span class="token literal-property property">padding</span><span class="token operator">:</span> 20px<span class="token punctuation">;</span>
            box<span class="token operator">-</span>sizing<span class="token operator">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
            word<span class="token operator">-</span>wrap<span class="token operator">:</span> <span class="token keyword">break</span><span class="token operator">-</span>word<span class="token punctuation">;</span>
            <span class="token literal-property property">border</span><span class="token operator">:</span> 1px solid black<span class="token punctuation">;</span>
            <span class="token literal-property property">padding</span><span class="token operator">:</span> 10px<span class="token punctuation">;</span>
            overflow<span class="token operator">-</span>y<span class="token operator">:</span> auto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;box&quot;</span><span class="token operator">&gt;</span> aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;box&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;box&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;box&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">0.</span>基础知识

document<span class="token punctuation">.</span>documentElement：可返回存在于 <span class="token constant">XML</span> 以及 <span class="token constant">HTML</span> 文档中的文档根节点（对应的是html标签）
document<span class="token punctuation">.</span>body：提供了对 <span class="token operator">&lt;</span>body<span class="token operator">&gt;</span> 标签的直接访问（对应的是body标签）
在<span class="token constant">DTD</span>已声明的情况下用documentElement，未声明的情况下用body



<span class="token operator">--</span><span class="token number">1.</span>可见区域宽高
document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>  <span class="token comment">//height + padding + 水平滚动条高度</span>
window<span class="token punctuation">.</span>screen<span class="token punctuation">.</span>width<span class="token comment">//屏幕宽度（不受窗口resize事件影响）</span>

document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>  <span class="token comment">//height + padding + 水平滚动条高度（doc为严格模式下面document.body失效，原因不明） | 考虑用document.documentElement.clientHeight</span>
window<span class="token punctuation">.</span>screen<span class="token punctuation">.</span>height<span class="token comment">//屏幕高度（不受窗口resize事件影响）</span>


<span class="token number">2.</span>滚动长度：
document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token comment">//严格模式下面用这个</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token comment">//兼容模式用这个</span>

<span class="token number">3.</span>元素宽高
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.box&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>offsetWidth<span class="token comment">//获取元素的宽，这里需要注意我们的box-size:box还是content差距是很大的。</span>

<span class="token number">4.</span>元素距离顶部距离
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.box&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>offsetTop<span class="token comment">//绝对数值</span>

document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token operator">+</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight<span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.box&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>offsetTop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_2-1-32-监听dom元素-mutationobserver"><a href="#_2-1-32-监听dom元素-mutationobserver" class="header-anchor">#</a> 2.1.32 监听dom元素 | MutationObserver</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token parameter">mutationList<span class="token punctuation">,</span> observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mutationList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">mutation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>mutation<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'childList'</span><span class="token operator">:</span>
        <span class="token comment">/* 从树上添加或移除一个或更多的子节点；参见 mutation.addedNodes 与
           mutation.removedNodes */</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'attributes'</span><span class="token operator">:</span>
        <span class="token comment">/* mutation.target 中某节点的一个属性值被更改；该属性名称在 mutation.attributeName 中，
           该属性之前的值为 mutation.oldValue */</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> targetNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#someElement&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> observerOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 观察目标子节点的变化，是否有添加或者删除</span>
  <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  
  <span class="token comment">// 观察属性变动</span>
  <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
  <span class="token comment">// 观察后代节点，默认为 false</span>
  <span class="token literal-property property">subtree</span><span class="token operator">:</span> <span class="token boolean">true</span>     
<span class="token punctuation">}</span>

<span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>targetNode<span class="token punctuation">,</span> observerOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_2-1-33-arguments"><a href="#_2-1-33-arguments" class="header-anchor">#</a> 2.1.33 arguments</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>arguments默认获取剩下的参数

<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token parameter">age<span class="token punctuation">,</span> className</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的年龄是</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">岁，是</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>className<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">班学生</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-1-35-postmessage"><a href="#_2-1-35-postmessage" class="header-anchor">#</a> 2.1.35  postmessage</h3> <h4 id="子组件"><a href="#子组件" class="header-anchor">#</a> 子组件</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> data<span class="token operator">=</span><span class="token string">&quot;data1111111111&quot;</span>
window<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//parent.postmessage vue里面</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="父组件"><a href="#父组件" class="header-anchor">#</a> 父组件</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">parent</span><span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;测试:&quot;</span><span class="token punctuation">,</span>param<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span>parent<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-1-37-innertext-textcontent-nodevalue"><a href="#_2-1-37-innertext-textcontent-nodevalue" class="header-anchor">#</a> 2.1.37  innerText |  textContent |  nodeValue</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>innerText获取可以显示的文本<span class="token operator">:</span>display<span class="token operator">:</span>none的不会输出，opacticy为<span class="token number">0</span>就是可以被输出。

<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>textContent能够获取所有子节点的文本内容。包括html和script。注意注释获取不到

<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>nodeValue只能是作用于文本节点或者注释节点本点。不然会是<span class="token keyword">null</span>

<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>innertext作用于html element后两个作用于node。

<span class="token operator">--</span><span class="token number">5.</span>注意一下html中换行和和注释节点也被算做了一个子节点
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_2-1-38-geo-speech-api"><a href="#_2-1-38-geo-speech-api" class="header-anchor">#</a> 2.1.38  geo | speech | api</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">geolocation</span> <span class="token punctuation">(</span>http的定位可能会不准，因此最好是https<span class="token operator">-</span>ios10<span class="token punctuation">)</span>
<span class="token comment">//翻墙才能用</span>
navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span><span class="token parameter">position</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前位置信息：'</span><span class="token punctuation">,</span> position<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">//定位数据获取成功响应  </span>
<span class="token keyword">function</span>  <span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token parameter">position</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'纬度: '</span>          <span class="token operator">+</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>latitude          <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span>  
      <span class="token string">'经度: '</span>         <span class="token operator">+</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>longitude         <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span>  
      <span class="token string">'海拔: '</span>          <span class="token operator">+</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>altitude          <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span>  
      <span class="token string">'水平精度: '</span>          <span class="token operator">+</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>accuracy          <span class="token operator">+</span> <span class="token string">'\n'</span> <span class="token operator">+</span>  
      <span class="token string">'垂直精度: '</span> <span class="token operator">+</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>altitudeAccura<span class="token punctuation">)</span>  
<span class="token punctuation">}</span>  
<span class="token comment">//定位数据获取失败响应  </span>
<span class="token keyword">function</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token keyword">switch</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>code<span class="token punctuation">)</span>  
  <span class="token punctuation">{</span>  
    <span class="token keyword">case</span> error<span class="token punctuation">.</span><span class="token constant">PERMISSION_DENIED</span><span class="token operator">:</span>  
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;您拒绝对获取地理位置的请求&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> error<span class="token punctuation">.</span><span class="token constant">POSITION_UNAVAILABLE</span><span class="token operator">:</span>  
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;位置信息是不可用的&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> error<span class="token punctuation">.</span><span class="token constant">TIMEOUT</span><span class="token operator">:</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;请求您的地理位置超时&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> error<span class="token punctuation">.</span><span class="token constant">UNKNOWN_ERROR</span><span class="token operator">:</span>  
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;未知错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">if</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">)</span><span class="token punctuation">{</span>  
  navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span>onSuccess <span class="token punctuation">,</span> onError<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>  
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;您的浏览器不支持使用HTML 5来获取地理位置服务&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="_2-1-39-正则"><a href="#_2-1-39-正则" class="header-anchor">#</a> 2.1.39  正则</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//(.)匹配任意一个 (？)匹配0-1个  *匹配1个以上 \d 匹配单个数字=[0-9]</span>

<span class="token comment">//手机号 | 1开头+除了1之外的东西+中间9个结尾 </span>
<span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[1][3,4,5,6.7,8,9][0-9]{9}$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[1][3,4,5,6.7,8,9][0-9]{9}</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> text <span class="token operator">=</span><span class="token string">&quot;我的手机号是19120636253，因此xxxxx/但是他的手机号码是18928125079&quot;</span>
<span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>match <span class="token operator">|</span> 输出匹配的  这玩意和 replace是好用的 text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span><span class="token string">&quot;替换的内容&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//['19120636253','18928125079']</span>
<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>search <span class="token operator">|</span> 返回第一个元素位置
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//6</span>
<span class="token operator">--</span><span class="token number">3.</span> test <span class="token operator">|</span> 看一下有没有符合要求的元素<span class="token punctuation">.</span><span class="token punctuation">.</span>表单校验的时候可以用
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token operator">--</span><span class="token number">4.</span>零宽先行 <span class="token function">断言</span> <span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span>p<span class="token punctuation">)</span>  要求与p匹配	
<span class="token comment">//(?=a) 表示我们需要匹配某样东西的前面。  会带着?=一起输出出来，实操体验很差</span>
<span class="token comment">//(?!a) 表示我们需要不匹配某样东西。</span>
<span class="token comment">//(?&lt;=a) 表示我们需要匹配某样东西的后面。</span>
<span class="token comment">//(?&lt;!a) 表示我们需要不匹配某样东西，与(?!a)方向相反。</span>
<span class="token keyword">var</span> reg1 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=机号是)[0-9]{11}(?=,因)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span>
<span class="token keyword">let</span> text <span class="token operator">=</span><span class="token string">&quot;我的手机号是19120636253,因此xxxxx但是他的手机号是18928125079,因但是,&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg1<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg1<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">var</span> consoleName<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;console&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;window.console&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> consoleType<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;log&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;warn&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;assert&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;count&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;clear&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//let rConsole = new RegExp(&quot;(&quot; + consoleName.join(&quot;|&quot;) + &quot;)&quot; + &quot;.(?:&quot; + consoleType.join(&quot;|&quot;) + &quot;)\\s{0,}\\([^;]*\\)(?!\\s*[;,]?\\s*\\/\\*\\s*NotClearConsole\\s*\\*\\/)\\s{0,};?&quot;, &quot;gi&quot;);</span>
<span class="token keyword">let</span> rConsole <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">console.log\(.*?\)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span>
<span class="token keyword">let</span> text <span class="token operator">=</span><span class="token string">&quot;console.log('ddddd');let a= 1;console.log('ddd')&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>rConsole<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>	<span class="token comment">// 正则表达式</span>
        <span class="token keyword">function</span> <span class="token function">getQueryObject</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//假如不传值，默认也会有值</span>
            url <span class="token operator">=</span> url <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">:</span> url
            <span class="token comment">//这一套组合技就是取到最后？后面的值</span>
            <span class="token comment">// url.lastIndexOf('?')找到位置</span>
            <span class="token keyword">const</span> search <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token comment">// 3.1 正则表达式 基本形式 /正则表达式主体/修饰符(可选)</span>
            <span class="token comment">// i 大小不那啥  g 全局匹配 不会在匹配一个后就停止</span>
            <span class="token comment">// JavaScript 中，正则表达式通常用于两个字符串方法 : </span>
            <span class="token comment">// search()-并返回子串的起始位置 和 replace()-替换 和 exec也常用</span>
            <span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([^?&amp;=]+)=</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span>       
<span class="token comment">// 先行断言 后行：后面的内容应匹配表达式 exp</span>
        <span class="token keyword">var</span> reg1 <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?=三).*(?=b)</span><span class="token regex-delimiter">/</span></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'123一二三abc'</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg1<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 返回三a</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg1<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>search<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// reg.exec(search,(rs, $1, $2) =&gt; {</span>
        <span class="token comment">//         console.log($1, &quot;$1&quot;)</span>
        <span class="token comment">//         console.log($2, &quot;$2&quot;)</span>
        <span class="token comment">//         console.log(rs, &quot;rs&quot;)</span>
        <span class="token comment">//         const name = decodeURIComponent($1)</span>
        <span class="token comment">//         let val = decodeURIComponent($2)</span>
        <span class="token comment">//         val = String(val)</span>
        <span class="token comment">//         obj[name] = val</span>
        <span class="token comment">//         return rs</span>
        <span class="token comment">// })</span>

        <span class="token comment">//这样子写可以得到第一个参数匹配的内容</span>
        <span class="token comment">// replace的第一个参数是正则表达式，第二个参数有两种形式，第一种是string，那就是替换了</span>
        <span class="token comment">// 第二种就是传入函数，rs是匹配的内容，$1是第一个括号匹配的内容，$2是第二个括号匹配的内容</span>
        <span class="token comment">// 如果除了这两个参数外还有的话，那么就是offset（匹配到的索引）,str（原始字符串）</span>
        <span class="token comment">// reg是正则表达式，传入</span>
        search<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">rs<span class="token punctuation">,</span> $1<span class="token punctuation">,</span> $2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$1<span class="token punctuation">,</span> <span class="token string">&quot;$1&quot;</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$2<span class="token punctuation">,</span> <span class="token string">&quot;$2&quot;</span><span class="token punctuation">)</span>

            <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>$1<span class="token punctuation">)</span>
            <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>$2<span class="token punctuation">)</span>
            val <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
            obj<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> val
            <span class="token keyword">return</span> rs
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> obj
    <span class="token punctuation">}</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;window.location&quot;</span><span class="token punctuation">,</span> <span class="token function">getQueryObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">2.1</span><span class="token number">.40</span> 正则中使用变量 
<span class="token keyword">function</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span>all</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> reg <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>str<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> temp <span class="token operator">=</span> all<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span>
        <span class="token keyword">return</span> temp
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-1-40-一些坑-try-catch-settimeout-async-赋值"><a href="#_2-1-40-一些坑-try-catch-settimeout-async-赋值" class="header-anchor">#</a> 2.1.40 一些坑 | try catch  | settimeout | async |  赋值</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span><span class="token punctuation">.</span>try catch的坑
<span class="token number">1.1</span> setTimeout回调抛出的异常不能被<span class="token keyword">try</span> catch。 因为调用他的catch的settimeout入栈的时候，调用它的函数就是已经出栈了。简单地说setTimeout里的错误被异步抛出的

<span class="token number">1.2</span> <span class="token keyword">async</span>函数里<span class="token keyword">await</span>发生的异常却可以<span class="token keyword">try</span> catch，

<span class="token number">1.3</span> promise 第一层的错误不会冒泡出来，而是被 promise 吃掉了，只有通过 promise<span class="token punctuation">.</span>catch 才可以捕获

然后在第二层也就是then里面可以
在第一层 <span class="token keyword">return</span> e 然后在第二层进行拿到值。根据这个东西我们可以解决 <span class="token number">1.1</span>的bug。包一层promise来捕获promise的错误

<span class="token keyword">const</span> <span class="token function-variable function">p3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">reslove<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'async error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">main3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">p3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">main3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">1.4</span> <span class="token keyword">async</span> 和 <span class="token keyword">await</span> 的捕获
这玩意能够直接直接捕获

<span class="token number">2.</span>从右到左
<span class="token keyword">function</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">/*
	function display() {
      a = 10  //严格模式下面会报错
      var a = 10 
    }
*/</span>



</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="_2-2-快问快答"><a href="#_2-2-快问快答" class="header-anchor">#</a> 2.2 快问快答</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1.</span>从哪里学习
开源项目排名，mdn，codepen
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_2-3-项目中js高级"><a href="#_2-3-项目中js高级" class="header-anchor">#</a> 2.3 项目中js高级</h2> <h3 id="_2-3-1-js引入-css-js"><a href="#_2-3-1-js引入-css-js" class="header-anchor">#</a> 2.3.1 js引入 css js</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1.引入script</span>
    <span class="token keyword">const</span> scriptInfo <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span>
    scriptInfo<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&quot;text/javascript&quot;</span>
    <span class="token comment">// scriptInfo.setAttribute(&quot;data-callType&quot;,&quot;callScript&quot;)</span>
    scriptInfo<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;/js/1.js&quot;</span>
    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>scriptInfo<span class="token punctuation">)</span>

    <span class="token comment">//2.引入css</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> cssInfo <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;link&quot;</span><span class="token punctuation">)</span>
        cssInfo<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">&quot;stylesheet&quot;</span>
        cssInfo<span class="token punctuation">.</span>type<span class="token operator">=</span><span class="token string">&quot;text/css&quot;</span>
        cssInfo<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">&quot;/css/1.css&quot;</span>
        document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>cssInfo<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//删除</span>
<span class="token keyword">let</span> callScript <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;script[data-callType='callScript']&quot;</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>callScript<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_2-3-2-禁止自动滑动"><a href="#_2-3-2-禁止自动滑动" class="header-anchor">#</a> 2.3.2 禁止自动滑动</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchmove'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">passive</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//passive 参数不能省略，用来兼容ios和android</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-3-3-canvas成图片"><a href="#_2-3-3-canvas成图片" class="header-anchor">#</a> 2.3.3 canvas成图片</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//blob允许我们可以通过js直接操作二进制数据</span>
      document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">&quot;img&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;.jpg&quot;</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>

        a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-3-4-iframe-postmessage"><a href="#_2-3-4-iframe-postmessage" class="header-anchor">#</a> 2.3.4 iframe | postmessage</h3> <h4 id="_2-3-4-1-利用iframe进行通讯"><a href="#_2-3-4-1-利用iframe进行通讯" class="header-anchor">#</a> 2.3.4.1 利用iframe进行通讯</h4> <p>这里对src进行了一个参数的传参</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>postmessage的协议测试：发送端<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>http://localhost:8082?getparam='+getparam<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>postmessage的协议测试：接收端<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    {{receive}}
 this.receive=this.$route.query.getparam
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-3-4-2-postmessage进行通讯"><a href="#_2-3-4-2-postmessage进行通讯" class="header-anchor">#</a> 2.3.4.2 postMessage进行通讯</h4> <h5 id="子传父"><a href="#子传父" class="header-anchor">#</a> 子传父</h5> <p>例如子组件的按钮点击后传递给父组件</p> <p>用vue用post有一个坑就是，他的webpack初始化的时候会先给自己发一个数据。导致data会是webpack报错。
如果说我们要实现postMessage只发一次，我们就要监听指定的窗口</p> <p>子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//可以在method中，也可以在mount中</span>
<span class="token comment">//最后一个是可以传过去的网址</span>
parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">&quot;这是发送过去的数据&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>父：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//可以在method中，也可以在mount中</span>
<span class="token comment">//http://localhost:8082是iframe的内容</span>
<span class="token comment">// const publisher=window.open(&quot;http://localhost:8082/&quot;)</span>
<span class="token comment">//父目前的情况</span>
<span class="token operator">&lt;</span>iframe <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;'http://localhost:8082?getparam='+getparam&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;300px&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;300px&quot;</span> frameborder<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span>

<span class="token comment">//子传父的情况</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> origin <span class="token operator">=</span> event<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>
    <span class="token comment">// 通常，onmessage()事件处理程序应当首先检测其中的origin属性，忽略来自未知源的消息</span>
    <span class="token comment">// 不然的话webpack会先给他发一个包</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>origin <span class="token operator">!==</span> <span class="token string">&quot;http://localhost:8082&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">&quot;postmessage&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">//false就是冒泡事件，从里到外</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h5 id="父传子"><a href="#父传子" class="header-anchor">#</a> 父传子</h5> <p>父：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token comment">//html中的东西</span>
<span class="token operator">&lt;</span>iframe
      <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;'http://localhost:8082?getparam=' + getparam&quot;</span>
      width<span class="token operator">=</span><span class="token string">&quot;300px&quot;</span>
      height<span class="token operator">=</span><span class="token string">&quot;300px&quot;</span>
      frameborder<span class="token operator">=</span><span class="token string">&quot;0&quot;</span>
      id<span class="token operator">=</span><span class="token string">&quot;iframeViewer&quot;</span>
    <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span>


<span class="token keyword">const</span> _iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;iframeViewer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contentWindow<span class="token punctuation">;</span>
    <span class="token keyword">const</span> iframeViewer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;iframeViewer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> _obj <span class="token operator">=</span> <span class="token string">&quot;父传子的数据&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// _obj.type = &quot;view&quot;;</span>
    <span class="token comment">// _obj.currentProcessInstanceId =1;</span>

    iframeViewer<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;iframeViewer已加载&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      _iframe<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_obj<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>



</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin<span class="token operator">==</span><span class="token string">'http://localhost:8081'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_2-4-webgl"><a href="#_2-4-webgl" class="header-anchor">#</a> 2.4 webgl</h2> <h3 id="_2-4-1-webgl基础"><a href="#_2-4-1-webgl基础" class="header-anchor">#</a> 2.4.1 webgl基础</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">类型数据和array的联系</span><span class="token operator">:</span><span class="token function">类型数组不等于array。类型数组提升了数组的性能。array的内部实现是链表，因此元素多的话性能会比较差</span><span class="token punctuation">(</span>这里主要指的是访问<span class="token punctuation">)</span>。类型数组是连续的内存实现的数据类型，通过加法可以实现访问，array则是一个个查找

<span class="token literal-property property">类型数组</span><span class="token operator">:</span><span class="token function">实现是缓冲</span><span class="token punctuation">(</span>arraybuffer 内存中的二进制数据。可以简单地理解为数据<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">视图</span><span class="token punctuation">(</span>int8array u的意思是有符号的正数范围增大，没有负数 uint8array uint16array float32array将缓冲中的数据读取和访问出来，可以简单地理解为数据转化器<span class="token punctuation">)</span>。缓存包括视图

<span class="token literal-property property">类型数组常用方法</span><span class="token operator">:</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token function">set</span><span class="token punctuation">(</span>index，value<span class="token punctuation">)</span> length 不支持push pop。唯一的创造方法是
<span class="token keyword">let</span> a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">int8array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span>，<span class="token number">1</span>，<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-4-2-实操"><a href="#_2-4-2-实操" class="header-anchor">#</a> 2.4.2 实操</h3> <p>总结起来四个步骤：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span>，initwebgl（初始化webgl） 
<span class="token number">2</span><span class="token function">，initshader</span><span class="token punctuation">(</span>初始化着色器<span class="token punctuation">)</span>
<span class="token number">3</span>，initbuffer（创造buffer对象）
<span class="token number">4</span>，draw
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>主要api：</p> <p>webgl的移动主要是向量的知识
1，shadersource的第二个参数的字符串定义一下angle旋转角度
2，在initbuffer中对angle进行赋值。通过webgl.uniformif(angle，pi/180)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span>。初始化
第一步：查找元素
<span class="token literal-property property">第二步</span><span class="token operator">:</span><span class="token function">这个元素getcontext</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span>，获取上下文 
<span class="token literal-property property">第三步</span><span class="token operator">:</span>初始化画布，xx<span class="token punctuation">.</span><span class="token function">viewport</span><span class="token punctuation">(</span>左上角的x坐标，y坐标，clientwidth，clientheight<span class="token punctuation">)</span>


<span class="token number">2.</span><span class="token function">着色器</span><span class="token punctuation">(</span><span class="token function">顶点着色器</span><span class="token punctuation">(</span>计算坐标<span class="token operator">+</span>一部分颜色<span class="token punctuation">)</span><span class="token function">。片元着色器</span><span class="token punctuation">(</span>最终颜色，纹理<span class="token punctuation">)</span><span class="token punctuation">)</span>
#创造shader
createshader
#链接shader。这里的第二个参数是<span class="token keyword">void</span> main开头的源码，还挺难的。有点像c的代码
shadersource
#编译shader
compileshader
#创造程序
createprogram
#shader绑定到程序里面
attachprogram
#webgl跟program链接
linkprogram
#使用program
useprogram




<span class="token number">3</span><span class="token function">，创造buffer</span><span class="token punctuation">(</span>圈一块地<span class="token punctuation">)</span>
#顶点数据
<span class="token keyword">let</span> a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">int8array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span>，<span class="token number">1</span>，<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
然后这个画布<span class="token punctuation">.</span><span class="token function">createbuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
#绑定缓冲区对象
这个画布<span class="token punctuation">.</span>bindbuffer
#绑定缓冲区数据
这个画布<span class="token punctuation">.</span>binddata
<span class="token function">#允许传递，允许传递给shader</span><span class="token punctuation">(</span>cpu渲染管线<span class="token punctuation">)</span>。之后调用显卡
enableverrexattrbarray
#传递给位置变量 shader和js做通信
这个画布<span class="token punctuation">.</span>vertexattribpointer


<span class="token number">4</span>，最后绘制就可以了
drawarray


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>接口：/wechat_api/auth/getOpenidStatus</p> <p>猜测原因：边界处理异常</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>这个接口返回结果如下
let res = <span class="token punctuation">{</span>
    WeiVi<span class="token operator">:</span> <span class="token string">&quot;XJW ♥ ZJY 2021.10.27 - Forever.&quot;</span><span class="token punctuation">,</span> 
 	code<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
 	data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
 	msg<span class="token operator">:</span> <span class="token string">&quot;尚未完善手机号注册&quot;</span>
<span class="token punctuation">}</span>

前端在这个接口后面执行
if (res.code == <span class="token number">0</span>)<span class="token punctuation">{</span>
        this.setData(<span class="token punctuation">{</span>
        openid<span class="token operator">:</span> res.data.openid<span class="token punctuation">,</span>
        newuser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        token<span class="token operator">:</span> res.data.token
	<span class="token punctuation">}</span>)
<span class="token punctuation">}</span>

这导致后续/wechat_api/auth/openidRegister接口的openid和token参数传参为空。才报错参数有误后跳转回主界面

solution：
手机号注册没有完善的时候正常返回openid和token
或者
在openidRegister增加对于openid和token为空的处理
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_2-5-js工程化概述"><a href="#_2-5-js工程化概述" class="header-anchor">#</a> 2.5 js工程化概述</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span> 工程化工具<span class="token punctuation">.</span>js<span class="token punctuation">,</span>rollup gulp
<span class="token operator">--</span><span class="token number">2.</span>模块化：es6 
<span class="token operator">--</span><span class="token number">3.</span>兼容：
<span class="token operator">--</span><span class="token number">3.1</span> polyfill：
@babel<span class="token operator">/</span>preset<span class="token operator">-</span>env <span class="token operator">+</span> corejs@<span class="token number">3</span>
<span class="token operator">--</span><span class="token number">3.2</span> runtime：
@babel<span class="token operator">/</span>preset<span class="token operator">-</span>env <span class="token operator">+</span> @babel<span class="token operator">/</span>runtime<span class="token operator">-</span>corejs3 <span class="token operator">+</span> @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-5-1-polyfill-实操"><a href="#_2-5-1-polyfill-实操" class="header-anchor">#</a> 2.5.1 polyfill 实操</h3> <h4 id="_2-5-1-1-jsconfig-json"><a href="#_2-5-1-1-jsconfig-json" class="header-anchor">#</a> 2.5.1.1 jsconfig.json</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定要使用的默认库，值为&quot;es3&quot;,&quot;es5&quot;,&quot;es2015&quot;...</span>
    <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 在生成模块代码时指定模块系统</span>
        <span class="token string-property property">&quot;experimentalDecorators&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;incremental&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// TS编译器在第一次编译之后会生成一个存储编译信息的文件，第二次编译会在第一次的基础上进行增量编译，可以提高编译的速度</span>
            <span class="token string-property property">&quot;tsBuildInfoFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./buildFile&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 增量编译文件的存储位置</span>
            <span class="token string-property property">&quot;diagnostics&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 打印诊断信息 </span>
            <span class="token string-property property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ES5&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 目标语言的版本</span>
            <span class="token string-property property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CommonJS&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 生成代码的模板标准</span>
            <span class="token string-property property">&quot;outFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./app.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 将多个相互依赖的文件生成一个文件，可以用在AMD模块中，即开启时应设置&quot;module&quot;: &quot;AMD&quot;,</span>
            <span class="token string-property property">&quot;lib&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;DOM&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ES2015&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ScriptHost&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ES2019.Array&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// TS需要引用的库，即声明文件，es5 默认引用dom、es5、scripthost,如需要使用es的高级版本特性，通常都需要配置，如es8的数组新特性需要引入&quot;ES2019.Array&quot;,</span>
            <span class="token string-property property">&quot;allowJS&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 允许编译器编译JS，JSX文件</span>
            <span class="token string-property property">&quot;checkJs&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 允许在JS文件中报错，通常与allowJS一起使用</span>
            <span class="token string-property property">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定输出目录</span>
            <span class="token string-property property">&quot;rootDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定输出文件目录(用于输出)，用于控制输出目录结构</span>
            <span class="token string-property property">&quot;declaration&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 生成声明文件，开启后会自动生成声明文件</span>
            <span class="token string-property property">&quot;declarationDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./file&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定生成声明文件存放目录</span>
            <span class="token string-property property">&quot;emitDeclarationOnly&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 只生成声明文件，而不会生成js文件</span>
            <span class="token string-property property">&quot;sourceMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 生成目标文件的sourceMap文件</span>
            <span class="token string-property property">&quot;inlineSourceMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 生成目标文件的inline SourceMap，inline SourceMap会包含在生成的js文件中</span>
            <span class="token string-property property">&quot;declarationMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 为声明文件生成sourceMap</span>
            <span class="token string-property property">&quot;typeRoots&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 声明文件目录，默认时node_modules/@types</span>
            <span class="token string-property property">&quot;types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 加载的声明文件包</span>
            <span class="token string-property property">&quot;removeComments&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 删除注释 </span>
            <span class="token string-property property">&quot;noEmit&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 不输出文件,即编译后不会生成任何js文件</span>
            <span class="token string-property property">&quot;noEmitOnError&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 发送错误时不输出任何文件</span>
            <span class="token string-property property">&quot;noEmitHelpers&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 不生成helper函数，减小体积，需要额外安装，常配合importHelpers一起使用</span>
            <span class="token string-property property">&quot;importHelpers&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 通过tslib引入helper函数，文件必须是模块</span>
            <span class="token string-property property">&quot;downlevelIteration&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 降级遍历器实现，如果目标源是es3/5，那么遍历器会有降级的实现</span>
            <span class="token string-property property">&quot;strict&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启所有严格的类型检查</span>
            <span class="token string-property property">&quot;alwaysStrict&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 在代码中注入'use strict'</span>
            <span class="token string-property property">&quot;noImplicitAny&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 不允许隐式的any类型</span>
            <span class="token string-property property">&quot;strictNullChecks&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 不允许把null、undefined赋值给其他类型的变量</span>
            <span class="token string-property property">&quot;strictFunctionTypes&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 不允许函数参数双向协变</span>
            <span class="token string-property property">&quot;strictPropertyInitialization&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 类的实例属性必须初始化</span>
            <span class="token string-property property">&quot;strictBindCallApply&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 严格的bind/call/apply检查</span>
            <span class="token string-property property">&quot;noImplicitThis&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 不允许this有隐式的any类型</span>
            <span class="token string-property property">&quot;noUnusedLocals&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 检查只声明、未使用的局部变量(只提示不报错)</span>
            <span class="token string-property property">&quot;noUnusedParameters&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 检查未使用的函数参数(只提示不报错)</span>
            <span class="token string-property property">&quot;noFallthroughCasesInSwitch&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 防止switch语句贯穿(即如果没有break语句后面不会执行)</span>
            <span class="token string-property property">&quot;noImplicitReturns&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//每个分支都会有返回值</span>
            <span class="token string-property property">&quot;esModuleInterop&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 允许export=导出，由import from 导入</span>
            <span class="token string-property property">&quot;allowUmdGlobalAccess&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 允许在模块中全局变量的方式访问umd模块</span>
            <span class="token string-property property">&quot;moduleResolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 模块解析策略，ts默认用node的解析策略，即相对的方式导入</span>
            <span class="token string-property property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 解析非相对模块的基地址，默认是当前目录</span>
            <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 路径映射，相对于baseUrl</span>
              <span class="token comment">// 如使用jq时不想使用默认版本，而需要手动指定版本，可进行如下配置</span>
              <span class="token string-property property">&quot;jquery&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules/jquery/dist/jquery.min.js&quot;</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;rootDirs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;out&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 将多个目录放在一个虚拟目录下，用于运行时，即编译后引入文件的位置可能发生变化，这也设置可以虚拟src和out在同一个目录下，不用再去改变路径也不会报错</span>
            <span class="token string-property property">&quot;listEmittedFiles&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 打印输出文件</span>
            <span class="token string-property property">&quot;listFiles&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token comment">// 打印编译的文件(包括引用的声明文件)</span>
          <span class="token punctuation">}</span>
     
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 要排除的文件</span>
        <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;**/node_modules/*&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;checkJs&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 启用javascript文件的类型检查</span>
    <span class="token string-property property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 解析非相关模块名称的基础目录</span>
    <span class="token string-property property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;utils&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;src/utils/*&quot;</span>
        <span class="token punctuation">]</span> <span class="token comment">// 指定相对于baseUrl选项计算的路径映射，使用webpack别名，智能感知路径</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h2 id="_2-6-加载字体"><a href="#_2-6-加载字体" class="header-anchor">#</a> 2.6 加载字体</h2> <h2 id="_2-7-tc39-会议"><a href="#_2-7-tc39-会议" class="header-anchor">#</a> 2.7 tc39 会议</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">0.</span>
<span class="token constant">ECMA</span>：一个组织
<span class="token constant">TC39</span><span class="token operator">:</span><span class="token constant">ECMA</span>下面的技术委员会
<span class="token literal-property property">stage0（strawman）</span><span class="token operator">:</span>任何<span class="token constant">TC39</span>的成员都可以提交。
stage1（proposal），进入此阶段就意味着这一提案被认为是正式的了，需要对此提案的场景与<span class="token constant">API</span>进行详尽的描述。
一共是<span class="token number">0</span><span class="token operator">-</span><span class="token number">4</span> <span class="token punctuation">.</span> <span class="token number">5</span>个阶段。 到达最后一个阶段就进行发布了
常用的 
<span class="token operator">--</span><span class="token number">0.1</span> Top<span class="token operator">-</span>level <span class="token keyword">await</span>（stage <span class="token number">4</span>）：支持最顶层使用<span class="token keyword">await</span>
<span class="token operator">--</span><span class="token number">0.2</span> Temporal（stage <span class="token number">3</span>）：时间处理函数标准化 函数
<span class="token operator">--</span><span class="token number">0.3</span>（stage3） at ： 负索引
<span class="token operator">--</span><span class="token number">0.4</span> Record <span class="token operator">&amp;</span> Tuple（stage2） ：Record类似于对象，Tuple类似于数组
<span class="token operator">--</span><span class="token number">0.5</span> <span class="token function">Decorators</span> <span class="token punctuation">(</span>stage <span class="token number">2</span><span class="token punctuation">)</span>：装饰器
<span class="token operator">--</span><span class="token number">0.6</span> Set <span class="token function">Methods</span> <span class="token punctuation">(</span>stage <span class="token number">2</span><span class="token punctuation">)</span>：基于交集<span class="token operator">/</span>并集<span class="token operator">/</span>差集创建新的Set的方法
<span class="token operator">--</span><span class="token number">0.7</span> orient<span class="token operator">-</span>error编程的一系列接口
<span class="token operator">--</span><span class="token number">0.8</span> Pipeline Operator：管道操作符（<span class="token operator">|</span><span class="token operator">&gt;</span>） <span class="token function">如doubleNumber</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>会变为number <span class="token operator">|</span><span class="token operator">&gt;</span> doubleNumber的形式

<span class="token number">1.</span>作用域又叫做执行上下文，全局上下文就是window对象
<span class="token number">2.6</span><span class="token literal-property property">个基础数据类型</span><span class="token operator">:</span>undefine number string boolean symbol  <span class="token keyword">null</span>。

<span class="token number">2023</span><span class="token operator">/</span><span class="token number">1</span>
<span class="token number">1</span><span class="token punctuation">.</span>temporal时区的国际化支持
<span class="token number">2.</span>原型怎么用symbol防止污染
<span class="token number">3</span><span class="token punctuation">.</span>weakmap的key将支持用symbol表示
<span class="token number">4</span><span class="token punctuation">.</span>await置于顶层的推进，<span class="token keyword">await</span>将引入promise的一些特性方案的推进

<span class="token number">2023</span><span class="token operator">/</span><span class="token number">1</span>之前

<span class="token operator">--</span><span class="token number">0.1</span> Top<span class="token operator">-</span>level <span class="token keyword">await</span>（stage <span class="token number">4</span>）：支持最顶层使用<span class="token keyword">await</span>
<span class="token operator">--</span><span class="token number">0.2</span> Temporal（stage <span class="token number">3</span>）：时间处理函数标准化 函数
<span class="token operator">--</span><span class="token number">0.3</span>（stage3） at ： 负索引
<span class="token operator">--</span><span class="token number">0.4</span> Record <span class="token operator">&amp;</span> Tuple（stage2） ：Record类似于对象，Tuple类似于数组
<span class="token operator">--</span><span class="token number">0.5</span> <span class="token function">Decorators</span> <span class="token punctuation">(</span>stage <span class="token number">2</span><span class="token punctuation">)</span>：装饰器
<span class="token operator">--</span><span class="token number">0.6</span> Set <span class="token function">Methods</span> <span class="token punctuation">(</span>stage <span class="token number">2</span><span class="token punctuation">)</span>：基于交集<span class="token operator">/</span>并集<span class="token operator">/</span>差集创建新的Set的方法
<span class="token operator">--</span><span class="token number">0.7</span> orient<span class="token operator">-</span>error编程的一系列接口
<span class="token operator">--</span><span class="token number">0.8</span> Pipeline Operator：管道操作符（<span class="token operator">|</span><span class="token operator">&gt;</span>） <span class="token function">如doubleNumber</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>会变为number <span class="token operator">|</span><span class="token operator">&gt;</span> doubleNumber的形式

<span class="token operator">--</span><span class="token number">0.9</span><span class="token punctuation">.</span>throw <span class="token function">Expressions</span> <span class="token punctuation">(</span>stage <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Unsupported encoding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">--</span><span class="token number">0.10</span><span class="token punctuation">.</span>Promise<span class="token punctuation">.</span>try  可以更加精确的捕获同步错误。
里面抛出的错误能够被捕获
<span class="token keyword">function</span> <span class="token function">getUserNameById</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">try</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> id <span class="token operator">!==</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;id must be a number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> user<span class="token punctuation">.</span>name
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token number">0.11</span><span class="token punctuation">.</span>Error Cause

就是<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Upload job result failed'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">cause</span><span class="token operator">:</span> err <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
然后 是使用 。相当于他会帮你自定义一个类型出来
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">doJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Caused by'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Error: Upload job result failed</span>
<span class="token comment">// Caused by TypeError: Failed to fetch</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h2 id="_2-8-项目中的"><a href="#_2-8-项目中的" class="header-anchor">#</a> 2.8 项目中的</h2> <h3 id="_2-8-1-v-for"><a href="#_2-8-1-v-for" class="header-anchor">#</a> 2.8.1  v-for</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> str1 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token comment">//自定义字符串,用于拼接标签</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;textArr&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span><span class="token string-property property">&quot;grade&quot;</span><span class="token operator">:</span><span class="token string">'一等品'</span><span class="token punctuation">,</span><span class="token string-property property">&quot;mix&quot;</span><span class="token operator">:</span><span class="token string">'20%'</span><span class="token punctuation">,</span><span class="token string-property property">&quot;number&quot;</span><span class="token operator">:</span><span class="token string">'200'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string-property property">&quot;grade&quot;</span><span class="token operator">:</span><span class="token string">'准一等品'</span><span class="token punctuation">,</span><span class="token string-property property">&quot;mix&quot;</span><span class="token operator">:</span><span class="token string">'20%'</span><span class="token punctuation">,</span><span class="token string-property property">&quot;number&quot;</span><span class="token operator">:</span><span class="token string">'200'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>data<span class="token punctuation">.</span>textArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    str1 <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;h1&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">.</span>textArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>grade<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h1&gt;</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-8-2-懒加载"><a href="#_2-8-2-懒加载" class="header-anchor">#</a> 2.8.2 懒加载</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>insertsectionobsserver：减少reflow
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/front-base-know-blog/know/1.html.html" class="prev">
          1.HTML（浏览器机制）
        </a></span> <span class="next"><a href="/front-base-know-blog/know/2.1.javascript基础.html">
          2.1 JavaScript基础
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:0;" data-v-b57cc07c data-v-7dd95ae2></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/front-base-know-blog/assets/js/app.f7f2110a.js" defer></script><script src="/front-base-know-blog/assets/js/3.a15d85cc.js" defer></script><script src="/front-base-know-blog/assets/js/1.704023bf.js" defer></script><script src="/front-base-know-blog/assets/js/15.bae72d59.js" defer></script>
  </body>
</html>
