<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2.webpack | Electrolux博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/front-base-know-blog/assets/css/0.styles.1c0757d4.css" as="style"><link rel="preload" href="/front-base-know-blog/assets/js/app.9ea430c0.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/3.a15d85cc.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/1.704023bf.js" as="script"><link rel="preload" href="/front-base-know-blog/assets/js/9.cf5c04da.js" as="script"><link rel="prefetch" href="/front-base-know-blog/assets/js/10.4e1c0929.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/11.e1c02f53.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/12.9d2d303a.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/13.0bddbf1f.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/14.6d5b2045.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/15.9580c3d6.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/16.9217c419.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/17.01794b81.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/18.d60eeae2.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/19.19111f48.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/20.6217f0d4.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/21.db5e43ac.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/22.f3cf8e4c.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/23.148acac2.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/24.df8c11df.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/25.3074b88e.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/26.890f392c.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/27.8ee94e16.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/28.214a9297.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/29.8163a140.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/30.cb2c9843.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/31.c4d9b3a1.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/4.11c729f5.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/5.41f9e3e8.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/6.de585bd1.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/7.234840ab.js"><link rel="prefetch" href="/front-base-know-blog/assets/js/8.f66853e2.js">
    <link rel="stylesheet" href="/front-base-know-blog/assets/css/0.styles.1c0757d4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Electrolux博客</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-base-know-blog/" class="home-link router-link-active"><!----> <span class="site-name">Electrolux博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-base-know-blog/know/1.html.html" class="nav-link"><i class="undefined"></i>
  html
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/2.javascript基础.html" class="nav-link"><i class="undefined"></i>
  js基础
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/5.css.html" class="nav-link"><i class="undefined"></i>
  css
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      常用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/7.算法.html" class="nav-link"><i class="undefined"></i>
  设计模式 | 算法
</a></li><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/10.性能优化.html" class="nav-link"><i class="undefined"></i>
  性能优化
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <!----> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>21</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>0</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/front-base-know-blog/know/1.html.html" class="nav-link"><i class="undefined"></i>
  html
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/2.javascript基础.html" class="nav-link"><i class="undefined"></i>
  js基础
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/5.css.html" class="nav-link"><i class="undefined"></i>
  css
</a></div><div class="nav-item"><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      常用
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/7.算法.html" class="nav-link"><i class="undefined"></i>
  设计模式 | 算法
</a></li><li class="dropdown-item"><!----> <a href="/front-base-know-blog/know/10.性能优化.html" class="nav-link"><i class="undefined"></i>
  性能优化
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/1.html.html" class="sidebar-link">1.HTML（浏览器机制）</a></li><li><a href="/front-base-know-blog/know/2.0javascript基础.html" class="sidebar-link">2.JavaScript基础</a></li><li><a href="/front-base-know-blog/know/2.1.javascript基础.html" class="sidebar-link">2.1 JavaScript基础</a></li><li><a href="/front-base-know-blog/know/2.2.ts.html" class="sidebar-link">2.2. ts</a></li><li><a href="/front-base-know-blog/know/2.9.javascript代码输出题.html" class="sidebar-link">2.9 JavaScript代码输出题</a></li><li><a href="/front-base-know-blog/know/3.javascript-es6.html" class="sidebar-link">3.JavaScript-es6</a></li><li><a href="/front-base-know-blog/know/4.javascript-手写题.html" class="sidebar-link">4.JS手写题</a></li><li><a href="/front-base-know-blog/know/5.css.html" class="sidebar-link">5.CSS</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>八股</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/八股/1.计算机网络.html" class="sidebar-link">1.计算机网络</a></li><li><a href="/front-base-know-blog/know/八股/2.Git.html" class="sidebar-link">2.Git</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/框架/1.vue.html" class="sidebar-link">1.vue | 主流方案对比</a></li><li><a href="/front-base-know-blog/know/框架/2.react.html" class="sidebar-link">2.react</a></li><li><a href="/front-base-know-blog/know/框架/3.ssr.html" class="sidebar-link">3.ssr</a></li><li><a href="/front-base-know-blog/know/框架/4.微前端.html" class="sidebar-link">4.微前端</a></li><li><a href="/front-base-know-blog/know/框架/5.vue3.html" class="sidebar-link">5.vue3</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>优化 | 工程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-base-know-blog/know/优化/1.性能优化和安全.html" class="sidebar-link">1.性能优化与安全</a></li><li><a href="/front-base-know-blog/know/优化/2.webpack.html" class="active sidebar-link">2.webpack</a></li><li><a href="/front-base-know-blog/know/优化/3.算法.html" class="sidebar-link">3.实用算法 | 设计模式</a></li><li><a href="/front-base-know-blog/know/优化/4.性能优化.html" class="sidebar-link">4.性能优化</a></li><li><a href="/front-base-know-blog/know/优化/5.组件库构造.html" class="sidebar-link">5.组件库构建</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><!---->
          
        <!---->
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">2.webpack</h1> <div data-v-8a445198><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="_2-webpack"><a href="#_2-webpack" class="header-anchor">#</a> 2.webpack</h1> <p></p><div class="table-of-contents"><ul><li><a href="#_6-1-配置">6.1 配置</a><ul><li><a href="#_6-1-1-external-模块">6.1.1 external 模块</a></li><li><a href="#_6-1-2-provideplugin">6.1.2  ProvidePlugin</a></li><li><a href="#_6-1-3-code-splitting">6.1.3 code splitting.</a></li><li><a href="#_6-1-4-webpackchunkname-webpackprefetch">6.1.4  webpackChunkName | webpackPrefetch</a></li><li><a href="#_6-1-5-webpack-merge">6.1.5  webpack-merge</a></li><li><a href="#_6-1-6-source-map">6.1.6 source map</a></li><li><a href="#_6-1-7-loader">6.1.7 loader</a></li><li><a href="#_6-1-8-runtime-only-runtime-compiler">6.1.8 runtime-only |  runtime-compiler</a></li><li><a href="#_6-1-10-browserslistrc">6.1.10  browserslistrc</a></li><li><a href="#_6-1-11-环境的配置">6.1.11 环境的配置</a></li><li><a href="#_6-1-12-锁定版本号">6.1.12 锁定版本号</a></li></ul></li><li><a href="#_6-2-vue-cli-基本配置示例">6.2 vue-cli | 基本配置示例</a><ul><li><a href="#_6-2-1-vue-cli-版本">6.2.1 vue-cli 版本</a></li><li><a href="#_6-2-2-vue-cli和webpack">6.2.2  vue-cli和webpack</a></li><li><a href="#_6-2-4-vue-config-js基础">6.2.4 vue.config.js基础</a></li><li><a href="#_6-2-4-webpack-版本">6.2.4 webpack 版本</a></li></ul></li><li><a href="#_6-3-快问快答">6.3 快问快答</a></li><li><a href="#_6-4-小技巧-版本对比-失效分析">6.4 小技巧 | 版本对比 | 失效分析</a><ul><li><a href="#_6-4-1-删除-node-modules-rimraf">6.4.1 删除 node_modules | rimraf</a></li><li><a href="#_6-4-2-semver">6.4.2  semver |  ~ |  ^</a></li><li><a href="#_6-4-3-并行编译比较-thread-loader-happypack">6.4.3  并行编译比较 |  thread-loader |  HappyPack</a></li><li><a href="#_6-4-4-环境变量比较-mode-node-env-defineplugin-cross-env">6.4.4  环境变量比较  | mode |  NODE_ENV |  DefinePlugin |  cross-env</a></li><li><a href="#_6-4-4-npm-install-uninstall-npm-i-save-save-dev-s-d">6.4.4  npm install | uninstall |  npm  -i |  --save  |  --save-dev  |  -S | -D</a></li><li><a href="#_6-4-5-filename-chunkfilename">6.4.5  Filename  |   chunkFilename</a></li><li><a href="#_6-4-6-异步加载-require-ensure-魔法注释失效-webpackchunkname-webpackprefetch">6.4.6 异步加载 |  require.ensure |  魔法注释失效 | webpackChunkName | webpackPrefetch</a></li><li><a href="#_6-4-7-分包对比-commonschunkplugin-splitchunks">6.4.7 分包对比 | CommonsChunkPlugin |  splitChunks</a></li><li><a href="#_6-4-8-不生效-terser-chunkfilename">6.4.8  不生效 |  terser  |  chunkfilename</a></li></ul></li><li><a href="#_6-5-webpack-loader-重要">6.5 webpack | loader  |  重要</a><ul><li><a href="#_6-5-1-loader">6.5.1 loader</a></li><li><a href="#_6-5-2-babel-loader-plugin">6.5.2  babel-loader/plugin</a></li><li><a href="#_6-5-3-生命周期-webpack钩子-plugin示例">6.5.3 生命周期 | webpack钩子 | plugin示例</a></li><li><a href="#_6-5-4-基础的loader">6.5.4 基础的loader</a></li></ul></li><li><a href="#_6-6-webpack-plugin">6.6  webpack | plugin</a><ul><li><a href="#_6-6-0-基础">6.6.0 基础</a></li><li><a href="#_6-6-1-copyrightwebpackplugin-js">6.6.1 CopyrightWebpackPlugin.js</a></li><li><a href="#_6-6-2-delconsolewebpackplugin-js">6.6.2 DelConsoleWebpackPlugin.js</a></li><li><a href="#_6-6-3-analyzewebpackplugin-js">6.6.3 AnalyzeWebpackPlugin.js</a></li><li><a href="#调用">调用</a></li></ul></li><li><a href="#_6-7-webpack-version">6.7 webpack | version</a><ul><li><a href="#_6-7-1-webpack-5">6.7.1 webpack  5</a></li><li><a href="#_6-7-2-webpack-4">6.7.2 webpack  4</a></li><li><a href="#_6-7-3-webpack-3">6.7.3 webpack  3</a></li><li><a href="#_6-7-4-webpack-5-4">6.7.4 webpack 5 | 4</a></li><li><a href="#_6-7-5-webpack-4-3">6.7.5 webpack 4 | 3</a></li></ul></li><li><a href="#_6-9-js版本兼容-babel">6.9  js版本兼容 | babel</a><ul><li><a href="#_6-9-1-babel基本情况">6.9.1 babel基本情况</a></li><li><a href="#_6-9-2-webpack-的项目引入babel">6.9.2  webpack 的项目引入babel</a></li></ul></li><li><a href="#_6-10-css版本兼容-postcss">6.10 css版本兼容 | postcss</a><ul><li><a href="#_6-10-vue-config-js中">6.10 vue.config.js中</a></li><li><a href="#_6-10-posscss-config-js中">6.10 posscss.config.js中</a></li></ul></li><li><a href="#_6-11-webpack示例">6.11 webpack示例</a></li></ul></div><p></p> <p>https://www.webpackjs.com/</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>webpack 原理：
<span class="token operator">--</span><span class="token number">1.1</span><span class="token punctuation">.</span>从配置文件读取与合并参数，得出最终的参数（初始化参数）
<span class="token operator">--</span><span class="token number">1.2</span> 初始化compiler对象，调用plugin的apply方法（加载插件，开始编译）
<span class="token operator">--</span><span class="token number">1.3</span> entry开始，编译（compiler）ast语法树，过loader转化生成chunk，plugin（确定入口，编译模块<span class="token operator">-</span><span class="token function">（模块会被加载</span><span class="token punctuation">(</span>load<span class="token punctuation">)</span><span class="token function">、封存</span><span class="token punctuation">(</span>seal<span class="token punctuation">)</span><span class="token function">、优化</span><span class="token punctuation">(</span>optimize<span class="token punctuation">)</span><span class="token function">、分块儿</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token function">、哈希</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span><span class="token function">和重新创建</span><span class="token punctuation">(</span>restore<span class="token punctuation">)</span>））
<span class="token operator">--</span><span class="token number">1.4</span><span class="token punctuation">.</span>生成模块，输出资源

<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>webpack热更新原理：
<span class="token operator">--</span><span class="token number">2.0</span><span class="token punctuation">.</span>监控
<span class="token operator">--</span><span class="token number">2.1</span><span class="token punctuation">.</span>socket建立连接，传递hash值
<span class="token operator">--</span><span class="token number">2.2</span><span class="token punctuation">.</span>hmr runtime 根据变化发送json
<span class="token operator">--</span><span class="token number">2.3</span><span class="token punctuation">.</span>hmp比对tree并且更新module

<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>webpack运行顺序
<span class="token operator">&gt;</span> Preset 》 <span class="token function">Plugin</span><span class="token punctuation">(</span>从前到后顺序执行，从左到右 <span class="token operator">|</span> HotModuleReplacementPlugin<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">Preset</span><span class="token punctuation">(</span>从后向前<span class="token punctuation">,</span>从右往左<span class="token punctuation">)</span> <span class="token operator">&gt;</span> loader

<span class="token operator">--</span><span class="token number">4.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_6-1-配置"><a href="#_6-1-配置" class="header-anchor">#</a> 6.1 配置</h2> <h3 id="_6-1-1-external-模块"><a href="#_6-1-1-external-模块" class="header-anchor">#</a> 6.1.1 external 模块</h3> <p>跟<strong>splichtunk</strong> 模块很相似</p> <p>项目优化的方案：抽离公共的组件，减小项目的大小</p> <p>用于避免将一些很通用的模块打包进你发布的library里，而是选择把它们声明成external的模块</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token comment">// 比如我们现在要打包一个js类似于</span>
<span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">'jquery'</span>

当你的库需要依赖到例如jquery，bootstrap这样的通用<span class="token constant">JS</span>模块时，我们可以不将它打包进bundle，而是在Webpack的配置中声明external。npm install 的时候

<span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">jquery</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span> <span class="token comment">//可以通过一个全局变量访问 library （例如，通过 script 标签）。</span>
  <span class="token literal-property property">commonjs</span><span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span> <span class="token comment">//commonjs：可以将 library 作为一个 CommonJS 模块访问。</span>
  <span class="token literal-property property">commonjs2</span><span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">amd</span><span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_6-1-2-provideplugin"><a href="#_6-1-2-provideplugin" class="header-anchor">#</a> 6.1.2  ProvidePlugin</h3> <p>无需用require引入的全局变量</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">//提供全局的变量，在模块中使用无需用require引入</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">$config</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/data/config/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">CONFIG_ENV</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.env.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_6-1-3-code-splitting"><a href="#_6-1-3-code-splitting" class="header-anchor">#</a> 6.1.3 code splitting.</h3> <p>code splitting：每次改动业务逻辑代码，就会只打包业务逻辑 js，只有1Kb，节省打包的时间空间可能也有</p> <p>跟<strong>external</strong> 模块很像：但是<strong>external</strong>是节省打包空间的</p> <h4 id="_6-1-3-1-通用分隔代码方法"><a href="#_6-1-3-1-通用分隔代码方法" class="header-anchor">#</a> 6.1.3.1 通用分隔代码方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>webpack有三种通用的code spliting方法
<span class="token operator">--</span><span class="token number">1.</span><span class="token literal-property property">多entry方式</span><span class="token operator">:</span> 使用配置手动拆分代码
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">page1</span><span class="token operator">:</span> <span class="token string">'./src/page1.js'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">page2</span><span class="token operator">:</span> <span class="token string">'./src/page2.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
生成两个bundle<span class="token punctuation">,</span> 即page1<span class="token punctuation">.</span>bundle<span class="token punctuation">.</span>js和page2<span class="token punctuation">.</span>bundle<span class="token punctuation">.</span>js。

<span class="token operator">--</span><span class="token number">2.</span>公共提取： 使用依赖项或者SplitChunksPlugin

<span class="token comment">// 关键</span>
<span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//默认是deterministic</span>
    <span class="token literal-property property">chunkid</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span>  <span class="token comment">// 2. natural 按使用顺序的数字ID。</span>
 <span class="token comment">//3. named 方便调试的高可读性id</span>
 <span class="token comment">//4. deterministic 根据模块名称生成简短的hash值</span>
 <span class="token comment">//5. size 根据模块大小生成的数字id</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
如果两个都<span class="token keyword">import</span>了一个东西xx，那么xx就会被打包到xx<span class="token punctuation">.</span>bundle<span class="token punctuation">.</span>js

<span class="token operator">--</span><span class="token number">3.</span>动态加载：使用模块内的内联函数拆分代码

<span class="token keyword">function</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    script<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h4 id="_6-1-3-2-splitchunk工作原理"><a href="#_6-1-3-2-splitchunk工作原理" class="header-anchor">#</a> 6.1.3.2 splitChunk工作原理</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>调用如下
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something with lodash (a.k.a '_')...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

webpack的工作原理
requireEnsure方法中成功加载resolve，失败reject

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_6-1-4-webpackchunkname-webpackprefetch"><a href="#_6-1-4-webpackchunkname-webpackprefetch" class="header-anchor">#</a> 6.1.4  webpackChunkName | webpackPrefetch</h3> <p>--1.魔法注释:它其实就是对 chunkFilename 定义时 [name] 值的改写</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'three'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/*webpackChunkName: &quot;sum&quot; */</span> <span class="token string">'@/index3.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">meta</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">title</span><span class="token operator">:</span><span class="token string">&quot;sku算法&quot;</span><span class="token punctuation">,</span><span class="token literal-property property">role</span><span class="token operator">:</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token literal-property property">img</span><span class="token operator">:</span><span class="token string">'bitbug_favicon.ico'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>--2.通过魔法注释，对 chunk 的异步加载进行一系列优化</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* webpackPrefetch: true */</span>  <span class="token comment">//浏览器在闲置时间加载chunk 文件</span>
<span class="token comment">/* webpackPreload: true */</span>	<span class="token comment">// 浏览器在父chunk加载时并行加载</span>

在 webpack 中如果当前加载的 chunk 中有通过 webpackPrefetch 的依赖 chunk 时，就会创建一个<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;prefetch&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;依赖的chunk的路径&quot;</span><span class="token operator">&gt;</span>标签添加到head中。这样就实现了 magic comments 中的 prefetch

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_6-1-5-webpack-merge"><a href="#_6-1-5-webpack-merge" class="header-anchor">#</a> 6.1.5  webpack-merge</h3> <p>将共有的东西提取出来</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">6.1</span><span class="token number">.5</span> webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.base.config'</span><span class="token punctuation">)</span>
<span class="token comment">// webpack-merge 将公共的配置 和 开发的配置合并结合</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">smart</span><span class="token operator">:</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'development'</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> devConfig<span class="token punctuation">)</span>
<span class="token operator">--</span><span class="token number">3.2</span> webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js 
    <span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.base.config'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">smart</span><span class="token operator">:</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'production'</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> prodConfig<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_6-1-6-source-map"><a href="#_6-1-6-source-map" class="header-anchor">#</a> 6.1.6 source map</h3> <h4 id="_6-1-6-1-基础配置"><a href="#_6-1-6-1-基础配置" class="header-anchor">#</a> 6.1.6.1 基础配置</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//用来定位bug的。生产环境可以设置</span>
<span class="token literal-property property">configureWebpack</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">// devtool:&quot;source-map&quot;,</span>
    <span class="token literal-property property">devtool</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> 
<span class="token comment">//把这个东西藏起来</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_6-1-6-2-sourcemap-不同属性"><a href="#_6-1-6-2-sourcemap-不同属性" class="header-anchor">#</a> 6.1.6.2 sourcemap 不同属性</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">devtool</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">'eval-cheap-module-source-map'</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>false</p> <img src="/front-base-know-blog/assets/img/source_false.eda77984.png"> <p>source-map</p> <img src="/front-base-know-blog/assets/img/source_sourcemap.2fbb6631.png"> <p>eval-cheap-module-source-map</p> <img src="/front-base-know-blog/assets/img/source_mult_sourcemap.b0a051ad.png"> <h3 id="_6-1-7-loader"><a href="#_6-1-7-loader" class="header-anchor">#</a> 6.1.7 loader</h3> <p>因为webpack默认是打包js的，因此如果我们要打包css和ts还有图片然后引入官方loader就可以了</p> <h3 id="_6-1-8-runtime-only-runtime-compiler"><a href="#_6-1-8-runtime-only-runtime-compiler" class="header-anchor">#</a> 6.1.8 runtime-only |  runtime-compiler</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">4.</span>项目中的runtime<span class="token operator">-</span>only和runtime<span class="token operator">-</span>compiler对比？
我们首先要知道流程：template <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token function">ast</span><span class="token punctuation">(</span>抽象语法树<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> render <span class="token operator">-</span><span class="token operator">&gt;</span> vitural dom <span class="token operator">-</span><span class="token operator">&gt;</span> ui。我们默认是runtimeCompiler<span class="token operator">-</span>only
<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>1runtime<span class="token operator">-</span>compiler中，是将组件编译成模版再进行使用的（从template开始）
<span class="token operator">--</span><span class="token number">4.2</span>而runtime<span class="token operator">-</span><span class="token function">only，直接使用提供render函数</span><span class="token punctuation">(</span>从render开始<span class="token punctuation">)</span>
main<span class="token punctuation">.</span>js中是这样的
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">4.3</span>启用运行时编译表示现在使用的vue是runtime<span class="token operator">-</span>only，启用将使用runtime<span class="token operator">-</span>compiler。在vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js中runtimeCompiler<span class="token operator">:</span> <span class="token boolean">true</span>。他的作用是可以当作react的空标签帮助我们包裹元素，但是不会被渲染。vue<span class="token operator">-</span>template<span class="token operator">-</span>compiler的在开发依赖时将<span class="token punctuation">.</span>vue文件中的 template 解析成 render 函数
main<span class="token punctuation">.</span>js中是这样的
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div id=&quot;app-test&quot;&gt;x2222xx&lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token number">4.3</span><span class="token literal-property property">总结</span> <span class="token operator">:</span>runtime<span class="token operator">-</span>only能够更快一点<span class="token punctuation">.</span>因为能够 runtime<span class="token operator">-</span>compiler省略了第一个template变成render的过程，而采用vue<span class="token operator">-</span>template<span class="token operator">-</span>compiler直接编译了

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="_6-1-10-browserslistrc"><a href="#_6-1-10-browserslistrc" class="header-anchor">#</a> 6.1.10  browserslistrc</h3> <p>(browserslistrc的数据来自于can i use)</p> <p>babel是一个工具他自己什么是都做不了，通过.browserslistrc筛选出浏览器，再通过@babel/preset-env插件的集合处理转换，但是不能完成所有功能（promise symbol）的转换，所以加上polyfill。</p> <p>@babel/preset-env和 Autoprefixer用来确定需要转译的 JavaScript 特性和需要添加的 CSS 浏览器前缀</p> <p>根目录下面新建这个文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;</span><span class="token number">1</span>%
last <span class="token number">2</span> version
not dead
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>package.json中添加</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string-property property">&quot;browserslist&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">&quot;&gt;1%&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;last 2 version&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;not dead&quot;</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_6-1-11-环境的配置"><a href="#_6-1-11-环境的配置" class="header-anchor">#</a> 6.1.11 环境的配置</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>shell中
npm install cross<span class="token operator">-</span>env 
<span class="token operator">--</span><span class="token number">2.</span>就可以在<span class="token keyword">package</span><span class="token punctuation">.</span>json中
<span class="token string-property property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production vue-cli-service serve&quot;</span>
<span class="token operator">--</span><span class="token number">3.</span>
就可以在任何地方
process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span>进行调用了
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_6-1-12-锁定版本号"><a href="#_6-1-12-锁定版本号" class="header-anchor">#</a> 6.1.12 锁定版本号</h3> <p>锁定版本：去掉^或~</p> <h2 id="_6-2-vue-cli-基本配置示例"><a href="#_6-2-vue-cli-基本配置示例" class="header-anchor">#</a> 6.2 vue-cli | 基本配置示例</h2> <h3 id="_6-2-1-vue-cli-版本"><a href="#_6-2-1-vue-cli-版本" class="header-anchor">#</a> 6.2.1 vue-cli 版本</h3> <table><thead><tr><th style="text-align:center;">版本</th> <th style="text-align:center;">vuecli</th></tr></thead> <tbody><tr><td style="text-align:center;">2.0</td> <td style="text-align:center;">1.基于webpack3 |  2.初始化项目用vue init webpack my-project</td></tr> <tr><td style="text-align:center;">3.0</td> <td style="text-align:center;">1.基于webpack4 | 2.初始化项目用vue create | 3.移除了build和config等目录 | 4.core-js从2.xx变成了3.xx</td></tr> <tr><td style="text-align:center;">4.0</td> <td style="text-align:center;">1.cli3.0跟4.0差不多 | 2.自带了webpack-bundle-analyzer | thread-loader。speed-measure-webpack-plugin还是没有 |</td></tr></tbody></table> <h3 id="_6-2-2-vue-cli和webpack"><a href="#_6-2-2-vue-cli和webpack" class="header-anchor">#</a> 6.2.2  vue-cli和webpack</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install <span class="token operator">-</span>g @vue<span class="token operator">/</span>cli

<span class="token operator">--</span><span class="token number">1.</span>查看@vue<span class="token operator">/</span>cli 版本
<span class="token comment">//输出@vue/cli 4.5.15</span>
vue <span class="token operator">-</span><span class="token constant">V</span>

<span class="token operator">--</span><span class="token number">2.</span>查看当前项目的vue<span class="token operator">/</span>cli的webpack版本
node_mudules

<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>vue<span class="token operator">-</span>cli和webpack有个默认配置，该对象将会被 webpack<span class="token operator">-</span>merge 合并入最终的 webpack 配置。
<span class="token operator">--</span><span class="token number">3.1</span><span class="token punctuation">.</span>如下访问：<span class="token operator">/</span>node_modules<span class="token operator">/</span>@vue<span class="token operator">/</span>cli<span class="token operator">-</span>service<span class="token operator">/</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js
<span class="token operator">--</span><span class="token number">3.2</span><span class="token punctuation">.</span>调整 webpack 配置最简单的方式就是在 vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js 中的 configureWebpack 选项提供一个对象：
<span class="token comment">// vue.config.js module.exports = { configureWebpack: { plugins: [ new MyAwesomeWebpackPlugin() ] } }</span>
<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>3Vue <span class="token constant">CLI</span> 内部的 webpack 配置是通过 webpack<span class="token operator">-</span>chain 维护的 <span class="token punctuation">.</span>可以通过chain来进行调用

<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>vue<span class="token operator">-</span>cli之中的webpack的优化示例
<span class="token keyword">const</span> shadowMode <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_CLI_CSS_SHADOW_MODE</span>
<span class="token keyword">const</span> needInlineMinification <span class="token operator">=</span> isProd <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>shouldExtract
<span class="token keyword">if</span> <span class="token punctuation">(</span>shouldExtract<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          rule<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'extract-css-loader'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>loader<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">publicPath</span><span class="token operator">:</span> cssPublicPath<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_6-2-4-vue-config-js基础"><a href="#_6-2-4-vue-config-js基础" class="header-anchor">#</a> 6.2.4 vue.config.js基础</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install  webpack<span class="token operator">-</span>bundle<span class="token operator">-</span>analyzer <span class="token operator">-</span><span class="token constant">D</span>

<span class="token keyword">var</span> BundleAnalyzerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin

<span class="token keyword">const</span> env <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">;</span><span class="token comment">//当前环境</span>
<span class="token comment">// 默认是本地环境</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 生产环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------生产环境----------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">//优化：关闭打包的map文件</span>
        <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">analyzerMode</span><span class="token operator">:</span> <span class="token string">'server'</span><span class="token punctuation">,</span> <span class="token comment">// 每次构建时自动打开server  手动打开 disabled</span>
                    <span class="token literal-property property">generateStatsFile</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否生成stats.json文件</span>
                    <span class="token literal-property property">statsOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;filesystem&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">allowCollectingMemory</span><span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">// 性能提示</span>
            <span class="token literal-property property">performance</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// hints: &quot;error&quot;     // 超过250kb 的资源 我们掏出错误</span>
                <span class="token literal-property property">maxAssetSize</span><span class="token operator">:</span> <span class="token number">250000</span> <span class="token comment">//最大250000 bytes</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//优化器</span>
            <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">chunkIds</span><span class="token operator">:</span> <span class="token string">&quot;named&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 2. natural 按使用顺序的数字ID。</span>
 <span class="token comment">//3. named 方便调试的高可读性id</span>
 <span class="token comment">//4. deterministic 根据模块名称生成简短的hash值</span>
 <span class="token comment">//5. size 根据模块大小生成的数字id</span>
                <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">// runtimeChunk: &quot;single&quot;,  //单独打包，小文件还挺好用的</span>
                    <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 必须三选一： &quot;initial&quot; | &quot;all&quot;(推荐) | &quot;async&quot; (默认就是async)</span>
                    <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 最小尺寸，30000 超过30K才独立分包</span>
                    <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 最小 chunk ，默认1</span>
                    <span class="token literal-property property">maxAsyncRequests</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 最大异步请求数， 默认5</span>
                    <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// 最大初始化请求书，默认3</span>
                    <span class="token literal-property property">automaticNameDelimiter</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 打包分隔  </span>
                    <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 这里开始设置缓存的 chunks</span>
                        <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 缓存组优先级</span>
    
                        <span class="token literal-property property">elementUI</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'elementUI'</span><span class="token punctuation">,</span> <span class="token comment">// 将elementUI拆分为单个包</span>
                            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]_?element-ui(.*)</span><span class="token regex-delimiter">/</span></span> <span class="token comment">// in order to adapt to cnpm</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// 优化：代码压缩，使用terser来缩小/最小化你的 JavaScript</span>
                <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//压缩图片</span>
        <span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    
    
    <span class="token punctuation">}</span>
    

<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">'test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 测试环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------测试环境----------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 开发环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------开发环境----------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">//优化：关闭打包的map文件</span>
        <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">analyzerMode</span><span class="token operator">:</span> <span class="token string">'server'</span><span class="token punctuation">,</span> <span class="token comment">// 每次构建时自动打开server  手动打开 disabled</span>
                    <span class="token literal-property property">generateStatsFile</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否生成stats.json文件</span>
                    <span class="token literal-property property">statsOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;filesystem&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">allowCollectingMemory</span><span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">// 性能提示</span>
            <span class="token literal-property property">performance</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// hints: &quot;error&quot;     // 超过250kb 的资源 我们掏出错误</span>
                <span class="token literal-property property">maxAssetSize</span><span class="token operator">:</span> <span class="token number">250000</span> <span class="token comment">//最大250000 bytes</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//优化器</span>
            <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">chunkIds</span><span class="token operator">:</span> <span class="token string">&quot;named&quot;</span><span class="token punctuation">,</span> <span class="token comment">//1.named选择块 ID 时的算法在编译之间不会更改的短数字 ID。 // 2.'deterministic'选择快 编译的时候默认使用适合长期缓存。生产模式默认启用。</span>
                <span class="token comment">//对应着chain模块就是   config.optimization.splitChunks({})  只有splitChunks:里面的参数可以被引用</span>
                <span class="token comment">// 可以在 vue配置文件中加入 /* webpackChunkName:&quot;lodash&quot; */ 就可以在打包js的时候叫做这个名字</span>
                <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">// runtimeChunk: &quot;single&quot;,  //单独打包，小文件还挺好用的</span>
                    <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 必须三选一： &quot;initial&quot; | &quot;all&quot;(推荐) | &quot;async&quot; (默认就是async)</span>
                    <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 最小尺寸，30000 超过30K才独立分包</span>
                    <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 最小 chunk ，默认1</span>
                    <span class="token literal-property property">maxAsyncRequests</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 最大异步请求数， 默认5</span>
                    <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// 最大初始化请求书，默认3</span>
                    <span class="token literal-property property">automaticNameDelimiter</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 打包分隔  </span>
                    <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 这里开始设置缓存的 chunks</span>
                        <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 缓存组优先级</span>
    
                        <span class="token literal-property property">elementUI</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'elementUI'</span><span class="token punctuation">,</span> <span class="token comment">// 将elementUI拆分为单个包</span>
                            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]_?element-ui(.*)</span><span class="token regex-delimiter">/</span></span> <span class="token comment">// in order to adapt to cnpm</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// 优化：代码压缩，使用terser来缩小/最小化你的 JavaScript</span>
                <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//压缩图片</span>
        <span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    
    
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br></div></div><h3 id="_6-2-4-webpack-版本"><a href="#_6-2-4-webpack-版本" class="header-anchor">#</a> 6.2.4 webpack 版本</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install webpack@<span class="token number">4</span> webpack<span class="token operator">-</span>cli@<span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_6-3-快问快答"><a href="#_6-3-快问快答" class="header-anchor">#</a> 6.3 快问快答</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span> webpack的source<span class="token operator">-</span>map了解吗
用来定位bug的。
<span class="token operator">--</span><span class="token number">2.</span>如果开发环境没有source<span class="token operator">-</span>map，那如何去定位错误呢？
如果是是vue或者是react的代码，他会有编译，因此我们既然不能从源码层面去定义错误。我们可以分情况讨论 有接口错误 dom错误，我们可以通过chrome打上断点来进行调试
    
<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>webpack如何去做拆分合并配置？（这里的知识点主要是想合并共同项目的配置<span class="token operator">-</span>webpack<span class="token operator">-</span>merge）

<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>import和我们的代码在webpack里转化成了什么？<span class="token keyword">import</span>转化成了__webpack_require__，自己的代码转化成了eval

<span class="token operator">--</span><span class="token number">5</span><span class="token punctuation">.</span>webpack 和 webpack<span class="token operator">-</span>cli的区别
webpack<span class="token operator">-</span>cli 只是处理参数，且执行webpack的run命令
并通过参数构建 compiler 对象，然后才是对代码进行打包的过程。


<span class="token operator">--</span><span class="token number">6</span><span class="token punctuation">.</span>vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js中modules<span class="token punctuation">.</span>export两个对象会哪一个会生效
同时导出两个东西，那么只有后面的那个能够生效

<span class="token operator">--</span><span class="token number">7</span><span class="token punctuation">.</span>webpack的 chunk 和 modules
我们先说一下webpack的解析策略：分析entry，逐一遍历。接下来确定依赖和进行分包策略最后输出template。template <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token function">ast</span><span class="token punctuation">(</span>抽象语法树<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> render <span class="token operator">-</span><span class="token operator">&gt;</span> vitural dom <span class="token operator">-</span><span class="token operator">&gt;</span> ui
chunk是由多个module合并生成的，每一个chunk生成的时候都会有一个对应的chunkId

<span class="token operator">--</span><span class="token number">8.</span>在我们webpack4增量更新的时候，其实这玩意能够破坏线上缓存。我们怎么解决呢？
万物的罪魁祸首是chunkId，所以必须要固定它，才能让文件内容不会变。解决方案是在beforeChunkIds基于module内容来生成唯一hash<span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token operator">-</span>fixed<span class="token operator">-</span>chunk<span class="token operator">-</span>id<span class="token operator">-</span>plugin。这个问题在webpack5中已经得到了解决

<span class="token operator">--</span><span class="token number">9</span><span class="token punctuation">.</span>optimization的id配置有什么区别

<span class="token operator">--</span><span class="token number">9.1</span> natural 就是webpack5以前生产模式下的命名方式。
<span class="token operator">--</span><span class="token number">9.1</span> named 是根据项目文件路径生成名称，webpack以前和现在的开发环境模式默认使用这种命名方式
<span class="token operator">--</span><span class="token number">9.2</span> size 是根据模块大小来生成数字。
<span class="token operator">--</span><span class="token number">9.3</span> deterministic 是webpack5新增的命名方式，根据文件名称生成短hash，webpack5生产模式下默认启用。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_6-4-小技巧-版本对比-失效分析"><a href="#_6-4-小技巧-版本对比-失效分析" class="header-anchor">#</a> 6.4 小技巧 | 版本对比 | 失效分析</h2> <p>查看当前配置:可以看到我们有没有重复配置了一个东西和看到vue-cli是怎么配的</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vue inspect &gt; output.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_6-4-1-删除-node-modules-rimraf"><a href="#_6-4-1-删除-node-modules-rimraf" class="header-anchor">#</a> 6.4.1 删除 node_modules | rimraf</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> rimraf <span class="token parameter variable">-g</span>
rimraf node_modules
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_6-4-2-semver"><a href="#_6-4-2-semver" class="header-anchor">#</a> 6.4.2  semver |  ~ |  ^</h3> <p>~1.2.3 与 ^1.2.3 的版本号范围是多少</p> <p>semver是Semantic Versioning语义化版本的缩写。它由 <code>[major, minor, patch]</code> 三部分组成</p> <p>对于 <code>~1.2.3</code> 而言，它的版本号范围是 <code>&gt;=1.2.3 &lt;1.3.0</code></p> <p>对于 <code>^1.2.3</code> 而言，它的版本号范围是 <code>&gt;=1.2.3 &lt;2.0.0</code></p> <p>当我们 <code>npm i</code> 时，默认的版本号是 <code>^</code>，可最大限度地在向后兼容与新特性之间做取舍，但是有些库有可能不遵循该规则，我们在项目时应当使用 <code>yarn.lock</code>/<code>package-lock.json</code> 锁定版本号。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>npm i 某个 <span class="token keyword">package</span> 时会修改 <span class="token keyword">package</span><span class="token operator">-</span>lock<span class="token punctuation">.</span>json 中的版本号吗？

当 <span class="token keyword">package</span><span class="token operator">-</span>lock<span class="token punctuation">.</span>json 该 <span class="token keyword">package</span> 锁死的版本号符合 <span class="token keyword">package</span><span class="token punctuation">.</span>json 中的版本号范围时，将以 <span class="token keyword">package</span><span class="token operator">-</span>lock<span class="token punctuation">.</span>json 锁死版本号为主。

当 <span class="token keyword">package</span><span class="token operator">-</span>lock<span class="token punctuation">.</span>json 该 <span class="token keyword">package</span> 锁死的版本号不符合 <span class="token keyword">package</span><span class="token punctuation">.</span>json 中的版本号范围时，将会安装该 <span class="token keyword">package</span> 符合 <span class="token keyword">package</span><span class="token punctuation">.</span>json 版本号

<span class="token operator">--</span><span class="token number">2.</span>为了稳定我们一般会把项目中的<span class="token operator">^</span>变成<span class="token operator">~</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_6-4-3-并行编译比较-thread-loader-happypack"><a href="#_6-4-3-并行编译比较-thread-loader-happypack" class="header-anchor">#</a> 6.4.3  并行编译比较 |  thread-loader |  HappyPack</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>thread<span class="token operator">-</span>loader <span class="token operator">|</span>  HappyPack
<span class="token operator">--</span><span class="token number">1.</span>由于HappyPack作者对js的兴趣逐步丢失，所以之后维护将变少，webpack4及之后推荐使用thread<span class="token operator">-</span>loader
<span class="token operator">--</span><span class="token number">2.</span>在webpack4使用需要HappyPack5<span class="token punctuation">.</span><span class="token number">0</span>的版本 引入之后将rules对js的编译改为happypack<span class="token operator">/</span>loader
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_6-4-4-环境变量比较-mode-node-env-defineplugin-cross-env"><a href="#_6-4-4-环境变量比较-mode-node-env-defineplugin-cross-env" class="header-anchor">#</a> 6.4.4  环境变量比较  | mode |  NODE_ENV |  DefinePlugin |  cross-env</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>mode的基础介绍：选择 development<span class="token punctuation">,</span> production 或 none 之中的一个。<span class="token keyword">package</span><span class="token punctuation">.</span>json中定义。或者在shell脚本中进行传递（模块中process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span>是能够拿到的，但是webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js拿不到）
<span class="token operator">--</span><span class="token number">2.</span><span class="token constant">NODE_ENV</span>既可以在模块中用，也可以在webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js中用。（但是window和linux的使用不一样）
<span class="token operator">--</span><span class="token number">3.</span>这个时候就要使用 cross<span class="token operator">-</span>env <span class="token constant">NODE_ENV</span><span class="token operator">=</span>production vue<span class="token operator">-</span>cli<span class="token operator">-</span>service serve的命令 <span class="token operator">|</span> npm install  cross<span class="token operator">-</span>env <span class="token operator">-</span><span class="token constant">S</span>
<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>webpack4 移除了 DefinePlugin 添加了 mode
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_6-4-4-npm-install-uninstall-npm-i-save-save-dev-s-d"><a href="#_6-4-4-npm-install-uninstall-npm-i-save-save-dev-s-d" class="header-anchor">#</a> 6.4.4  npm install | uninstall |  npm  -i |  --save  |  --save-dev  |  -S | -D</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>dependencies和devDependencies
<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>webpack是一个模块打包器，它会以entryPoint声明的文件为入口，查找<span class="token keyword">import</span>语句构建依赖图，无论你的依赖被声明在devDependencies或dependencies中，只要被包含在依赖图中，那么它都会被打包进你的dist中<span class="token punctuation">.</span>
	不过一般来说，我更倾向于遵循node的约定，将依赖分开声明，这对于提高项目的可读性是有帮助的。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span><span class="token operator">--</span>save <span class="token operator">-</span><span class="token constant">S</span> 是生产阶段<span class="token operator">+</span>开发的依赖
<span class="token operator">--</span><span class="token number">2.</span><span class="token operator">--</span>save<span class="token operator">-</span>dev <span class="token operator">-</span><span class="token constant">D</span> 是dev环境的依赖
<span class="token operator">--</span><span class="token number">3.</span> npm i安装的模块无法用npm uninstall删除，用npm uninstall i才卸载掉。npm i 会帮助检测 和 当前 node 最匹配的 npm 版本号，并匹配出相互依赖的npm 包应该升级的版本号（简称自作主张）
<span class="token number">4.</span>
npm uninstall 模块：删除模块，但不删除模块留在<span class="token keyword">package</span><span class="token punctuation">.</span>json中的对应信息。之后都可以增加 <span class="token operator">-</span><span class="token constant">S</span> <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_6-4-5-filename-chunkfilename"><a href="#_6-4-5-filename-chunkfilename" class="header-anchor">#</a> 6.4.5  Filename  |   chunkFilename</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Filename：打包同步代码
chunkFilename：打包异步代码

vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js中的module<span class="token punctuation">.</span>exports 中的configureWebpack的output中的
<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'js/js.bundle.js'</span><span class="token punctuation">,</span>   <span class="token comment">//同步代码</span>
<span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">'js/js.bundle.js'</span><span class="token punctuation">,</span>  <span class="token comment">//异步代码</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_6-4-6-异步加载-require-ensure-魔法注释失效-webpackchunkname-webpackprefetch"><a href="#_6-4-6-异步加载-require-ensure-魔法注释失效-webpackchunkname-webpackprefetch" class="header-anchor">#</a> 6.4.6 异步加载 |  require.ensure |  魔法注释失效 | webpackChunkName | webpackPrefetch</h3> <p>/* webpackPrefetch: true */  //浏览器在闲置时间加载chunk 文件
/ * webpackPreload: true */	// 浏览器在父chunk加载时并行加载</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>路由失效的问题
魔法注释<span class="token comment">/*webpackChunkName: &quot;测试&quot; */</span>在路由中使用生效但是又没有生效，初步猜想是babel插件的兼容性问题。从由来的
<span class="token literal-property property">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token comment">/*webpackChunkName: &quot;测试&quot;*/</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/viewnd.vue'</span><span class="token punctuation">)</span> 替换成
<span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/components/HelloWorld'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'测试'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
<span class="token operator">--</span><span class="token number">2.</span> webpackChunkName
require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span>dependencies<span class="token operator">:</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
 <span class="token literal-property property">chunkName</span><span class="token operator">:</span> String<span class="token punctuation">)</span>
 
 <span class="token punctuation">.</span><span class="token operator">/</span>index<span class="token punctuation">.</span>js中
<span class="token keyword">function</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;测试&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span> <span class="token punctuation">{</span>b<span class="token punctuation">}</span>

vue中
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_6-4-7-分包对比-commonschunkplugin-splitchunks"><a href="#_6-4-7-分包对比-commonschunkplugin-splitchunks" class="header-anchor">#</a> 6.4.7 分包对比 | CommonsChunkPlugin |  splitChunks</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>webpack <span class="token number">4</span> 最大的改动就是废除了 CommonsChunkPlugin 引入了 optimization<span class="token punctuation">.</span>splitChunks。如果你的 mode 是 production，那么 webpack4 就会自动开启 Code Splitting。CommonsChunkPlugin

<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>vendor<span class="token punctuation">.</span>js和splitchunks分析
<span class="token operator">--</span><span class="token number">2.1</span> 通过bundle<span class="token operator">-</span>analysis得到 vendor<span class="token punctuation">.</span>js 是首页必须加载的大文件。但是太大了
<span class="token operator">--</span><span class="token number">2.2</span> echart 和 iview 文件太大，应该使用 cdn 引入的方法

<span class="token operator">--</span><span class="token number">3.</span>一些配置示例
element<span class="token operator">-</span>ui
optimization
	
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">//首页</span>
        <span class="token literal-property property">vendors</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'chunk-vendors'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[/]node_modules[/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'initial'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">iview</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'chunk-element-ui'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[/]node_modules[/]_?ielement-ui(.*)</span><span class="token regex-delimiter">/</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">commons</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'chunk-commons'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'initial'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>



</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="_6-4-8-不生效-terser-chunkfilename"><a href="#_6-4-8-不生效-terser-chunkfilename" class="header-anchor">#</a> 6.4.8  不生效 |  terser  |  chunkfilename</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>terser不生效：我们先用 cross<span class="token operator">-</span>env <span class="token constant">NODE_ENV</span><span class="token operator">=</span>production vue inspect <span class="token operator">&gt;</span> output<span class="token punctuation">.</span>js分析一下具体的原因 发现原来我写的是
 <span class="token literal-property property">minimizer</span><span class="token operator">:</span> 
<span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">terserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">mangle</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 混淆，默认也是开的，mangle也是可以配置很多选项的，具体看后面的链接</span>
        <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">drop_console</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//传true就是干掉所有的console.*这些函数的调用.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
这种方式导致的后果就是vue<span class="token operator">-</span>cli本身就有一个TerserPlugin，所以不会被覆盖，如果我们要覆盖他我们要用链式传值
<span class="token function">chainWebpack</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>optimization<span class="token punctuation">.</span><span class="token function">minimizer</span><span class="token punctuation">(</span><span class="token string">'terser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>parallel <span class="token operator">=</span> <span class="token number">4</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>terserOptions<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>warnings <span class="token operator">=</span> <span class="token boolean">true</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>terserOptions<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>drop_debugger <span class="token operator">=</span> <span class="token boolean">true</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>terserOptions<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>drop_console <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">return</span> args
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
12m变成3m。。。。。。。。。很恐怖 
     
     
<span class="token operator">--</span><span class="token number">2.</span> chunkfilename 不生效可能是因为跟babel冲突了（路由）
用
<span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/components/HelloWorld'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'测试'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 代替chunkfilename 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="_6-5-webpack-loader-重要"><a href="#_6-5-webpack-loader-重要" class="header-anchor">#</a> 6.5 webpack | loader  |  重要</h2> <h3 id="_6-5-1-loader"><a href="#_6-5-1-loader" class="header-anchor">#</a> 6.5.1 loader</h3> <p>https://cloud.tencent.com/developer/article/1865736</p> <p>注意一下如果use 和 options在同一层级会报错。因此我们要一个 loader（里面用path解析路径） 和option</p> <h4 id="_6-5-1-1-loader是什么"><a href="#_6-5-1-1-loader是什么" class="header-anchor">#</a> 6.5.1.1 loader是什么</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>将不同类型的文件转换为 webpack 可识别的模块

<span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>Loader 的本质是什么？
Loader 本质上是导出函数的 JavaScript 模块。所导出的函数，可用于实现内容转换，该函数支持以下 <span class="token number">3</span> 个参数（content 源文件的内容，使用的 SourceMap 数据，meta 数据，可以是任何内容）
<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>Normal Loader 和 Pitching Loader 是什么？
loader 可以被分为 <span class="token number">4</span> 类：pre 前置、post 后置、normal 普通和 inline 行内。其中 pre 和 post loader，可以通过 rule 对象的 enforce 属性来指定：
<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;a-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">enforce</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> <span class="token comment">// post loader</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>Pitching Loader <span class="token function">的作用是什么？</span><span class="token punctuation">(</span>从左到右<span class="token punctuation">)</span>
在开发 Loader 时，我们可以在导出的函数上添加一个 pitch 属性，它的值也是一个函数。该函数被称为 Pitching Loader 它支持 <span class="token number">3</span> 个参数：
<span class="token comment">/**
 * @remainingRequest 剩余请求
 * @precedingRequest 前置请求
 * @data 数据对象
 */</span>
<span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">remainingRequest<span class="token punctuation">,</span> precedingRequest<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment">// some code</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Pitching Loader 的执行顺序是 从左到右，而 Normal Loader 的执行顺序是 从右到左
其实当某个 Pitching Loader 返回非 <span class="token keyword">undefined</span> 值时，就会实现熔断效果。<span class="token keyword">return</span> <span class="token string">&quot;xx&quot;</span>的时候，会跳过剩下的loader（已经执行的loader会在pitch之后进行返回）

<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>Loader 是如何被加载的？

<span class="token operator">--</span><span class="token number">5.</span>异步方式怎么获取值
Loader 可以分为同步 Loader 和异步 Loader。对于异步loader。我们需要调用 <span class="token keyword">this</span><span class="token punctuation">.</span>async 方法来获取 callback 函数：
Loader 最终的返回结果是如何被处理的？

<span class="token operator">--</span><span class="token number">6.</span> 常见报错 
xxxxx is not a <span class="token function">loader</span> <span class="token punctuation">(</span>must have normal or pitch <span class="token keyword">function</span><span class="token punctuation">)</span>
我是通过
<span class="token punctuation">{</span>
    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.ts$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">loader</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'./loader/console.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>然后直接报错

正确的做法
<span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;b-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// normal loader</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h4 id="_6-5-1-2-loader实例"><a href="#_6-5-1-2-loader实例" class="header-anchor">#</a> 6.5.1.2 loader实例</h4> <p>根目录下面新建loader/replaceLoader.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//不能为箭头函数一定要这个格式,参数为引入文件的原代码</span>
  <span class="token comment">// console.log(&quot;loader之中获取的参数&quot;,this.query)</span>
  <span class="token comment">// 需求1：在编译阶段，把index.js里面的{{ __path__ }}转化为我们真正需要的路径</span>
  <span class="token comment">// result=source.replace('{{ __path__ }}', 'electrolux')</span>
  <span class="token comment">// return  result</span>
  <span class="token comment">//this.callback 也是官方提供的API，替代return</span>
  <span class="token comment">// this.callback(null, result); content  sourceMap</span>
  <span class="token comment">// this.callback能传递以下四个参数.第三个参数和第四个参数可以不填.this.callback传递的参数会发送给下一个loader函数接受,每一个loader函数形成了流水线上的一道道工序,最终将代码处理成期待的结果.</span>
  <span class="token comment">// 万一loader函数里面需要做一些异步的操作就要采用如下方式.</span>
  <span class="token comment">//上一个loader可能会传递sourceMap和meta过来,没穿就为空</span>
  <span class="token comment">//   module.exports = function (content, sourceMap, meta) {</span>
  <span class="token comment">//     const callback = this.async()</span>
  <span class="token comment">//     setTimeout(() =&gt; {</span>
  <span class="token comment">//       // 模拟异步操作</span>
  <span class="token comment">//       callback(null, content)</span>
  <span class="token comment">//     }, 1000)</span>
  <span class="token comment">//   }</span>
    
    
  <span class="token keyword">return</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">console\.log\(.*\);?</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>vue.config.js 中写入</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token punctuation">{</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              <span class="token literal-property property">loader</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./loaders/replaceLoader.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;我的名字是electrolux &quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_6-5-2-babel-loader-plugin"><a href="#_6-5-2-babel-loader-plugin" class="header-anchor">#</a> 6.5.2  babel-loader/plugin</h3> <p>Plugin的编写就灵活了许多。 webpack在运行的生命周期中会广播出许多事件，Plugin 可以监听这些事件，在合适的时机通过 Webpack 提供的 API 改变输出结果</p> <h4 id="_6-5-2-1-编写示例-babel-不正式"><a href="#_6-5-2-1-编写示例-babel-不正式" class="header-anchor">#</a> 6.5.2.1 编写示例(babel | 不正式)</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token literal-property property">types</span><span class="token operator">:</span> t <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">//基于vistior设计模式</span>
    <span class="token literal-property property">visitor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 知识点1：debug可执行</span>
      <span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 使用的时候 if(DEBUG){}</span>
        <span class="token keyword">const</span> parentNodeIsIfStatement <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">isIfStatement</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// const isDebug = path.node.name === &quot;DEBUG&quot;;</span>
        <span class="token keyword">const</span> isDebug <span class="token operator">=</span> path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">&quot;DEBUG&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isDebug <span class="token operator">&amp;&amp;</span> parentNodeIsIfStatement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//if 变成 string</span>
          <span class="token keyword">const</span> stringNode <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">stringLiteral</span><span class="token punctuation">(</span><span class="token string">&quot;DEBUG&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 替换原来的函数</span>
          path<span class="token punctuation">.</span><span class="token function">replaceWith</span><span class="token punctuation">(</span>stringNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 知识点2：可移除-父级是if而且</span>
      <span class="token function">StringLiteral</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> parentNodeIsIfStatement <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">isIfStatement</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> isDebug <span class="token operator">=</span> path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">&quot;DEBUG&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>node<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
          path<span class="token punctuation">.</span>parentPath<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isDebug <span class="token operator">&amp;&amp;</span> parentNodeIsIfStatement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            path<span class="token punctuation">.</span>parentPath<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h4 id="_6-5-2-2-使用示例-babel-不正式"><a href="#_6-5-2-2-使用示例-babel-不正式" class="header-anchor">#</a> 6.5.2.2 使用示例(babel | 不正式)</h4> <p><strong>babel.config.js</strong> 中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@vue/cli-plugin-babel/preset&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;../index.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_6-5-2-3-plugin正式示例"><a href="#_6-5-2-3-plugin正式示例" class="header-anchor">#</a> 6.5.2.3 plugin正式示例</h4> <p>compiler对象是webpack整一个整个生命周期钩子的对象，可以通过Compiler对象访问到webpack的主环境配置，比如loader、plugin等配置信息。</p> <p>compilation 对象 负责的是粒度更小的生命周期钩子，处理每种类型的资源时都会创建一个compilation对象</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>

调试可以 npm run serve <span class="token operator">&gt;&gt;</span> target<span class="token punctuation">.</span>txt

<span class="token keyword">var</span> <span class="token function-variable function">WebpackClearConsole</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">WebpackClearConsole</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">apply</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token comment">//获取emit钩子</span>
    compiler<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&quot;emit&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        compilation<span class="token punctuation">.</span>chunks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 遍历文件</span>
            chunk<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 获取内容</span>
                <span class="token keyword">var</span> source <span class="token operator">=</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> consoleName<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;console&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;window.console&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> consoleType<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;log&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;warn&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;assert&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;count&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;clear&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;group&quot;</span> <span class="token punctuation">,</span>
                    <span class="token string">&quot;groupEnd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;groupCollapsed&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;trace&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dir&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;dirxml&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;profile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;profileEnd&quot;</span> <span class="token punctuation">,</span>
                    <span class="token string">&quot;time&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;timeEnd&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;timeStamp&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;table&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;exception&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">//Console.log|debug|info|warn|error regexp</span>
                rConsole <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> consoleName<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;.(?:&quot;</span> <span class="token operator">+</span> consoleType<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)\\s{0,}\\([^;]*\\)(?!\\s*[;,]?\\s*\\/\\*\\s*NotClearConsole\\s*\\*\\/)\\s{0,};?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;gi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//替换内容</span>
                source <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>rConsole<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> source<span class="token punctuation">.</span>replaceWith <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token function-variable function">source</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">size</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> WebpackClearConsole<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="_6-5-3-生命周期-webpack钩子-plugin示例"><a href="#_6-5-3-生命周期-webpack钩子-plugin示例" class="header-anchor">#</a> 6.5.3 生命周期 | webpack钩子 | plugin示例</h3> <p>https://www.webpackjs.com/api/compiler-hooks/</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>hook的种类（<span class="token number">10</span>种）
<span class="token function">Tapable为webpack提供了插件接口</span><span class="token punctuation">(</span>钩子<span class="token punctuation">)</span>类型定义，它是webpack的核心功能库，webpack目前有<span class="token number">10</span>种hooks， 在Tapable源码汇总可以看到，他们是：
exports<span class="token punctuation">.</span>SyncHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>SyncBailHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncBailHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>SyncWaterfallHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncWaterfallHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>SyncLoopHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncLoopHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncParallelHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncParallelHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncParallelBailHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncParallelBailHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncSeriesHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">--</span>这个玩意里面有emit，run，compilation
exports<span class="token punctuation">.</span>AsyncSeriesBailHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesBailHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncSeriesLoopHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesLoopHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncSeriesWaterfallHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesWaterfallHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>HookMap <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./HookMap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>MultiHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./MultiHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>hook的构建（<span class="token number">3</span>种）
tapable暴露了<span class="token number">3</span>个方法给插件，用于注入不同类型的自定义构建行为。
<span class="token literal-property property">tap</span><span class="token operator">:</span> 可以注册同步钩子和异步钩子
tapAsync： 回调方式注册异步钩子   <span class="token comment">//compiler.hooks.emit.tapAsync</span>
tapPromise： promise方式注册异步钩子
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>plugin<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">class</span> <span class="token class-name">CopyrightWebpackPlugin</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>params <span class="token operator">=</span> params
    <span class="token punctuation">}</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">-----------</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-----------------</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在资源输出之前触发</span>
        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;emit&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// console.log(compilation)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> name <span class="token keyword">in</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//文件名字 console.log(name)</span>
                <span class="token comment">// console.log(name)</span>
                <span class="token comment">//文件内容 compilation.assets[name].source()</span>
                <span class="token comment">//匹配文件 name.endsWith('.js')</span>
                <span class="token keyword">let</span> source <span class="token operator">=</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> rConsole <span class="token operator">=</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">console.log\(.*?\)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
                    source <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>rConsole<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// console.log(source)</span>
                    compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token function-variable function">source</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token function-variable function">size</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CopyrightWebpackPlugin<span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token keyword">const</span> CopyrightWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./plugin/index'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">//优化：关闭打包的map文件</span>
        <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token comment">// new BundleAnalyzerPlugin({</span>
                <span class="token comment">//     analyzerMode: 'server', // 每次构建时自动打开server  手动打开 disabled</span>
                <span class="token comment">//     generateStatsFile: true, // 是否生成stats.json文件</span>
                <span class="token comment">//     statsOptions: { source: false },</span>
                <span class="token comment">// }),</span>
                <span class="token keyword">new</span> <span class="token class-name">CopyrightWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;electrolux&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="_6-5-4-基础的loader"><a href="#_6-5-4-基础的loader" class="header-anchor">#</a> 6.5.4 基础的loader</h3> <p>编写新建loader/console.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">consoleFun</span><span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> map<span class="token punctuation">,</span> meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 省略部分代码</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">******</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-loader***********</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> content
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> consoleFun 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>再vue.config.js中直接调用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token punctuation">[</span>
                                    <span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">,</span><span class="token comment">// @babel/preset-env</span>
                                    <span class="token punctuation">{</span>

                                        <span class="token literal-property property">corejs</span><span class="token operator">:</span> <span class="token string">&quot;3.22&quot;</span><span class="token punctuation">,</span>
                                        <span class="token literal-property property">useBuiltIns</span><span class="token operator">:</span> <span class="token string">'usage'</span><span class="token punctuation">,</span>
                                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.ts$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>

                    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./loader/console.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;one-loader&quot;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./loader/console.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;two-loader&quot;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">]</span>

                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>
	
	
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="_6-6-webpack-plugin"><a href="#_6-6-webpack-plugin" class="header-anchor">#</a> 6.6  webpack | plugin</h2> <h3 id="_6-6-0-基础"><a href="#_6-6-0-基础" class="header-anchor">#</a> 6.6.0 基础</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plugin原理：
webpack 在编译代码过程中，会通过compilation触发一系列 Tapable 钩子事件。我们可以注入事件，拥有更强的构建能力。Tapable 还统一暴露了三个方法。tap：可以注册同步钩子和异步钩子。tapAsync：回调方式注册异步钩子。tapPromise：tapPromise 方式注册异步钩子。 我比较常用的就是emit了
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_6-6-1-copyrightwebpackplugin-js"><a href="#_6-6-1-copyrightwebpackplugin-js" class="header-anchor">#</a> 6.6.1 CopyrightWebpackPlugin.js</h3> <p>自己写的plugin，可以添加版权信息</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">CopyrightWebpackPlugin</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>params <span class="token operator">=</span> params
    <span class="token punctuation">}</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">-----------</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-----------------</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在资源输出之前触发</span>
        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;emit&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> name <span class="token keyword">in</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> source <span class="token operator">=</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.js'</span><span class="token punctuation">)</span> <span class="token operator">|</span> name<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.ts'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                    /**
                     * Author: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                     */
                    </span><span class="token template-punctuation string">`</span></span>
                    source <span class="token operator">=</span> prefix<span class="token operator">+</span>source
                    compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token function-variable function">source</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token function-variable function">size</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CopyrightWebpackPlugin<span class="token punctuation">;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="_6-6-2-delconsolewebpackplugin-js"><a href="#_6-6-2-delconsolewebpackplugin-js" class="header-anchor">#</a> 6.6.2 DelConsoleWebpackPlugin.js</h3> <p>正则研究了好久，还是实现了。</p> <p>可以删除console.log()</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">DelConsoleWebpackPlugin</span> <span class="token punctuation">{</span>
 
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 在资源输出之前触发</span>
        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;emit&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// console.log(compilation)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> name <span class="token keyword">in</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//文件名字 console.log(name)</span>
                <span class="token comment">// console.log(name)</span>
                <span class="token comment">//文件内容 compilation.assets[name].source()</span>
                <span class="token comment">//匹配文件 name.endsWith('.js')</span>
                <span class="token keyword">let</span> source <span class="token operator">=</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> rConsole <span class="token operator">=</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">console.log\(.*?\)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
                    source <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>rConsole<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// console.log(source)</span>

                    compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token function-variable function">source</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token function-variable function">size</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> source<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> DelConsoleWebpackPlugin<span class="token punctuation">;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="_6-6-3-analyzewebpackplugin-js"><a href="#_6-6-3-analyzewebpackplugin-js" class="header-anchor">#</a> 6.6.3 AnalyzeWebpackPlugin.js</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">AnalyzeWebpackPlugin</span> <span class="token punctuation">{</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'AnalyzeWebpackPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.遍历所有即将输出的文件，得到其大小</span>
        <span class="token keyword">const</span> assets <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * &quot;??md中表格的语法
         *  |资源名称|资源大小|
         *  | --- | --- |
         *  | xxx.js | 10kb |
         */</span>
        <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">|资源名称|资源大小|
            | --- | --- |</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">;</span> 
        assets<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>filename<span class="token punctuation">,</span> file<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          content <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n| </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>filename<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">kb |</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.生成一个md文件</span>
        compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span><span class="token string">'analyze.md'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> content<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> content<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> AnalyzeWebpackPlugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="调用"><a href="#调用" class="header-anchor">#</a> 调用</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> DelConsoleWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./plugin/DelConsoleWebpackPlugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CopyrightWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./plugin/CopyrightWebpackPlugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> AnalyzeWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./plugin/AnalyzeWebpackPlugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">//优化：关闭打包的map文件</span>
        <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">DelConsoleWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">CopyrightWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;electrolux&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">AnalyzeWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
          
            <span class="token comment">//优化器</span>
           
        <span class="token comment">//压缩图片</span>
        <span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//    console.log(config)</span>
        <span class="token punctuation">}</span>
    
    
    <span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_6-7-webpack-version"><a href="#_6-7-webpack-version" class="header-anchor">#</a> 6.7 webpack | version</h2> <h3 id="_6-7-1-webpack-5"><a href="#_6-7-1-webpack-5" class="header-anchor">#</a> 6.7.1 webpack  5</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm init <span class="token operator">-</span>y 
移除兼容，减小体积
<span class="token operator">--</span><span class="token number">1.</span>缓存 <span class="token operator">|</span>  cache自带configureWebpack下面的cache选项，能够进行配置，解决了webpack4和webpack4之前不能够缓存的问题
<span class="token operator">--</span><span class="token number">2.</span> 打包速度 <span class="token operator">|</span>webpack4默认将polyfill内容添加进项目，webpack5处于对打包速度的考虑被移除了 <span class="token punctuation">.</span> 如果要使用 
<span class="token keyword">const</span> NodePolyfillPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node-polyfill-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
    <span class="token keyword">new</span> <span class="token class-name">NodePolyfillPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">]</span>
就可以使用crypto（加密解密）

<span class="token operator">--</span><span class="token number">3.</span>启动方式 <span class="token operator">|</span> webpack4是webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server，webpack5内置使用 webpack serve 启动。

<span class="token operator">--</span><span class="token number">4.</span> 自带 browserslist  <span class="token operator">|</span> terser  
<span class="token operator">--</span><span class="token number">5.</span> Module <span class="token function">Federation</span><span class="token punctuation">(</span>联邦<span class="token punctuation">)</span><span class="token operator">:</span>允许多个 Webpack 构建产物一起工作。一些基础依赖也有可能都改成外部依赖，在本地开发的时候就无需引入，通过避免众所周知的 node_modules <span class="token function">层次太深的问题</span><span class="token punctuation">(</span>暂时没有用到<span class="token punctuation">)</span>
app_one 和 app_two 使用了共享的 <span class="token punctuation">[</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;react-router-dom&quot;</span><span class="token punctuation">]</span>，同时 app_two 把自己的 Dialog 暴露给了 app_one 使用
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;app_two&quot;</span><span class="token punctuation">,</span>
   <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;var&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;app_two&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;remoteEntry.js&quot;</span><span class="token punctuation">,</span>
   <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    “<span class="token punctuation">.</span><span class="token operator">/</span>Dialog”<span class="token operator">:</span> <span class="token string">&quot;./src/Dialog&quot;</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token literal-property property">remotes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">app_one</span><span class="token operator">:</span> <span class="token string">&quot;app_one&quot;</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;react-router-dom&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token number">6.</span>对比起webpack4的dev<span class="token operator">-</span>tool（source<span class="token operator">-</span>map方式）：更加严格，如果不对会报错
Invalid configuration object<span class="token punctuation">.</span> Webpack has been initialized using a configuration object that does not match the <span class="token constant">API</span> schema<span class="token punctuation">.</span>
 <span class="token operator">-</span> configuration<span class="token punctuation">.</span>devtool should match pattern <span class="token string">&quot;^(inline-|hidden-|eval-)?(nosources-)?(cheap-(module-)?)?source-map$&quot;</span><span class="token punctuation">.</span>
   <span class="token constant">BREAKING</span> <span class="token constant">CHANGE</span> since webpack <span class="token number">5</span><span class="token operator">:</span> The devtool option is more strict<span class="token punctuation">.</span>
   Please strictly follow the order <span class="token keyword">of</span> the keywords <span class="token keyword">in</span> the pattern<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token number">7.</span>打包静态文件问题
 <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.bmp$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.gif$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpe?g$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">generator</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'media/image/[name].[hash:8].[ext]'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
   
   
<span class="token operator">--</span>优化tree<span class="token operator">--</span>shaking 
npm install speed<span class="token operator">-</span>measure<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin@<span class="token operator">^</span><span class="token number">1.5</span><span class="token number">.0</span> <span class="token operator">-</span><span class="token constant">D</span>
npm install terser<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin@<span class="token number">4</span>  <span class="token operator">-</span><span class="token constant">S</span>
npm install cross<span class="token operator">-</span>env
npm install eslint@<span class="token number">8.15</span><span class="token number">.0</span> <span class="token operator">-</span><span class="token constant">D</span> <span class="token comment">//node要求在16以上</span>
npm install postcss@<span class="token number">8</span> <span class="token comment">//PostCSS plugin postcss-discard-comments requires PostCSS 8.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h3 id="_6-7-2-webpack-4"><a href="#_6-7-2-webpack-4" class="header-anchor">#</a> 6.7.2 webpack  4</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>缓存 <span class="token operator">|</span> webpack4和webpack4之前的版本是没有持久化缓存的能力的，只能靠插件来进行缓存。cache<span class="token operator">-</span>loader babel<span class="token operator">-</span>loader生成的缓存会存储在 node_modules<span class="token operator">/</span><span class="token punctuation">.</span>cache
	在我们webpack4增量更新的时候，其实这玩意能够破坏线上缓存。我们怎么解决呢？
万物的罪魁祸首是chunkId，所以必须要固定它，才能让文件内容不会变。解决方案是在beforeChunkIds基于module内容来生成唯一hash<span class="token operator">--</span><span class="token operator">-</span>webpack<span class="token operator">-</span>fixed<span class="token operator">-</span>chunk<span class="token operator">-</span>id<span class="token operator">-</span>plugin。这个问题在webpack5中已经得到了解决

<span class="token operator">--</span><span class="token number">2.</span>不带terser

<span class="token operator">--</span><span class="token number">3.</span>分包 <span class="token operator">|</span> webpack <span class="token number">4</span> 最大的改动就是废除了 CommonsChunkPlugin 引入了 optimization<span class="token punctuation">.</span>splitChunks。如果你的 mode 是 production，那么 webpack4 就会自动开启 Code Splitting。

<span class="token number">4</span><span class="token punctuation">.</span>js兼容 <span class="token operator">|</span>  webpack4默认将polyfill内容添加进项目，webpack5处于对打包速度的考虑被移除了

<span class="token number">5.</span>启动方式 <span class="token operator">|</span> webpack4是webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server，webpack5内置使用 webpack serve 启动
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_6-7-3-webpack-3"><a href="#_6-7-3-webpack-3" class="header-anchor">#</a> 6.7.3 webpack  3</h3> <h3 id="_6-7-4-webpack-5-4"><a href="#_6-7-4-webpack-5-4" class="header-anchor">#</a> 6.7.4 webpack 5 | 4</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1.</span>官网说：使用 webpack <span class="token operator">&gt;=</span> <span class="token number">4</span> 时，升级到最新的 webpack <span class="token number">5</span> 版本无需额外的操作
<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>webpack5已经自带了图片解析功能，再使用url<span class="token operator">-</span>loader的话会出现图片重复打包的问题<span class="token punctuation">.</span>改用webpack5自身来解析图片
 <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.bmp$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.gif$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpe?g$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">generator</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'media/image/[name].[hash:8].[ext]'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token number">3.</span>带有了缓存的功能，可以设置自带configureWebpack下面的cache选项，能够进行配置，解决了webpack4和webpack4之前不能够缓存的问题
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_6-7-5-webpack-4-3"><a href="#_6-7-5-webpack-4-3" class="header-anchor">#</a> 6.7.5 webpack 4 | 3</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>webpack4<span class="token punctuation">.</span><span class="token number">0</span>之后。执行方式就发生了改变。不再是 webpack 一波流，而是多了一个 webpack<span class="token operator">-</span>cli

<span class="token operator">--</span><span class="token number">2.</span>添加 mode<span class="token operator">:</span> <span class="token string">'production'</span> ，去掉了webpack3的defineplugin
<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>webpack4 UglifyJsPlugin 去掉了 ：代码最小化、压缩、美化
<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>webpack4 NoEmitOnErrorsPlugin 去掉了 ：不输出日志的错误日志
<span class="token operator">--</span><span class="token number">5</span><span class="token punctuation">.</span>webpack <span class="token number">4</span> 最大的改动就是废除了 CommonsChunkPlugin 引入了 optimization<span class="token punctuation">.</span>splitChunks。如果你的 mode 是 production，那么 webpack4 就会自动开启 Code Splitting。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_6-9-js版本兼容-babel"><a href="#_6-9-js版本兼容-babel" class="header-anchor">#</a> 6.9  js版本兼容 | babel</h2> <h3 id="_6-9-1-babel基本情况"><a href="#_6-9-1-babel基本情况" class="header-anchor">#</a> 6.9.1 babel基本情况</h3> <p>https://babeljs.io/docs/en/babel-preset-env#options</p> <p>AST:抽象语法树</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">0</span><span class="token punctuation">.</span>webpack6插件都是像babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime


<span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>babel7后多个包
<span class="token operator">--</span><span class="token number">1.1</span> @babel<span class="token operator">/</span>core<span class="token operator">:</span> 只会将 es6<span class="token operator">+</span> 语法转换为 es5 语法，但是没办法转换新 api，如：promise
<span class="token operator">--</span><span class="token number">1.2</span> @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env<span class="token operator">:</span> 智能预设，包含了一组插件，控制如何添加 polyfill（兼容新 api），可以按需添加 polyfill，不会污染全局环境和原型
<span class="token operator">--</span><span class="token number">1.3</span> @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime<span class="token operator">:</span> 使辅助代码作为一个独立模块引入，可以减少编译后代码的体积（起到一个treeshaing的功能）
<span class="token operator">--</span><span class="token number">1.4</span> @babel<span class="token operator">/</span>cli<span class="token operator">:</span> 提供 cli 命令行工具，用来通过命令行编译文件，适合安装到本地项目里
<span class="token operator">--</span><span class="token number">1.5</span> @babel<span class="token operator">/</span>polyfill 这玩意已经被弃用了

而这些 babel 包如果需要在 webpack 项目上使用，则需要使用到 babel<span class="token operator">-</span>loader


<span class="token operator">--</span><span class="token number">2</span><span class="token punctuation">.</span>babel多个包的版本
每年会新增很多特性。这些特性需要 babel 去转换，每个特性用一个 babel 插件来做。但是特性多啊，也就是说插件多，总不能让用户自己去配一个个插件吧，所以 babel <span class="token number">6</span> 引入了 preset 的概念，就是 plugin 的集合。

babel <span class="token number">6</span>之前如果我们想用 es6 语法就用 
babel<span class="token operator">-</span>preset<span class="token operator">-</span>es2015，es7 就在引入 babel<span class="token operator">-</span>preset<span class="token operator">-</span>es2016
如果是想用还没加入标准的特性，则分别用 babel<span class="token operator">-</span>preset<span class="token operator">-</span>stage0、babel<span class="token operator">-</span>preset<span class="token operator">-</span>stage1 等来引入。这个插件就是一个求并集的时候

babel <span class="token number">7</span>：所有的包都迁移到了 @babel  下。preset<span class="token operator">-</span>env，
preset<span class="token operator">-</span>env 默认会支持所有 es 标准的特性，如果没进入标准的，不再封装成 preset，需要手动指定 plugin<span class="token operator">-</span>proposal<span class="token operator">-</span>xxx。

<span class="token operator">--</span><span class="token number">3</span><span class="token punctuation">.</span>babel<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js <span class="token operator">|</span> <span class="token punctuation">.</span>babelrc
baberc 的加载规则是按目录加载的，是只针对自己的代码。config的配置针对了第三方的组件和自己的代码内容。babel<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js 是一个项目级别的配置，一般有了babel<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js 就不会在去执行<span class="token punctuation">.</span>babelrc的设置。

<span class="token operator">--</span><span class="token number">4</span><span class="token punctuation">.</span>core2和<span class="token number">3</span>的版本差别
<span class="token function">corejs2只转换全局变量</span><span class="token punctuation">(</span>Object<span class="token punctuation">)</span><span class="token function">和静态方法</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span>assign<span class="token punctuation">)</span><span class="token function">，并不转换原型上的方法</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>includes<span class="token punctuation">)</span>，corejs3会转换原型上的方法


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><table><thead><tr><th style="text-align:center;">版本</th> <th style="text-align:center;">基本</th> <th style="text-align:center;">额外</th></tr></thead> <tbody><tr><td style="text-align:center;">babel7之前</td> <td style="text-align:center;">preset-es2016 | preset-es2017之类的</td> <td style="text-align:center;">babel-preset-stage0 之类的</td></tr> <tr><td style="text-align:center;">babel7和之后</td> <td style="text-align:center;">preset-env</td> <td style="text-align:center;">plugin-proposal-xxx</td></tr></tbody></table> <p>@babel/preset-env 包含的是不低于stage3的预设</p> <p>webpack5才用 npm i @babel/polyfill -D</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>polyfill方案

polyfill方案目前主要有以下两种：
@babel<span class="token operator">/</span>polyfill （这种方法是添加原型实现的）
和  
@babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime 和@babel<span class="token operator">/</span>runtime（这种方法需要我们按需引入）。@babel<span class="token operator">/</span>polyfill会造成全局变量的污染，所以适用于应用开发，@babel<span class="token operator">/</span>runtime 不会造成全局变量的污染，适用于库的开发。现在的实现方式有了很大的区别。@babel<span class="token operator">/</span>polyfill 在<span class="token number">7.4</span> 以后被废弃了。所以最好不要用useBuiltIns


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_6-9-2-webpack-的项目引入babel"><a href="#_6-9-2-webpack-的项目引入babel" class="header-anchor">#</a> 6.9.2  webpack 的项目引入babel</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">--</span><span class="token number">1</span><span class="token punctuation">.</span>babel6 和babel6以下进行引入

在入口文件中 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import 'babel-polyfill' / require('babel-polyfill')</span><span class="token template-punctuation string">`</span></span>。使用webpack的话也可以在entry中添加 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">entry: ['babel-polyfill', 'src/index.js']</span><span class="token template-punctuation string">`</span></span>。

<span class="token operator">--</span><span class="token number">2.</span>负优化
@babel<span class="token operator">/</span>preset<span class="token operator">-</span>env 与@babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime用一个就好了，两个同时用可能会出现负优化。  @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env的<span class="token string">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;entry&quot;</span>和plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime 会出现负优化
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> i <span class="token parameter variable">-D</span> babel-loader @babel/core @babel/preset-env
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们可以再webpack.config.js中进行引入</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span><span class="token punctuation">{</span>
         <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
                                <span class="token punctuation">[</span>	<span class="token comment">// @babel/preset-env</span>
                                    <span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">,</span>
                                    <span class="token punctuation">{</span>
									<span class="token comment">//当 useBuiltIns 的值为 entry 时， @babel/preset-env 会按照你所设置的目标浏览器（browerlic）在入口处来引入所需的 polyfill,不管你需不需要。</span>
                                        <span class="token comment">//usage的时候，但是如果我们排除node_modules/目录，遇上没有经过转译的第三方包，就检测不到第三方包内部的 ‘hello‘.includes(‘h‘)这种句法，这时候我们就会遇到bug</span>
                                        <span class="token comment">//false的就不会用polyfill，也就不会去参考browerlic文件</span>
                                        <span class="token literal-property property">corejs</span><span class="token operator">:</span> <span class="token string">&quot;3.22&quot;</span><span class="token punctuation">,</span>
                                        <span class="token literal-property property">useBuiltIns</span><span class="token operator">:</span> <span class="token string">'usage'</span><span class="token punctuation">,</span>
                                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>或者根目录新建babel.config.js，经过http://www.360doc.com/content/20/0305/08/65839416_896812820.shtml  前辈的实验。@babel/preset-env的&quot;useBuiltIns&quot;: &quot;entry&quot;和plugin-transform-runtime 会出现负优化</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">corejs</span><span class="token operator">:</span> <span class="token string">&quot;3.22&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">useBuiltIns</span><span class="token operator">:</span> <span class="token string">'usage'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;absoluteRuntime&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 不是很清除干啥的</span>
        <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 下面详解</span>
        <span class="token string-property property">&quot;helpers&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 助手函数是否提取，同babel-plugin-transform</span>
        <span class="token string-property property">&quot;regenerator&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 同babel-plugin-transform</span>
        <span class="token string-property property">&quot;useESModules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_6-10-css版本兼容-postcss"><a href="#_6-10-css版本兼容-postcss" class="header-anchor">#</a> 6.10 css版本兼容 | postcss</h2> <h3 id="_6-10-vue-config-js中"><a href="#_6-10-vue-config-js中" class="header-anchor">#</a> 6.10 vue.config.js中</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span><span class="token punctuation">{</span>
         <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">postcssOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       <span class="token comment">// 添加浏览器前缀</span>
                                <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-preset-env'</span><span class="token punctuation">)</span>  <span class="token comment">// 该插件可以使用一些未来的CSS特性</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
         <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_6-10-posscss-config-js中"><a href="#_6-10-posscss-config-js中" class="header-anchor">#</a> 6.10 posscss.config.js中</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-preset-env'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_6-11-webpack示例"><a href="#_6-11-webpack示例" class="header-anchor">#</a> 6.11 webpack示例</h2> <p>https://gitee.com/Electrolux/vue3-package-base</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> BundleAnalyzerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin
<span class="token keyword">const</span> DelConsoleWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./plugin/DelConsoleWebpackPlugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CopyrightWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./plugin/CopyrightWebpackPlugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> AnalyzeWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./plugin/AnalyzeWebpackPlugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> consoleFun <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./loader/console'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> env <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">;</span><span class="token comment">//当前环境</span>
<span class="token comment">// 默认是本地环境</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 生产环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------生产环境----------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// webpack5 对于检测会有正则</span>
            <span class="token comment">//  source-map           产生.map文件</span>
            <span class="token comment">//  inline-source-map    不会生成.map文件，source-map以base64形式放到js文件里</span>
            <span class="token comment">//  cheap                cheap报错提示信息只精确到行，不用精确到列，性能更好</span>
            <span class="token comment">//  module               module模式会对三方库、loader等的也负责</span>
            <span class="token comment">//  eval                 eval会将每一个module模块，执行eval，执行后不会生成sourcemap文件，仅仅是在每一个模块后，增加sourceURL来关联模块处理前后的对应关系，eval通过eval来执行，性能最快，但是复杂的代码可能显示不全</span>
            <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&quot;eval-cheap-module-source-map&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token comment">// new BundleAnalyzerPlugin({</span>
                <span class="token comment">//     analyzerMode: 'server', // 每次构建时自动打开server  手动打开 disabled</span>
                <span class="token comment">//     generateStatsFile: true, // 是否生成stats.json文件</span>
                <span class="token comment">//     statsOptions: { source: false },</span>
                <span class="token comment">// }),</span>
                <span class="token comment">// new AnalyzeWebpackPlugin()</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// type: &quot;filesystem&quot;,</span>
                <span class="token comment">// allowCollectingMemory: true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">// 性能提示</span>
            <span class="token literal-property property">performance</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// hints: &quot;error&quot;     // 超过250kb 的资源 我们掏出错误</span>
                <span class="token literal-property property">maxAssetSize</span><span class="token operator">:</span> <span class="token number">250000</span> <span class="token comment">//最大250000 bytes</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//优化器</span>
            <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">chunkIds</span><span class="token operator">:</span> <span class="token string">&quot;named&quot;</span><span class="token punctuation">,</span> <span class="token comment">//1.named选择块 ID 时的算法在编译之间不会更改的短数字 ID。 // 2.'deterministic'选择快 编译的时候默认使用适合长期缓存。生产模式默认启用。</span>
                <span class="token comment">//对应着chain模块就是   config.optimization.splitChunks({})  只有splitChunks:里面的参数可以被引用</span>
                <span class="token comment">// 可以在 vue配置文件中加入 /* webpackChunkName:&quot;lodash&quot; */ 就可以在打包js的时候叫做这个名字</span>
                <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">// runtimeChunk: &quot;single&quot;,  //单独打包，小文件还挺好用的</span>
                    <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 必须三选一： &quot;initial&quot; | &quot;all&quot;(推荐) | &quot;async&quot; (默认就是async)</span>
                    <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 最小尺寸，30000 超过30K才独立分包</span>
                    <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 最小 chunk ，默认1</span>
                    <span class="token literal-property property">maxAsyncRequests</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 最大异步请求数， 默认5</span>
                    <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// 最大初始化请求书，默认3</span>
                    <span class="token literal-property property">automaticNameDelimiter</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 打包分隔  </span>
                    <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 这里开始设置缓存的 chunks</span>
                        <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 缓存组优先级</span>

                        <span class="token literal-property property">elementUI</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'elementUI'</span><span class="token punctuation">,</span> <span class="token comment">// 将elementUI拆分为单个包</span>
                            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]_?element-plus(.*)</span><span class="token regex-delimiter">/</span></span> <span class="token comment">// in order to adapt to cnpm</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// 优化：代码压缩，使用terser来缩小/最小化你的 JavaScript</span>
                <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>


        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//压缩图片</span>
        <span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//    console.log(config)</span>
        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>


<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">'test'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 测试环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------测试环境----------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 开发环境</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------开发环境----------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>

        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;./&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">//优化：关闭打包的map文件</span>
        <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token comment">// new BundleAnalyzerPlugin({</span>
                <span class="token comment">//     analyzerMode: 'server', // 每次构建时自动打开server  手动打开 disabled</span>
                <span class="token comment">//     generateStatsFile: true, // 是否生成stats.json文件</span>
                <span class="token comment">//     statsOptions: { source: false },</span>
                <span class="token comment">// }),</span>
                <span class="token comment">// new DelConsoleWebpackPlugin({</span>
                <span class="token comment">// }),</span>
                <span class="token keyword">new</span> <span class="token class-name">CopyrightWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;electrolux&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">AnalyzeWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;filesystem&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">allowCollectingMemory</span><span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">// 性能提示</span>
            <span class="token literal-property property">performance</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// hints: &quot;error&quot;     // 超过250kb 的资源 我们掏出错误</span>
                <span class="token literal-property property">maxAssetSize</span><span class="token operator">:</span> <span class="token number">250000</span> <span class="token comment">//最大250000 bytes</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//优化器</span>
            <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">chunkIds</span><span class="token operator">:</span> <span class="token string">&quot;named&quot;</span><span class="token punctuation">,</span> <span class="token comment">//1.named选择块 ID 时的算法在编译之间不会更改的短数字 ID。 // 2.'deterministic'选择快 编译的时候默认使用适合长期缓存。生产模式默认启用。</span>
                <span class="token comment">//对应着chain模块就是   config.optimization.splitChunks({})  只有splitChunks:里面的参数可以被引用</span>
                <span class="token comment">// 可以在 vue配置文件中加入 /* webpackChunkName:&quot;lodash&quot; */ 就可以在打包js的时候叫做这个名字</span>
                <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">// runtimeChunk: &quot;single&quot;,  //单独打包，小文件还挺好用的</span>
                    <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 必须三选一： &quot;initial&quot; | &quot;all&quot;(推荐) | &quot;async&quot; (默认就是async)</span>
                    <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 最小尺寸，30000 超过30K才独立分包</span>
                    <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 最小 chunk ，默认1</span>
                    <span class="token literal-property property">maxAsyncRequests</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 最大异步请求数， 默认5</span>
                    <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// 最大初始化请求书，默认3</span>
                    <span class="token literal-property property">automaticNameDelimiter</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 打包分隔  </span>
                    <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 这里开始设置缓存的 chunks</span>
                        <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 缓存组优先级</span>

                        <span class="token literal-property property">elementUI</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'elementUI'</span><span class="token punctuation">,</span> <span class="token comment">// 将elementUI拆分为单个包</span>
                            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]_?element-ui(.*)</span><span class="token regex-delimiter">/</span></span> <span class="token comment">// in order to adapt to cnpm</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// 优化：代码压缩，使用terser来缩小/最小化你的 JavaScript</span>
                <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//loader</span>
            <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token punctuation">[</span>
                                    <span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">,</span><span class="token comment">// @babel/preset-env</span>
                                    <span class="token punctuation">{</span>

                                        <span class="token literal-property property">corejs</span><span class="token operator">:</span> <span class="token string">&quot;3.22&quot;</span><span class="token punctuation">,</span>
                                        <span class="token literal-property property">useBuiltIns</span><span class="token operator">:</span> <span class="token string">'usage'</span><span class="token punctuation">,</span>
                                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">]</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.ts$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>

                    <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./loader/console.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;one-loader&quot;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">loader</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./loader/console.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;two-loader&quot;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">]</span>

                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token comment">//   path.resolve(__dirname, &quot;loader&quot;),</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//压缩图片</span>
        <span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//    console.log(config)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>




</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br></div></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/front-base-know-blog/know/优化/1.性能优化和安全.html" class="prev">
          1.性能优化与安全
        </a></span> <span class="next"><a href="/front-base-know-blog/know/优化/3.算法.html">
          3.实用算法 | 设计模式
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:0;" data-v-b57cc07c data-v-7dd95ae2></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/front-base-know-blog/assets/js/app.9ea430c0.js" defer></script><script src="/front-base-know-blog/assets/js/3.a15d85cc.js" defer></script><script src="/front-base-know-blog/assets/js/1.704023bf.js" defer></script><script src="/front-base-know-blog/assets/js/9.cf5c04da.js" defer></script>
  </body>
</html>
